(function(A){if(typeof A.fn.each2=="undefined"){A.fn.extend({each2:function(E){var C=A([0]),D=-1,B=this.length;while(++D<B&&(C.context=C[0]=this[D])&&E.call(C[0],D,C)!==false){}return this}})}})(jQuery);(function(J,L){if(window.Select2!==L){return }var C,E,W,c,T,A;C={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(d){d=d.which?d.which:d;switch(d){case C.LEFT:case C.RIGHT:case C.UP:case C.DOWN:return true}return false},isControl:function(f){var d=f.which;switch(d){case C.SHIFT:case C.CTRL:case C.ALT:return true}if(f.metaKey){return true}return false},isFunctionKey:function(d){d=d.which?d.which:d;return d>=112&&d<=123}};T=(function(){var d=1;return function(){return d++}}());function V(d){if(d&&typeof (d)==="string"){return d.replace(/&/g,"&amp;")}else{return d}}function B(g,h){var f=0,d=h.length,e;if(typeof g==="undefined"){return -1}if(g.constructor===String){for(;f<d;f=f+1){if(g.localeCompare(h[f])===0){return f}}}else{for(;f<d;f=f+1){e=h[f];if(e.constructor===String){if(e.localeCompare(g)===0){return f}}else{if(e===g){return f}}}}return -1}function Q(e,d){if(e===d){return true}if(e===L||d===L){return false}if(e===null||d===null){return false}if(e.constructor===String){return e.localeCompare(d)===0}if(d.constructor===String){return d.localeCompare(e)===0}return false}function M(e,g){var h,f,d;if(e===null||e.length<1){return[]}h=e.split(g);for(f=0,d=h.length;f<d;f=f+1){h[f]=J.trim(h[f])}return h}function N(d){return d.outerWidth()-d.width()}function a(e){var d="keyup-change-value";e.bind("keydown",function(){if(J.data(e,d)===L){J.data(e,d,e.val())}});e.bind("keyup",function(){var f=J.data(e,d);if(f!==L&&e.val()!==f){J.removeData(e,d);e.trigger("keyup-change")}})}J(document).delegate("*","mousemove",function(d){J.data(document,"select2-lastpos",{x:d.pageX,y:d.pageY})});function U(d){d.bind("mousemove",function(g){var f=J.data(document,"select2-lastpos");if(f===L||f.x!==g.pageX||f.y!==g.pageY){J(g.target).trigger("mousemove-filtered",g)}})}function G(f,d){var e;return function(){window.clearTimeout(e);e=window.setTimeout(d,f)}}function b(f){var d=false,e;return function(){if(d===false){e=f();d=true}return e}}function F(d,f){var e=G(d,function(g){f.trigger("scroll-debounced",g)});f.bind("scroll",function(g){if(B(g.target,f.get())>=0){e(g)}})}function D(d){d.preventDefault();d.stopPropagation()}function Y(f){if(!A){var d=f[0].currentStyle||window.getComputedStyle(f[0],null);A=J("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:d.fontSize,fontFamily:d.fontFamily,fontStyle:d.fontStyle,fontWeight:d.fontWeight,letterSpacing:d.letterSpacing,textTransform:d.textTransform,whiteSpace:"nowrap"});J("body").append(A)}A.text(f.val());return A.width()}function I(h,g,e){var f=h.toUpperCase().indexOf(g.toUpperCase()),d=g.length;if(f<0){e.push(h);return }e.push(h.substring(0,f));e.push("<span class='select2-match'>");e.push(h.substring(f,f+d));e.push("</span>");e.push(h.substring(f+d,h.length))}function P(e){var g,d=0,f=null,h=e.quietMillis||100;return function(i){window.clearTimeout(g);g=window.setTimeout(function(){d+=1;var j=d,m=e.data,n=e.transport||J.ajax,l=e.traditional||false,k=e.type||"GET";m=m.call(this,i.term,i.page,i.context);if(null!==f){f.abort()}f=n.call(null,{url:e.url,dataType:e.dataType,data:m,type:k,traditional:l,success:function(p){if(j<d){return }var o=e.results(p,i.page);i.callback(o)}})},h)}}function R(d){var f=d,e,g=function(h){return""+h.text};if(!J.isArray(f)){g=f.text;if(!J.isFunction(g)){e=f.text;g=function(h){return h[e]}}f=f.results}return function(j){var i=j.term,h={};if(i===""){j.callback({results:f});return }h.results=J(f).filter(function(){return j.matcher(i,g(this))}).get();j.callback(h)}}function O(d){if(J.isFunction(d)){return d}return function(g){var f=g.term,e={results:[]};J(d).each(function(){var h=this.text!==L,i=h?this.text:this;if(f===""||g.matcher(f,i)){e.results.push(h?this:{id:this,text:this})}});g.callback(e)}}function K(d,e){if(J.isFunction(d)){return true}if(!d){return false}throw new Error("formatterName must be a function or a falsy value")}function S(d){return J.isFunction(d)?d():d}function H(d){var e=0;J.each(d,function(f,g){if(g.children){e+=H(g.children)}else{e++}});return e}function Z(n,o,k,d){var e=n,p=false,g,m,h,f,j;if(!d.createSearchChoice||!d.tokenSeparators||d.tokenSeparators.length<1){return L}while(true){m=-1;for(h=0,f=d.tokenSeparators.length;h<f;h++){j=d.tokenSeparators[h];m=n.indexOf(j);if(m>=0){break}}if(m<0){break}g=n.substring(0,m);n=n.substring(m+j.length);if(g.length>0){g=d.createSearchChoice(g,o);if(g!==L&&g!==null&&d.id(g)!==L&&d.id(g)!==null){p=false;for(h=0,f=o.length;h<f;h++){if(Q(d.id(g),d.id(o[h]))){p=true;break}}if(!p){k(g)}}}}if(e.localeCompare(n)!=0){return n}}J(document).ready(function(){J(document).delegate("*","mousedown touchend",function(g){var f=J(g.target).closest("div.select2-container").get(0),d;if(f){J(document).find("div.select2-container-active").each(function(){if(this!==f){J(this).data("select2").blur()}})}else{f=J(g.target).closest("div.select2-drop").get(0);J(document).find("div.select2-drop-active").each(function(){if(this!==f){J(this).data("select2").blur()}})}f=J(g.target);d=f.attr("for");if("LABEL"===g.target.tagName&&d&&d.length>0){f=J("#"+d);f=f.data("select2");if(f!==L){f.focus();g.preventDefault()}}})});function X(d,e){var f=function(){};f.prototype=new d;f.prototype.constructor=f;f.prototype.parent=d.prototype;f.prototype=J.extend(f.prototype,e);return f}E=X(Object,{bind:function(e){var d=this;return function(){e.apply(d,arguments)}},init:function(f){var e,d,g=".select2-results";this.opts=f=this.prepareOpts(f);this.id=f.id;if(f.element.data("select2")!==L&&f.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id"+T();this.container.attr("id",this.containerId);this.body=b(function(){return f.element.closest("body")});if(f.element.attr("class")!==L){this.container.addClass(f.element.attr("class"))}this.container.css(S(f.containerCss));this.container.addClass(S(f.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(S(f.dropdownCssClass));this.dropdown.data("select2",this);this.results=e=this.container.find(g);this.search=d=this.container.find("input.select2-input");d.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();U(this.results);this.dropdown.delegate(g,"mousemove-filtered",this.bind(this.highlightUnderEvent));F(80,this.results);this.dropdown.delegate(g,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(J.fn.mousewheel){e.mousewheel(function(l,m,j,i){var k=e.scrollTop(),h;if(i>0&&k-i<=0){e.scrollTop(0);D(l)}else{if(i<0&&e.get(0).scrollHeight-e.scrollTop()+i<=e.height()){e.scrollTop(e.get(0).scrollHeight-e.height());D(l)}}})}a(d);d.bind("keyup-change",this.bind(this.updateResults));d.bind("focus",function(){d.addClass("select2-focused");if(d.val()===" "){d.val("")}});d.bind("blur",function(){d.removeClass("select2-focused")});this.dropdown.delegate(g,"mouseup",this.bind(function(h){if(J(h.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(h);this.selectHighlighted(h)}else{this.focusSearch()}D(h)}));this.dropdown.bind("click mouseup mousedown",function(h){h.stopPropagation()});if(J.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(f.element.is(":disabled")||f.element.is("[readonly='readonly']")){this.disable()}},destroy:function(){var d=this.opts.element.data("select2");if(d!==L){d.container.remove();d.dropdown.remove();d.opts.element.removeData("select2").unbind(".select2").show()}},prepareOpts:function(h){var f,e,d,g;f=h.element;if(f.get(0).tagName.toLowerCase()==="select"){this.select=e=h.element}if(e){J.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in h){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}h=J.extend({},{populateResults:function(i,m,o){var n,l,q,k,j=this.opts.id,p=this;n=function(w,r,v){var x,t,AC,z,AB,s,AA,y,u;for(x=0,t=w.length;x<t;x=x+1){AC=w[x];z=j(AC)!==L;AB=("children" in AC)&&AC.children.length>0;s=J("<li></li>");s.addClass("select2-results-dept-"+v);s.addClass("select2-result");s.addClass(z?"select2-result-selectable":"select2-result-unselectable");if(AB){s.addClass("select2-result-with-children")}s.addClass(p.opts.formatResultCssClass(AC));AA=J("<div></div>");AA.addClass("select2-result-label");u=h.formatResult(AC,AA,o);if(u!==L){AA.html(V(u))}s.append(AA);if(AB){y=J("<ul></ul>");y.addClass("select2-result-sub");n(AC.children,y,v+1);s.append(y)}s.data("select2-data",AC);r.append(s)}};n(m,i,0)}},J.fn.select2.defaults,h);if(typeof (h.id)!=="function"){d=h.id;h.id=function(i){return i[d]}}if(e){h.query=this.bind(function(l){var k={results:[],more:false},j=l.term,i,n,m;m=function(o,q){var p;if(o.is("option")){if(l.matcher(j,o.text(),o)){q.push({id:o.attr("value"),text:o.text(),element:o.get(),css:o.attr("class")})}}else{if(o.is("optgroup")){p={text:o.attr("label"),children:[],element:o.get(),css:o.attr("class")};o.children().each2(function(r,s){m(s,p.children)});if(p.children.length>0){q.push(p)}}}};i=f.children();if(this.getPlaceholder()!==L&&i.length>0){n=i[0];if(J(n).text()===""){i=i.not(n)}}i.each2(function(o,p){m(p,k.results)});l.callback(k)});h.id=function(i){return i.id};h.formatResultCssClass=function(i){return i.css}}else{if(!("query" in h)){if("ajax" in h){g=h.element.data("ajax-url");if(g&&g.length>0){h.ajax.url=g}h.query=P(h.ajax)}else{if("data" in h){h.query=R(h.data)}else{if("tags" in h){h.query=O(h.tags);h.createSearchChoice=function(i){return{id:i,text:i}};h.initSelection=function(i,k){var j=[];J(M(i.val(),h.separator)).each(function(){var n=this,m=this,l=h.tags;if(J.isFunction(l)){l=l()}J(l).each(function(){if(Q(this.id,n)){m=this.text;return false}});j.push({id:n,text:m})});k(j)}}}}}}if(typeof (h.query)!=="function"){throw"query function not defined for Select2 "+h.element.attr("id")}return h},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(d){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}))},triggerChange:function(d){d=d||{};d=J.extend({},d,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(d);this.opts.element.data("select2-change-triggered",false);this.opts.element.click()},enable:function(){if(this.enabled){return }this.enabled=true;this.container.removeClass("select2-container-disabled")},disable:function(){if(!this.enabled){return }this.close();this.enabled=false;this.container.addClass("select2-container-disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var h=this.container.offset(),n=this.container.outerHeight(),e=this.container.outerWidth(),g=this.dropdown.outerHeight(),k=J(window).scrollTop()+document.documentElement.clientHeight,d=h.top+n,l=d+g<=k,j=(h.top-g)>=this.body().scrollTop(),f=this.dropdown.hasClass("select2-drop-above"),m,i;if(f){m=true;if(!j&&l){m=false}}else{m=false;if(!l&&j){m=true}}if(m&&this.opts.allowPositionAbove){d=h.top-g;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}i={top:d,left:h.left,width:e};this.dropdown.css(i)},shouldOpen:function(){var d;if(this.opened()){return false}d=jQuery.Event("open");this.opts.element.trigger(d);return !d.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var g=this.containerId,e="#"+g,d="scroll."+g,f="resize."+g;this.container.parents().each(function(){J(this).bind(d,function(){var h=J(e);if(h.length==0){J(this).unbind(d)}h.select2("close")})});window.setTimeout(function(){J(window).bind(f,function(){var h=J(e);if(h.length==0){J(window).unbind(f)}h.select2("close")})},10);this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("")}this.dropdown.css(S(this.opts.dropdownCss));this.dropdown.addClass("select2-drop-active");this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.opts.element.trigger(jQuery.Event("aftershow"));this.ensureHighlightVisible();this.positionDropdown();this.focusSearch()},close:function(){if(!this.opened()){return }var d=this;this.container.parents().each(function(){J(this).unbind("scroll."+d.containerId)});J(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(jQuery.Event("close"))},clearSearch:function(){},ensureHighlightVisible:function(){var g=this.results,f,d,k,j,h,i,e;d=this.highlight();if(d<0){return }if(d==0){g.scrollTop(0);return }f=g.find(".select2-result-selectable");k=J(f[d]);j=k.offset().top+k.outerHeight();if(d===f.length-1){e=g.find("li.select2-more-results");if(e.length>0){j=e.offset().top+e.outerHeight()}}h=g.offset().top+g.outerHeight();if(j>h){g.scrollTop(g.scrollTop()+(j-h))}i=k.offset().top-g.offset().top;if(i<0){g.scrollTop(g.scrollTop()+i)}},moveHighlight:function(g){var f=this.results.find(".select2-result-selectable"),e=this.highlight();while(e>-1&&e<f.length){e+=g;var d=J(f[e]);if(d.hasClass("select2-result-selectable")&&!d.hasClass("select2-disabled")){this.highlight(e);break}}},highlight:function(d){var e=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return B(e.filter(".select2-highlighted")[0],e.get())}if(d>=e.length){d=e.length-1}if(d<0){d=0}e.removeClass("select2-highlighted");J(e[d]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(e){var d=J(e.target).closest(".select2-result-selectable");if(d.length>0&&!d.is(".select2-highlighted")){var f=this.results.find(".select2-result-selectable");this.highlight(f.index(d))}else{if(d.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var h=this.results,g=h.find("li.select2-more-results"),k,j=-1,i=this.resultsPage+1,d=this,f=this.search.val(),e=this.context;if(g.length===0){return }k=g.offset().top-h.offset().top-h.height();if(k<=0){g.addClass("select2-active");this.opts.query({term:f,page:i,context:e,matcher:this.opts.matcher,callback:this.bind(function(l){d.opts.populateResults.call(this,h,l.results,{term:f,page:i,context:e});if(l.more===true){g.detach().appendTo(h).text(d.opts.formatLoadMore(i+1));window.setTimeout(function(){d.loadMoreIfNeeded()},10)}else{g.remove()}d.positionDropdown();d.resultsPage=i})})}},tokenize:function(){},updateResults:function(i){var l=this.search,g=this.results,d=this.opts,f,k=this,j;if(i!==true&&(this.showSearchInput===false||!this.opened())){return }l.addClass("select2-active");function h(){g.scrollTop(0);l.removeClass("select2-active");k.positionDropdown()}function e(m){g.html(V(m));h()}if(d.maximumSelectionSize>=1){f=this.data();if(J.isArray(f)&&f.length>=d.maximumSelectionSize&&K(d.formatSelectionTooBig,"formatSelectionTooBig")){e("<li class='select2-selection-limit'>"+d.formatSelectionTooBig(d.maximumSelectionSize)+"</li>");return }}if(l.val().length<d.minimumInputLength&&K(d.formatInputTooShort,"formatInputTooShort")){e("<li class='select2-no-results'>"+d.formatInputTooShort(l.val(),d.minimumInputLength)+"</li>");return }else{e("<li class='select2-searching'>"+d.formatSearching()+"</li>")}j=this.tokenize();if(j!=L&&j!=null){l.val(j)}this.resultsPage=1;d.query({term:l.val(),page:this.resultsPage,context:null,matcher:d.matcher,callback:this.bind(function(n){var m;this.context=(n.context===L)?null:n.context;if(this.opts.createSearchChoice&&l.val()!==""){m=this.opts.createSearchChoice.call(null,l.val(),n.results);if(m!==L&&m!==null&&k.id(m)!==L&&k.id(m)!==null){if(J(n.results).filter(function(){return Q(k.id(this),k.id(m))}).length===0){n.results.unshift(m)}}}if(n.results.length===0&&K(d.formatNoMatches,"formatNoMatches")){e("<li class='select2-no-results'>"+d.formatNoMatches(l.val())+"</li>");return }g.empty();k.opts.populateResults.call(this,g,n.results,{term:l.val(),page:this.resultsPage,context:null});if(n.more===true&&K(d.formatLoadMore,"formatLoadMore")){g.append("<li class='select2-more-results'>"+V(d.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){k.loadMoreIfNeeded()},10)}this.postprocessResults(n,i);h()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var d=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),f=e.closest(".select2-result-selectable").data("select2-data");if(f){e.addClass("select2-disabled");this.highlight(d);this.onSelect(f)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function e(){var j,g,k,h,f;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){j=this.opts.element.attr("style");if(j!==L){g=j.split(";");for(h=0,f=g.length;h<f;h=h+1){k=g[h].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(k!==null&&k.length>=1){return k[1]}}}if(this.opts.width==="resolve"){j=this.opts.element.css("width");if(j.indexOf("%")>0){return j}return(this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px")}return null}else{if(J.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var d=e.call(this);if(d!==null){this.container.attr("style","width: "+d)}}});W=X(E,{createContainer:function(){var d=J("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return d},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var f,e=this.container,g=this.dropdown,d=false;this.selection=f=e.find(".select2-choice");this.search.bind("keydown",this.bind(function(h){if(!this.enabled){return }if(h.which===C.PAGE_UP||h.which===C.PAGE_DOWN){D(h);return }if(this.opened()){switch(h.which){case C.UP:case C.DOWN:this.moveHighlight((h.which===C.UP)?-1:1);D(h);return ;case C.TAB:case C.ENTER:this.selectHighlighted();D(h);return ;case C.ESC:this.cancel(h);D(h);return }}else{if(h.which===C.TAB||C.isControl(h)||C.isFunctionKey(h)||h.which===C.ESC){return }if(this.opts.openOnEnter===false&&h.which===C.ENTER){return }this.open();if(h.which===C.ENTER){return }}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("mousedown",this.bind(function(h){d=true;if(this.opened()){this.close();this.selection.focus()}else{if(this.enabled){this.open()}}d=false}));g.bind("mousedown",this.bind(function(){this.search.focus()}));f.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));f.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("keydown",this.bind(function(i){if(!this.enabled){return }if(i.which===C.PAGE_UP||i.which===C.PAGE_DOWN){D(i);return }if(i.which===C.TAB||C.isControl(i)||C.isFunctionKey(i)||i.which===C.ESC){return }if(this.opts.openOnEnter===false&&i.which===C.ENTER){return }if(i.which==C.DELETE){if(this.opts.allowClear){this.clear()}return }this.open();if(i.which===C.ENTER){D(i);return }if(i.which<48){D(i);return }var h=String.fromCharCode(i.which).toLowerCase();if(i.shiftKey){h=h.toUpperCase()}this.search.focus();this.search.val(h);D(i)}));f.delegate("abbr","mousedown",this.bind(function(h){if(!this.enabled){return }this.clear();D(h);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){var e;if(this.opts.element.val()===""){this.close();this.setPlaceholder()}else{var d=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==L&&f!==null){d.updateSelection(f);d.close();d.setPlaceholder()}})}},prepareOpts:function(){var d=this.parent.prepareOpts.apply(this,arguments);if(d.element.get(0).tagName.toLowerCase()==="select"){d.initSelection=function(e,g){var f=e.find(":selected");if(J.isFunction(g)){g({id:f.attr("value"),text:f.text()})}}}return d},setPlaceholder:function(){var d=this.getPlaceholder();if(this.opts.element.val()===""&&d!==L){if(this.select&&this.select.find("option:first").text()!==""){return }this.selection.find("span").html(V(d));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(g,e){var f=0,d=this,h=true;this.results.find(".select2-result-selectable").each2(function(j,k){if(Q(d.id(k.data("select2-data")),d.opts.element.val())){f=j;return false}});this.highlight(f);if(e===true){h=this.showSearchInput=H(g.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[h?"removeClass":"addClass"]("select2-search-hidden");J(this.dropdown,this.container)[h?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(e){var d=this.opts.element.val();this.opts.element.val(this.id(e));this.updateSelection(e);this.close();this.selection.focus();if(!Q(d,this.id(e))){this.triggerChange()}},updateSelection:function(f){var d=this.selection.find("span"),e;this.selection.data("select2-data",f);d.empty();e=this.opts.formatSelection(f,d);if(e!==L){d.append(V(e))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==L){this.selection.find("abbr").show()}},val:function(){var f,e=null,d=this;if(arguments.length===0){return this.opts.element.val()}f=arguments[0];if(this.select){this.select.val(f).find(":selected").each2(function(g,h){e={id:h.attr("value"),text:h.text()};return false});this.updateSelection(e);this.setPlaceholder()}else{if(this.opts.initSelection===L){throw new Error("cannot call val() if initSelection() is not defined")}if(!f){this.clear();return }this.opts.initSelection(this.opts.element,function(g){d.opts.element.val(!g?"":d.id(g));d.updateSelection(g);d.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(e){var d;if(arguments.length===0){d=this.selection.data("select2-data");if(d==L){d=null}return d}else{if(!e||e===""){this.clear()}else{this.opts.element.val(!e?"":this.id(e));this.updateSelection(e)}}}});c=X(E,{createContainer:function(){var d=J("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return d},prepareOpts:function(){var d=this.parent.prepareOpts.apply(this,arguments);if(d.element.get(0).tagName.toLowerCase()==="select"){d.initSelection=function(e,g){var f=[];e.find(":selected").each2(function(h,j){f.push({id:j.attr("value"),text:j.text()})});if(J.isFunction(g)){g(f)}}}return d},initContainer:function(){var d=".select2-choices",e;this.searchContainer=this.container.find(".select2-search-field");this.selection=e=this.container.find(d);this.search.bind("keydown",this.bind(function(g){if(!this.enabled){return }if(g.which===C.BACKSPACE&&this.search.val()===""){this.close();var h,f=e.find(".select2-search-choice-focus");if(f.length>0){this.unselect(f.first());this.search.width(10);D(g);return }h=e.find(".select2-search-choice");if(h.length>0){h.last().addClass("select2-search-choice-focus")}}else{e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(g.which){case C.UP:case C.DOWN:this.moveHighlight((g.which===C.UP)?-1:1);D(g);return ;case C.ENTER:case C.TAB:this.selectHighlighted();D(g);return ;case C.ESC:this.cancel(g);D(g);return }}if(g.which===C.TAB||C.isControl(g)||C.isFunctionKey(g)||g.which===C.BACKSPACE||g.which===C.ESC){return }if(this.opts.openOnEnter===false&&g.which===C.ENTER){return }this.open();if(g.which===C.PAGE_UP||g.which===C.PAGE_DOWN){D(g)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(){this.container.removeClass("select2-container-active")}));this.container.delegate(d,"mousedown",this.bind(function(f){if(!this.enabled){return }this.clearPlaceholder();this.open();this.focusSearch();f.preventDefault()}));this.container.delegate(d,"focus",this.bind(function(){if(!this.enabled){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled){return }this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled){return }this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var e;if(this.opts.element.val()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var d=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==L&&f!==null){d.updateSelection(f);d.close();d.clearSearch()}})}},clearSearch:function(){var d=this.getPlaceholder();if(d!==L&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(d).addClass("select2-default");this.resizeSearch()}else{this.search.val(" ").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}else{if(this.search.val()===" "){this.search.val("")}}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(g){var f=[],e=[],d=this;J(g).each(function(){if(B(d.id(this),f)<0){f.push(d.id(this));e.push(this)}});g=e;this.selection.find(".select2-search-choice").remove();J(g).each(function(){d.addSelectedChoice(this)});d.postprocessResults()},tokenize:function(){var d=this.search.val();d=this.opts.tokenizer(d,this.data(),this.bind(this.onSelect),this.opts);if(d!=null&&d!=L){this.search.val(d);if(d.length>0){this.open()}}},onSelect:function(d){this.addSelectedChoice(d);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:d});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(f){var d=J("<li class='select2-search-choice'>    <div></div>    <a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a></li>"),h=this.id(f),g=this.getVal(),e;e=this.opts.formatSelection(f,d);d.find("div").replaceWith("<div>"+V(e)+"</div>");d.find(".select2-search-choice-close").bind("mousedown",D).bind("click dblclick",this.bind(function(i){if(!this.enabled){return }J(i.target).closest(".select2-search-choice").fadeOut("fast").animate({width:"hide"},0,this.bind(function(){this.unselect(J(i.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();D(i)})).bind("focus",this.bind(function(){if(!this.enabled){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}));d.data("select2-data",f);d.insertBefore(this.searchContainer);g.push(h);this.setVal(g)},unselect:function(e){var g=this.getVal(),f,d;e=e.closest(".select2-search-choice");if(e.length===0){throw"Invalid argument: "+e+". Must be .select2-search-choice"}f=e.data("select2-data");d=B(this.id(f),g);if(d>=0){g.splice(d,1);this.setVal(g);if(this.select){this.postprocessResults()}}e.remove();this.triggerChange({removed:f})},postprocessResults:function(){var f=this.getVal(),g=this.results.find(".select2-result-selectable"),e=this.results.find(".select2-result-with-children"),d=this;g.each2(function(j,h){var k=d.id(h.data("select2-data"));if(B(k,f)>=0){h.addClass("select2-disabled").removeClass("select2-result-selectable")}else{h.removeClass("select2-disabled").addClass("select2-result-selectable")}});e.each2(function(h,j){if(j.find(".select2-result-selectable").length==0){j.addClass("select2-disabled")}else{j.removeClass("select2-disabled")}});g.each2(function(j,h){if(!h.hasClass("select2-disabled")&&h.hasClass("select2-result-selectable")){d.highlight(0);return false}})},resizeSearch:function(){var i,g,f,d,e,h=N(this.search);i=Y(this.search)+10;g=this.search.offset().left;f=this.selection.width();d=this.selection.offset().left;e=f-(g-d)-h;if(e<i){e=f-h}if(e<40){e=f-h}this.search.width(e)},getVal:function(){var d;if(this.select){d=this.select.val();return d===null?[]:d}else{d=this.opts.element.val();return M(d,this.opts.separator)}},setVal:function(e){var d;if(this.select){this.select.val(e)}else{d=[];J(e).each(function(){if(B(this,d)<0){d.push(this)}});this.opts.element.val(d.length===0?"":d.join(this.opts.separator))}},val:function(){var f,e=[],d=this;if(arguments.length===0){return this.getVal()}f=arguments[0];if(!f){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return }this.setVal(f);if(this.select){this.select.find(":selected").each(function(){e.push({id:J(this).attr("value"),text:J(this).text()})});this.updateSelection(e)}else{if(this.opts.initSelection===L){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(h){var g=J(h).map(d.id);d.setVal(g);d.updateSelection(h);d.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var e=[],d=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){e.push(d.opts.id(J(this).data("select2-data")))});this.setVal(e);this.triggerChange()},data:function(e){var d=this,f;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return J(this).data("select2-data")}).get()}else{if(!e){e=[]}f=J.map(e,function(g){return d.opts.id(g)});this.setVal(f);this.updateSelection(e);this.clearSearch()}}});J.fn.select2=function(){var g=Array.prototype.slice.call(arguments,0),h,f,i,e,d=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(g.length===0||typeof (g[0])==="object"){h=g.length===0?{}:J.extend({},g[0]);h.element=J(this);if(h.element.get(0).tagName.toLowerCase()==="select"){e=h.element.attr("multiple")}else{e=h.multiple||false;if("tags" in h){h.multiple=e=true}}f=e?new c():new W();f.init(h)}else{if(typeof (g[0])==="string"){if(B(g[0],d)<0){throw"Unknown method: "+g[0]}i=L;f=J(this).data("select2");if(f===L){return }if(g[0]==="container"){i=f.container}else{i=f[g[0]].apply(f,g.slice(1))}if(i!==L){return false}}else{throw"Invalid arguments to select2 plugin: "+g}}});return(i===L)?this:i};J.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",allowPositionAbove:false,formatResult:function(d,e,g){var f=[];I(d.text,g.term,f);return f.join("")},formatSelection:function(e,d){return e.text},formatResultCssClass:function(d){return L},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(d,e){return"Please enter "+(e-d.length)+" more characters"},formatSelectionTooBig:function(d){return"You can only select "+d+" items"},formatLoadMore:function(d){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(d){return d.id},matcher:function(d,e){return e.toUpperCase().indexOf(d.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:Z};window.Select2={query:{ajax:P,local:R,tags:O},util:{debounce:G,markMatch:I},"class":{"abstract":E,single:W,multi:c}}}(jQuery));