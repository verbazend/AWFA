/*
 * FancyBox - jQuery Plugin
 * Simple and fancy lightbox alternative
 *
 * Examples and documentation at: http://fancybox.net
 *
 * Copyright (c) 2008 - 2010 Janis Skarnelis
 * That said, it is hardly a one-person project. Many people have submitted bugs, code, and offered their advice freely. Their support is greatly appreciated.
 *
 * Version: 1.3.4 (11/11/2010)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(b){var m,w,s,n,D,M,k,a,p,Z,c=0,h={},J=[],E=0,g={},Y=[],F=null,O=new Image(),I=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,K=/[^\.]\.(swf)\s*$/i,P,o=1,H=0,T="",B,C,q=false,S=b.extend(b("<div/>")[0],{prop:0}),v=b.browser.msie&&b.browser.version<7&&!window.XMLHttpRequest,R=function(){w.hide();O.onerror=O.onload=null;if(F){F.abort()}m.empty()},X=function(){if(false===h.onError(J,c,h)){w.hide();q=false;return }h.titleShow=false;h.width="auto";h.height="auto";m.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');N()},W=function(){var AC=J[c],z,AB,AE,AD,y,AA;R();h=b.extend({},b.fn.fancybox.defaults,(typeof b(AC).data("fancybox")=="undefined"?h:b(AC).data("fancybox")));AA=h.onStart(J,c,h);if(AA===false){q=false;return }else{if(typeof AA=="object"){h=b.extend(h,AA)}}AE=h.title||(AC.nodeName?b(AC).attr("title"):AC.title)||"";if(AC.nodeName&&!h.orig){h.orig=b(AC).children("img:first").length?b(AC).children("img:first"):b(AC)}if(AE===""&&h.orig&&h.titleFromAlt){AE=h.orig.attr("alt")}z=h.href||(AC.nodeName?b(AC).attr("href"):AC.href)||null;if((/^(?:javascript)/i).test(z)||z=="#"){z=null}if(h.type){AB=h.type;if(!z){z=h.content}}else{if(h.content){AB="html"}else{if(z){if(z.match(I)){AB="image"}else{if(z.match(K)){AB="swf"}else{if(b(AC).hasClass("iframe")){AB="iframe"}else{if(z.indexOf("#")===0){AB="inline"}else{AB="ajax"}}}}}}}if(!AB){X();return }if(AB=="inline"){AC=z.substr(z.indexOf("#"));AB=b(AC).length>0?"inline":"ajax"}h.type=AB;h.href=z;h.title=AE;if(h.autoDimensions){if(h.type=="html"||h.type=="inline"||h.type=="ajax"){h.width="auto";h.height="auto"}else{h.autoDimensions=false}}if(h.modal){h.overlayShow=true;h.hideOnOverlayClick=false;h.hideOnContentClick=false;h.enableEscapeButton=false;h.showCloseButton=false}h.padding=parseInt(h.padding,10);h.margin=parseInt(h.margin,10);m.css("padding",(h.padding+h.margin));b(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){b(this).replaceWith(M.children())});switch(AB){case"html":m.html(h.content);N();break;case"inline":if(b(AC).parent().is("#fancybox-content")===true){q=false;return }b('<div class="fancybox-inline-tmp" />').hide().insertBefore(b(AC)).bind("fancybox-cleanup",function(){b(this).replaceWith(M.children())}).bind("fancybox-cancel",function(){b(this).replaceWith(m.children())});b(AC).appendTo(m);N();break;case"image":q=false;b.fancybox.showActivity();O=new Image();O.onerror=function(){X()};O.onload=function(){q=true;O.onerror=O.onload=null;f()};O.src=z;break;case"swf":h.scrolling="no";AD='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+h.width+'" height="'+h.height+'"><param name="movie" value="'+z+'"></param>';y="";b.each(h.swf,function(AF,AG){AD+='<param name="'+AF+'" value="'+AG+'"></param>';y+=" "+AF+'="'+AG+'"'});AD+='<embed src="'+z+'" type="application/x-shockwave-flash" width="'+h.width+'" height="'+h.height+'"'+y+"></embed></object>";m.html(AD);N();break;case"ajax":q=false;b.fancybox.showActivity();h.ajax.win=h.ajax.success;F=b.ajax(b.extend({},h.ajax,{url:z,data:h.ajax.data||{},error:function(AF,AH,AG){if(AF.status>0){X()}},success:function(AG,AI,AF){var AH=typeof AF=="object"?AF:F;if(AH.status==200){if(typeof h.ajax.win=="function"){AA=h.ajax.win(z,AG,AI,AF);if(AA===false){w.hide();return }else{if(typeof AA=="string"||typeof AA=="object"){AG=AA}}}m.html(AG);N()}}}));break;case"iframe":e();break}},N=function(){var y=h.width,z=h.height;if(y.toString().indexOf("%")>-1){y=parseInt((b(window).width()-(h.margin*2))*parseFloat(y)/100,10)+"px"}else{y=y=="auto"?"auto":y+"px"}if(z.toString().indexOf("%")>-1){z=parseInt((b(window).height()-(h.margin*2))*parseFloat(z)/100,10)+"px"}else{z=z=="auto"?"auto":z+"px"}m.wrapInner('<div style="width:'+y+";height:"+z+";overflow: "+(h.scrolling=="auto"?"auto":(h.scrolling=="yes"?"scroll":"hidden"))+';position:relative;"></div>');h.width=m.width();h.height=m.height();e()},f=function(){h.width=O.width;h.height=O.height;if(h.is2x){h.width=Math.ceil(h.width/2);h.height=Math.ceil(h.height/2)}b("<img />").attr({id:"fancybox-img",src:O.src,alt:h.title}).appendTo(m);e()},e=function(){var z,y;w.hide();if(n.is(":visible")&&false===g.onCleanup(Y,E,g)){b.event.trigger("fancybox-cancel");q=false;return }q=true;b(M.add(s)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");if(n.is(":visible")&&g.titlePosition!=="outside"){n.css("height",n.height())}Y=J;E=c;g=h;if(g.overlayShow){s.css({"background-color":g.overlayColor,opacity:g.overlayOpacity,cursor:g.hideOnOverlayClick?"pointer":"auto",height:b(document).height()});if(!s.is(":visible")){if(v){b("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}s.show()}}else{s.hide()}C=u();L();if(n.is(":visible")){b(k.add(p).add(Z)).hide();z=n.position(),B={top:z.top,left:z.left,width:n.width(),height:n.height()};y=(B.width==C.width&&B.height==C.height);M.fadeTo(g.changeFade,0.3,function(){var AA=function(){M.html(m.contents()).fadeTo(g.changeFade,1,V)};b.event.trigger("fancybox-change");M.empty().removeAttr("filter").css({"border-width":g.padding,width:C.width-g.padding*2,height:h.autoDimensions?"auto":C.height-H-g.padding*2});if(y){AA()}else{S.prop=0;b(S).animate({prop:1},{duration:g.changeSpeed,easing:g.easingChange,step:x,complete:AA})}});return }n.removeAttr("style");M.css("border-width",g.padding);if(g.transitionIn=="elastic"){B=j();M.html(m.contents());n.show();if(g.opacity){C.opacity=0}S.prop=0;b(S).animate({prop:1},{duration:g.speedIn,easing:g.easingIn,step:x,complete:V});return }if(g.titlePosition=="inside"&&H>0){a.show()}M.css({width:C.width-g.padding*2,height:h.autoDimensions?"auto":C.height-H-g.padding*2}).html(m.contents());n.css(C).fadeIn(g.transitionIn=="none"?0:g.speedIn,V)},d=function(y){if(y&&y.length){if(g.titlePosition=="float"){return'<div id="fancybox-title-float-wrap" class="fancybox-title">'+y+"</div>"}return'<div id="fancybox-title-'+g.titlePosition+'" class="fancybox-title">'+y+"</div>"}return false},L=function(){T=g.title||"";H=0;a.empty().removeAttr("style").removeClass();if(g.titleShow===false){a.hide();return }T=b.isFunction(g.titleFormat)?g.titleFormat(T,Y,E,g):d(T);if(!T||T===""){a.hide();return }a.addClass("fancybox-title-"+g.titlePosition).html(T).appendTo("body").show();switch(g.titlePosition){case"inside":a.css({width:C.width-(g.padding*2),marginLeft:g.padding,marginRight:g.padding});H=a.outerHeight(true);a.appendTo(D);C.height+=H;break;case"over":a.css({marginLeft:g.padding,width:C.width-(g.padding*2),bottom:g.padding}).appendTo(D);break;case"float":a.css("left",parseInt((a.width()-C.width-40)/2,10)*-1).appendTo(n);break;default:a.css({width:C.width-(g.padding*2),paddingLeft:g.padding,paddingRight:g.padding}).appendTo(n);break}a.hide()},G=function(){if(g.enableEscapeButton||g.enableKeyboardNav){b(document).bind("keydown.fb",function(y){if(y.keyCode==27&&g.enableEscapeButton){y.preventDefault();b.fancybox.close()}else{if((y.keyCode==37||y.keyCode==39)&&g.enableKeyboardNav&&y.target.tagName!=="INPUT"&&y.target.tagName!=="TEXTAREA"&&y.target.tagName!=="SELECT"){y.preventDefault();b.fancybox[y.keyCode==37?"prev":"next"]()}}})}if(!g.showNavArrows){p.hide();Z.hide();return }if((g.cyclic&&Y.length>1)||E!==0){p.show()}if((g.cyclic&&Y.length>1)||E!=(Y.length-1)){Z.show()}},V=function(){if(!b.support.opacity){M.get(0).style.removeAttribute("filter");n.get(0).style.removeAttribute("filter")}if(h.autoDimensions){M.css("height","auto")}n.css("height","auto");if(T&&T.length){a.show()}if(g.showCloseButton){k.show()}G();if(g.hideOnContentClick){M.bind("click",b.fancybox.close)}if(g.hideOnOverlayClick){s.bind("click",b.fancybox.close)}b(window).bind("resize.fb",b.fancybox.resize);if(g.centerOnScroll){b(window).bind("scroll.fb",b.fancybox.center)}if(g.type=="iframe"){b('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+(b.browser.msie?'allowtransparency="true""':"")+' scrolling="'+h.scrolling+'" src="'+g.href+'"></iframe>').appendTo(M)}n.show();q=false;b.fancybox.center();g.onComplete(Y,E,g);l()},l=function(){var y,z;if((Y.length-1)>E){y=Y[E+1].href;if(typeof y!=="undefined"&&y.match(I)){z=new Image();z.src=y}}if(E>0){y=Y[E-1].href;if(typeof y!=="undefined"&&y.match(I)){z=new Image();z.src=y}}},x=function(z){var y={width:parseInt(B.width+(C.width-B.width)*z,10),height:parseInt(B.height+(C.height-B.height)*z,10),top:parseInt(B.top+(C.top-B.top)*z,10),left:parseInt(B.left+(C.left-B.left)*z,10)};if(typeof C.opacity!=="undefined"){y.opacity=z<0.5?0.5:z}n.css(y);M.css({width:y.width-g.padding*2,height:y.height-(H*z)-g.padding*2})},U=function(){return[b(window).width()-(g.margin*2),b(window).height()-(g.margin*2),b(document).scrollLeft()+g.margin,b(document).scrollTop()+g.margin]},u=function(){var y=U(),AC={},z=g.autoScale,AA=g.padding*2,AB;if(g.width.toString().indexOf("%")>-1){AC.width=parseInt((y[0]*parseFloat(g.width))/100,10)}else{AC.width=g.width+AA}if(g.height.toString().indexOf("%")>-1){AC.height=parseInt((y[1]*parseFloat(g.height))/100,10)}else{AC.height=g.height+AA}if(z&&(AC.width>y[0]||AC.height>y[1])){if(h.type=="image"||h.type=="swf"){AB=(g.width)/(g.height);if((AC.width)>y[0]){AC.width=y[0];AC.height=parseInt(((AC.width-AA)/AB)+AA,10)}if((AC.height)>y[1]){AC.height=y[1];AC.width=parseInt(((AC.height-AA)*AB)+AA,10)}}else{AC.width=Math.min(AC.width,y[0]);AC.height=Math.min(AC.height,y[1])}}AC.top=parseInt(Math.max(y[3]-20,y[3]+((y[1]-AC.height-40)*0.5)),10);AC.left=parseInt(Math.max(y[2]-20,y[2]+((y[0]-AC.width-40)*0.5)),10);return AC},Q=function(y){var z=y.offset();z.top+=parseInt(y.css("paddingTop"),10)||0;z.left+=parseInt(y.css("paddingLeft"),10)||0;z.top+=parseInt(y.css("border-top-width"),10)||0;z.left+=parseInt(y.css("border-left-width"),10)||0;z.width=y.width();z.height=y.height();return z},j=function(){var AB=h.orig?b(h.orig):false,AA={},z,y;if(AB&&AB.length){z=Q(AB);AA={width:z.width+(g.padding*2),height:z.height+(g.padding*2),top:z.top-g.padding-20,left:z.left-g.padding-20}}else{y=U();AA={width:g.padding*2,height:g.padding*2,top:parseInt(y[3]+y[1]*0.5,10),left:parseInt(y[2]+y[0]*0.5,10)}}return AA},A=function(){if(!w.is(":visible")){clearInterval(P);return }b("div",w).css("top",(o*-40)+"px");o=(o+1)%12};b.fn.fancybox=function(y){if(!b(this).length){return this}b(this).data("fancybox",b.extend({},y,(b.metadata?b(this).metadata({type:"class"}):{}))).unbind("click.fb").bind("click.fb",function(AA){AA.preventDefault();if(q){return }q=true;b(this).blur();J=[];c=0;var z=b(this).attr("rel")||"";if(!z||z==""||z==="nofollow"){J.push(this)}else{J=b("a[rel="+z+"], area[rel="+z+"]");c=J.index(this)}W();return });return this};b.fancybox=function(AB){var AA;if(q){return }q=true;AA=typeof arguments[1]!=="undefined"?arguments[1]:{};J=[];c=parseInt(AA.index,10)||0;if(b.isArray(AB)){for(var z=0,y=AB.length;z<y;z++){if(typeof AB[z]=="object"){b(AB[z]).data("fancybox",b.extend({},AA,AB[z]))}else{AB[z]=b({}).data("fancybox",b.extend({content:AB[z]},AA))}}J=jQuery.merge(J,AB)}else{if(typeof AB=="object"){b(AB).data("fancybox",b.extend({},AA,AB))}else{AB=b({}).data("fancybox",b.extend({content:AB},AA))}J.push(AB)}if(c>J.length||c<0){c=0}W()};b.fancybox.showActivity=function(){clearInterval(P);w.show();P=setInterval(A,66)};b.fancybox.hideActivity=function(){w.hide()};b.fancybox.next=function(){return b.fancybox.pos(E+1)};b.fancybox.prev=function(){return b.fancybox.pos(E-1)};b.fancybox.pos=function(y){if(q){return }y=parseInt(y);J=Y;if(y>-1&&y<Y.length){c=y;W()}else{if(g.cyclic&&Y.length>1){c=y>=Y.length?0:Y.length-1;W()}}return };b.fancybox.cancel=function(){if(q){return }q=true;b.event.trigger("fancybox-cancel");R();h.onCancel(J,c,h);q=false};b.fancybox.close=function(){if(q||n.is(":hidden")){return }q=true;if(g&&false===g.onCleanup(Y,E,g)){q=false;return }R();b(k.add(p).add(Z)).hide();b(M.add(s)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");M.find("iframe").attr("src",v&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(g.titlePosition!=="inside"){a.empty()}n.stop();function y(){s.hide();a.empty().hide();n.hide();b.event.trigger("fancybox-cleanup");M.empty();g.onClosed(Y,E,g);Y=h=[];E=c=0;g=h={};q=false}if(g.transitionOut=="elastic"){B=j();var z=n.position();C={top:z.top,left:z.left,width:n.width(),height:n.height()};if(g.opacity){C.opacity=1}a.empty().hide();S.prop=1;b(S).animate({prop:0},{duration:g.speedOut,easing:g.easingOut,step:x,complete:y})}else{n.fadeOut(g.transitionOut=="none"?0:g.speedOut,y)}};b.fancybox.resize=function(){if(s.is(":visible")){s.css("height",b(document).height())}b.fancybox.center(true)};b.fancybox.center=function(){var y,z;if(q){return }z=arguments[0]===true?1:0;y=U();if(!z&&(n.width()>y[0]||n.height()>y[1])){return }n.stop().animate({top:parseInt(Math.max(y[3]-20,y[3]+((y[1]-M.height()-40)*0.5)-g.padding)),left:parseInt(Math.max(y[2]-20,y[2]+((y[0]-M.width()-40)*0.5)-g.padding))},typeof arguments[0]=="number"?arguments[0]:200)};b.fancybox.init=function(){if(b("#fancybox-wrap").length){return }b("body").append(m=b('<div id="fancybox-tmp"></div>'),w=b('<div id="fancybox-loading"><div></div></div>'),s=b('<div id="fancybox-overlay"></div>'),n=b('<div id="fancybox-wrap"></div>'));D=b('<div id="fancybox-outer"></div>').appendTo(n);D.append(M=b('<div id="fancybox-content"></div>'),k=b('<a id="fancybox-close"></a>'),a=b('<div id="fancybox-title"></div>'),p=b('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),Z=b('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));k.click(b.fancybox.close);w.click(b.fancybox.cancel);p.click(function(y){y.preventDefault();b.fancybox.prev()});Z.click(function(y){y.preventDefault();b.fancybox.next()});if(b.fn.mousewheel){n.bind("mousewheel.fb",function(y,z){if(q){y.preventDefault()}else{if(b(y.target).get(0).clientHeight==0||b(y.target).get(0).scrollHeight===b(y.target).get(0).clientHeight){y.preventDefault();b.fancybox[z>0?"prev":"next"]()}}})}if(!b.support.opacity){n.addClass("fancybox-ie")}if(v){w.addClass("fancybox-ie6");n.addClass("fancybox-ie6");b('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(D)}};b.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};b(document).ready(function(){b.fancybox.init()})})(jQuery);var Handlebars={};Handlebars.VERSION="1.0.beta.6";Handlebars.helpers={};Handlebars.partials={};Handlebars.registerHelper=function(B,C,A){if(A){C.not=A}this.helpers[B]=C};Handlebars.registerPartial=function(A,B){this.partials[A]=B};Handlebars.registerHelper("helperMissing",function(A){if(arguments.length===2){return undefined}else{throw new Error("Could not find property '"+A+"'")}});var toString=Object.prototype.toString,functionType="[object Function]";Handlebars.registerHelper("blockHelperMissing",function(F,D){var A=D.inverse||function(){},H=D.fn;var C="";var G=toString.call(F);if(G===functionType){F=F.call(this)}if(F===true){return H(this)}else{if(F===false||F==null){return A(this)}else{if(G==="[object Array]"){if(F.length>0){for(var E=0,B=F.length;E<B;E++){C=C+H(F[E])}}else{C=A(this)}return C}else{return H(F)}}}});Handlebars.registerHelper("each",function(F,D){var G=D.fn,A=D.inverse;var C="";if(F&&F.length>0){for(var E=0,B=F.length;E<B;E++){C=C+G(F[E])}}else{C=A(this)}return C});Handlebars.registerHelper("if",function(B,A){var C=toString.call(B);if(C===functionType){B=B.call(this)}if(!B||Handlebars.Utils.isEmpty(B)){return A.inverse(this)}else{return A.fn(this)}});Handlebars.registerHelper("unless",function(C,B){var D=B.fn,A=B.inverse;B.fn=A;B.inverse=D;return Handlebars.helpers["if"].call(this,C,B)});Handlebars.registerHelper("with",function(B,A){return A.fn(B)});Handlebars.registerHelper("log",function(A){Handlebars.log(A)});var handlebars=(function(){var F={trace:function C(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function B(G,J,K,N,M,I,L){var H=I.length-1;switch(M){case 1:return I[H-1];break;case 2:this.$=new N.ProgramNode(I[H-2],I[H]);break;case 3:this.$=new N.ProgramNode(I[H]);break;case 4:this.$=new N.ProgramNode([]);break;case 5:this.$=[I[H]];break;case 6:I[H-1].push(I[H]);this.$=I[H-1];break;case 7:this.$=new N.InverseNode(I[H-2],I[H-1],I[H]);break;case 8:this.$=new N.BlockNode(I[H-2],I[H-1],I[H]);break;case 9:this.$=I[H];break;case 10:this.$=I[H];break;case 11:this.$=new N.ContentNode(I[H]);break;case 12:this.$=new N.CommentNode(I[H]);break;case 13:this.$=new N.MustacheNode(I[H-1][0],I[H-1][1]);break;case 14:this.$=new N.MustacheNode(I[H-1][0],I[H-1][1]);break;case 15:this.$=I[H-1];break;case 16:this.$=new N.MustacheNode(I[H-1][0],I[H-1][1]);break;case 17:this.$=new N.MustacheNode(I[H-1][0],I[H-1][1],true);break;case 18:this.$=new N.PartialNode(I[H-1]);break;case 19:this.$=new N.PartialNode(I[H-2],I[H-1]);break;case 20:break;case 21:this.$=[[I[H-2]].concat(I[H-1]),I[H]];break;case 22:this.$=[[I[H-1]].concat(I[H]),null];break;case 23:this.$=[[I[H-1]],I[H]];break;case 24:this.$=[[I[H]],null];break;case 25:I[H-1].push(I[H]);this.$=I[H-1];break;case 26:this.$=[I[H]];break;case 27:this.$=I[H];break;case 28:this.$=new N.StringNode(I[H]);break;case 29:this.$=new N.IntegerNode(I[H]);break;case 30:this.$=new N.BooleanNode(I[H]);break;case 31:this.$=new N.HashNode(I[H]);break;case 32:I[H-1].push(I[H]);this.$=I[H-1];break;case 33:this.$=[I[H]];break;case 34:this.$=[I[H-2],I[H]];break;case 35:this.$=[I[H-2],new N.StringNode(I[H])];break;case 36:this.$=[I[H-2],new N.IntegerNode(I[H])];break;case 37:this.$=[I[H-2],new N.BooleanNode(I[H])];break;case 38:this.$=new N.IdNode(I[H]);break;case 39:I[H-2].push(I[H]);this.$=I[H-2];break;case 40:this.$=[I[H]];break}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function D(H,G){throw new Error(H)},parse:function E(O){var V=this,L=[0],f=[null],Q=[],g=this.table,H="",P=0,d=0,J=0,N=2,S=1;this.lexer.setInput(O);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var I=this.lexer.yylloc;Q.push(I);if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function U(a){L.length=L.length-2*a;f.length=f.length-a;Q.length=Q.length-a}function T(){var a;a=V.lexer.lex()||1;if(typeof a!=="number"){a=V.symbols_[a]||a}return a}var c,X,K,b,h,R,Z={},W,e,G,M;while(true){K=L[L.length-1];if(this.defaultActions[K]){b=this.defaultActions[K]}else{if(c==null){c=T()}b=g[K]&&g[K][c]}if(typeof b==="undefined"||!b.length||!b[0]){if(!J){M=[];for(W in g[K]){if(this.terminals_[W]&&W>2){M.push("'"+this.terminals_[W]+"'")}}var Y="";if(this.lexer.showPosition){Y="Parse error on line "+(P+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+M.join(", ")+", got '"+this.terminals_[c]+"'"}else{Y="Parse error on line "+(P+1)+": Unexpected "+(c==1?"end of input":"'"+(this.terminals_[c]||c)+"'")}this.parseError(Y,{text:this.lexer.match,token:this.terminals_[c]||c,line:this.lexer.yylineno,loc:I,expected:M})}}if(b[0] instanceof Array&&b.length>1){throw new Error("Parse Error: multiple actions possible at state: "+K+", token: "+c)}switch(b[0]){case 1:L.push(c);f.push(this.lexer.yytext);Q.push(this.lexer.yylloc);L.push(b[1]);c=null;if(!X){d=this.lexer.yyleng;H=this.lexer.yytext;P=this.lexer.yylineno;I=this.lexer.yylloc;if(J>0){J--}}else{c=X;X=null}break;case 2:e=this.productions_[b[1]][1];Z.$=f[f.length-e];Z._$={first_line:Q[Q.length-(e||1)].first_line,last_line:Q[Q.length-1].last_line,first_column:Q[Q.length-(e||1)].first_column,last_column:Q[Q.length-1].last_column};R=this.performAction.call(Z,H,d,P,this.yy,b[1],f,Q);if(typeof R!=="undefined"){return R}if(e){L=L.slice(0,-1*e*2);f=f.slice(0,-1*e);Q=Q.slice(0,-1*e)}L.push(this.productions_[b[1]][0]);f.push(Z.$);Q.push(Z._$);G=g[L[L.length-2]][L[L.length-1]];L.push(G);break;case 3:return true}}return true}};var A=(function(){var J=({EOF:1,parseError:function L(O,N){if(this.yy.parseError){this.yy.parseError(O,N)}else{throw new Error(O)}},setInput:function(N){this._input=N;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var O=this._input[0];this.yytext+=O;this.yyleng++;this.match+=O;this.matched+=O;var N=O.match(/\n/);if(N){this.yylineno++}this._input=this._input.slice(1);return O},unput:function(N){this._input=N+this._input;return this},more:function(){this._more=true;return this},pastInput:function(){var N=this.matched.substr(0,this.matched.length-this.match.length);return(N.length>20?"...":"")+N.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var N=this.match;if(N.length<20){N+=this._input.substr(0,20-N.length)}return(N.substr(0,20)+(N.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var N=this.pastInput();var O=new Array(N.length+1).join("-");return N+this.upcomingInput()+"\n"+O+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var R,P,O,N;if(!this._more){this.yytext="";this.match=""}var S=this._currentRules();for(var Q=0;Q<S.length;Q++){P=this._input.match(this.rules[S[Q]]);if(P){N=P[0].match(/\n.*/g);if(N){this.yylineno+=N.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:N?N[N.length-1].length-1:this.yylloc.last_column+P[0].length};this.yytext+=P[0];this.match+=P[0];this.matches=P;this.yyleng=this.yytext.length;this._more=false;this._input=this._input.slice(P[0].length);this.matched+=P[0];R=this.performAction.call(this,this.yy,this,S[Q],this.conditionStack[this.conditionStack.length-1]);if(R){return R}else{return }}}if(this._input===""){return this.EOF}else{this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function G(){var N=this.next();if(typeof N!=="undefined"){return N}else{return this.lex()}},begin:function H(N){this.conditionStack.push(N)},popState:function M(){return this.conditionStack.pop()},_currentRules:function K(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function H(N){this.begin(N)}});J.performAction=function I(R,O,Q,N){var P=N;switch(Q){case 0:if(O.yytext.slice(-1)!=="\\"){this.begin("mu")}if(O.yytext.slice(-1)==="\\"){O.yytext=O.yytext.substr(0,O.yyleng-1),this.begin("emu")}if(O.yytext){return 14}break;case 1:return 14;break;case 2:this.popState();return 14;break;case 3:return 24;break;case 4:return 16;break;case 5:return 20;break;case 6:return 19;break;case 7:return 19;break;case 8:return 23;break;case 9:return 23;break;case 10:O.yytext=O.yytext.substr(3,O.yyleng-5);this.popState();return 15;break;case 11:return 22;break;case 12:return 34;break;case 13:return 33;break;case 14:return 33;break;case 15:return 36;break;case 16:break;case 17:this.popState();return 18;break;case 18:this.popState();return 18;break;case 19:O.yytext=O.yytext.substr(1,O.yyleng-2).replace(/\\"/g,'"');return 28;break;case 20:return 30;break;case 21:return 30;break;case 22:return 29;break;case 23:return 33;break;case 24:O.yytext=O.yytext.substr(1,O.yyleng-2);return 33;break;case 25:return"INVALID";break;case 26:return 5;break}};J.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^[^\x00]{2,}?(?=(\{\{))/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[\/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s\/.])/,/^\[[^\]]*\]/,/^./,/^$/];J.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],inclusive:false},emu:{rules:[2],inclusive:false},INITIAL:{rules:[0,1,26],inclusive:true}};return J})();F.lexer=A;return F})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=handlebars;exports.parse=function(){return handlebars.parse.apply(handlebars,arguments)};exports.main=function commonjsMain(A){if(!A[1]){throw new Error("Usage: "+A[0]+" FILE")}if(typeof process!=="undefined"){var C=require("fs").readFileSync(require("path").join(process.cwd(),A[1]),"utf8")}else{var B=require("file").path(require("file").cwd());var C=B.join(A[1]).read({charset:"utf-8"})}return exports.parser.parse(C)};if(typeof module!=="undefined"&&require.main===module){exports.main(typeof process!=="undefined"?process.argv.slice(1):require("system").args)}}Handlebars.Parser=handlebars;Handlebars.parse=function(A){Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(A)};Handlebars.print=function(A){return new Handlebars.PrintVisitor().accept(A)};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(B,A){}};Handlebars.log=function(B,A){Handlebars.logger.log(B,A)};(function(){Handlebars.AST={};Handlebars.AST.ProgramNode=function(C,B){this.type="program";this.statements=C;if(B){this.inverse=new Handlebars.AST.ProgramNode(B)}};Handlebars.AST.MustacheNode=function(D,C,B){this.type="mustache";this.id=D[0];this.params=D.slice(1);this.hash=C;this.escaped=!B};Handlebars.AST.PartialNode=function(C,B){this.type="partial";this.id=C;this.context=B};var A=function(B,C){if(B.original!==C.original){throw new Handlebars.Exception(B.original+" doesn't match "+C.original)}};Handlebars.AST.BlockNode=function(C,B,D){A(C.id,D);this.type="block";this.mustache=C;this.program=B};Handlebars.AST.InverseNode=function(C,B,D){A(C.id,D);this.type="inverse";this.mustache=C;this.program=B};Handlebars.AST.ContentNode=function(B){this.type="content";this.string=B};Handlebars.AST.HashNode=function(B){this.type="hash";this.pairs=B};Handlebars.AST.IdNode=function(F){this.type="ID";this.original=F.join(".");var D=[],G=0;for(var E=0,B=F.length;E<B;E++){var C=F[E];if(C===".."){G++}else{if(C==="."||C==="this"){this.isScoped=true}else{D.push(C)}}}this.parts=D;this.string=D.join(".");this.depth=G;this.isSimple=(D.length===1)&&(G===0)};Handlebars.AST.StringNode=function(B){this.type="STRING";this.string=B};Handlebars.AST.IntegerNode=function(B){this.type="INTEGER";this.integer=B};Handlebars.AST.BooleanNode=function(B){this.type="BOOLEAN";this.bool=B};Handlebars.AST.CommentNode=function(B){this.type="comment";this.comment=B}})();Handlebars.Exception=function(B){var A=Error.prototype.constructor.apply(this,arguments);for(var C in A){if(A.hasOwnProperty(C)){this[C]=A[C]}}this.message=A.message};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(A){this.string=A};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};(function(){var C={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var D=/&(?!\w+;)|[<>"'`]/g;var B=/[&<>"'`]/;var A=function(E){return C[E]||"&amp;"};Handlebars.Utils={escapeExpression:function(E){if(E instanceof Handlebars.SafeString){return E.toString()}else{if(E==null||E===false){return""}}if(!B.test(E)){return E}return E.replace(D,A)},isEmpty:function(E){if(typeof E==="undefined"){return true}else{if(E===null){return true}else{if(E===false){return true}else{if(Object.prototype.toString.call(E)==="[object Array]"&&E.length===0){return true}else{return false}}}}}}})();Handlebars.Compiler=function(){};Handlebars.JavaScriptCompiler=function(){};(function(F,E){F.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16};F.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1};F.DISASSEMBLE_MAP={};for(var H in F.OPCODE_MAP){var G=F.OPCODE_MAP[H];F.DISASSEMBLE_MAP[G]=H}F.multiParamSize=function(I){return F.MULTI_PARAM_OPCODES[F.DISASSEMBLE_MAP[I]]};F.prototype={compiler:F,disassemble:function(){var Q=this.opcodes,O,K;var N=[],S,J,T;for(var P=0,L=Q.length;P<L;P++){O=Q[P];if(O==="DECLARE"){J=Q[++P];T=Q[++P];N.push("DECLARE "+J+" = "+T)}else{S=F.DISASSEMBLE_MAP[O];var R=F.multiParamSize(O);var I=[];for(var M=0;M<R;M++){K=Q[++P];if(typeof K==="string"){K='"'+K.replace("\n","\\n")+'"'}I.push(K)}S=S+" "+I.join(" ");N.push(S)}}return N.join("\n")},guid:0,compile:function(I,K){this.children=[];this.depths={list:[]};this.options=K;var L=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(L){for(var J in L){this.options.knownHelpers[J]=L[J]}}return this.program(I)},accept:function(I){return this[I.type](I)},program:function(K){var J=K.statements,M;this.opcodes=[];for(var L=0,I=J.length;L<I;L++){M=J[L];this[M.type](M)}this.isSimple=I===1;this.depths.list=this.depths.list.sort(function(O,N){return O-N});return this},compileProgram:function(K){var I=new this.compiler().compile(K,this.options);var L=this.guid++;this.usePartial=this.usePartial||I.usePartial;this.children[L]=I;for(var M=0,J=I.depths.list.length;M<J;M++){depth=I.depths.list[M];if(depth<2){continue}else{this.addDepth(depth-1)}}return L},block:function(O){var L=O.mustache;var N,P,J,K;var M=this.setupStackForMustache(L);var I=this.compileProgram(O.program);if(O.program.inverse){K=this.compileProgram(O.program.inverse);this.declare("inverse",K)}this.opcode("invokeProgram",I,M.length,!!L.hash);this.declare("inverse",null);this.opcode("append")},inverse:function(K){var J=this.setupStackForMustache(K.mustache);var I=this.compileProgram(K.program);this.declare("inverse",I);this.opcode("invokeProgram",null,J.length,!!K.mustache.hash);this.declare("inverse",null);this.opcode("append")},hash:function(L){var K=L.pairs,N,M;this.opcode("push","{}");for(var J=0,I=K.length;J<I;J++){N=K[J];M=N[1];this.accept(M);this.opcode("assignToHash",N[0])}},partial:function(I){var J=I.id;this.usePartial=true;if(I.context){this.ID(I.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",J.original);this.opcode("append")},content:function(I){this.opcode("appendContent",I.string)},mustache:function(I){var J=this.setupStackForMustache(I);this.opcode("invokeMustache",J.length,I.id.original,!!I.hash);if(I.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ID:function(K){this.addDepth(K.depth);this.opcode("getContext",K.depth);this.opcode("lookupWithHelpers",K.parts[0]||null,K.isScoped||false);for(var J=1,I=K.parts.length;J<I;J++){this.opcode("lookup",K.parts[J])}},STRING:function(I){this.opcode("pushString",I.string)},INTEGER:function(I){this.opcode("push",I.integer)},BOOLEAN:function(I){this.opcode("push",I.bool)},comment:function(){},pushParams:function(K){var I=K.length,J;while(I--){J=K[I];if(this.options.stringParams){if(J.depth){this.addDepth(J.depth)}this.opcode("getContext",J.depth||0);this.opcode("pushStringParam",J.string)}else{this[J.type](J)}}},opcode:function(I,L,K,J){this.opcodes.push(F.OPCODE_MAP[I]);if(L!==undefined){this.opcodes.push(L)}if(K!==undefined){this.opcodes.push(K)}if(J!==undefined){this.opcodes.push(J)}},declare:function(I,J){this.opcodes.push("DECLARE");this.opcodes.push(I);this.opcodes.push(J)},addDepth:function(I){if(I===0){return }if(!this.depths[I]){this.depths[I]=true;this.depths.list.push(I)}},setupStackForMustache:function(I){var J=I.params;this.pushParams(J);if(I.hash){this.hash(I.hash)}this.ID(I.id);return J}};E.prototype={nameLookup:function(K,I,J){if(/^[0-9]+$/.test(I)){return K+"["+I+"]"}else{if(E.isValidJavaScriptVariableName(I)){return K+"."+I}else{return K+"['"+I+"']"}}},appendToBuffer:function(I){if(this.environment.isSimple){return"return "+I+";"}else{return"buffer += "+I+";"}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(I,J,L,K){this.environment=I;this.options=J||{};this.name=this.environment.name;this.isChild=!!L;this.context=L||{programs:[],aliases:{self:"this"},registers:{list:[]}};this.preamble();this.stackSlot=0;this.stackVars=[];this.compileChildren(I,J);var N=I.opcodes,M;this.i=0;for(B=N.length;this.i<B;this.i++){M=this.nextOpcode(0);if(M[0]==="DECLARE"){this.i=this.i+2;this[M[1]]=M[2]}else{this.i=this.i+M[1].length;this[M[0]].apply(this,M[1])}}return this.createFunctionContext(K)},nextOpcode:function(P){var M=this.environment.opcodes,L=M[this.i+P],K,N;var O,I;if(L==="DECLARE"){K=M[this.i+1];N=M[this.i+2];return["DECLARE",K,N]}else{K=F.DISASSEMBLE_MAP[L];O=F.multiParamSize(L);I=[];for(var J=0;J<O;J++){I.push(M[this.i+J+1+P])}return[K,I]}},eat:function(I){this.i=this.i+I.length},preamble:function(){var I=[];this.useRegister("foundHelper");if(!this.isChild){var J=this.namespace;var K="helpers = helpers || "+J+".helpers;";if(this.environment.usePartial){K=K+" partials = partials || "+J+".partials;"}I.push(K)}else{I.push("")}if(!this.environment.isSimple){I.push(", buffer = "+this.initializeBuffer())}else{I.push("")}this.lastContext=0;this.source=I},createFunctionContext:function(N){var O=this.stackVars;if(!this.isChild){O=O.concat(this.context.registers.list)}if(O.length>0){this.source[1]=this.source[1]+", "+O.join(", ")}if(!this.isChild){var J=[];for(var M in this.context.aliases){this.source[1]=this.source[1]+", "+M+"="+this.context.aliases[M]}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.source.push("return buffer;")}var P=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var L=0,I=this.environment.depths.list.length;L<I;L++){P.push("depth"+this.environment.depths.list[L])}if(N){P.push(this.source.join("\n  "));return Function.apply(this,P)}else{var K="function "+(this.name||"")+"("+P.join(",")+") {\n  "+this.source.join("\n  ")+"}";Handlebars.log(Handlebars.logger.DEBUG,K+"\n\n");return K}},appendContent:function(I){this.source.push(this.appendToBuffer(this.quotedString(I)))},append:function(){var I=this.popStack();this.source.push("if("+I+" || "+I+" === 0) { "+this.appendToBuffer(I)+" }");if(this.environment.isSimple){this.source.push("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){var J=this.nextOpcode(1),I="";this.context.aliases.escapeExpression="this.escapeExpression";if(J[0]==="appendContent"){I=" + "+this.quotedString(J[1][0]);this.eat(J)}this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+I))},getContext:function(I){if(this.lastContext!==I){this.lastContext=I}},lookupWithHelpers:function(K,L){if(K){var I=this.nextStack();this.usingKnownHelper=false;var J;if(!L&&this.options.knownHelpers[K]){J=I+" = "+this.nameLookup("helpers",K,"helper");this.usingKnownHelper=true}else{if(L||this.options.knownHelpersOnly){J=I+" = "+this.nameLookup("depth"+this.lastContext,K,"context")}else{this.register("foundHelper",this.nameLookup("helpers",K,"helper"));J=I+" = foundHelper || "+this.nameLookup("depth"+this.lastContext,K,"context")}}J+=";";this.source.push(J)}else{this.pushStack("depth"+this.lastContext)}},lookup:function(J){var I=this.topStack();this.source.push(I+" = ("+I+" === null || "+I+" === undefined || "+I+" === false ? "+I+" : "+this.nameLookup(I,J,"context")+");")},pushStringParam:function(I){this.pushStack("depth"+this.lastContext);this.pushString(I)},pushString:function(I){this.pushStack(this.quotedString(I))},push:function(I){this.pushStack(I)},invokeMustache:function(K,J,I){this.populateParams(K,this.quotedString(J),"{}",null,I,function(L,N,M){if(!this.usingKnownHelper){this.context.aliases.helperMissing="helpers.helperMissing";this.context.aliases.undef="void 0";this.source.push("else if("+M+"=== undef) { "+L+" = helperMissing.call("+N+"); }");if(L!==M){this.source.push("else { "+L+" = "+M+"; }")}}})},invokeProgram:function(K,L,J){var I=this.programExpression(this.inverse);var M=this.programExpression(K);this.populateParams(L,null,M,I,J,function(N,P,O){if(!this.usingKnownHelper){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";this.source.push("else { "+N+" = blockHelperMissing.call("+P+"); }")}})},populateParams:function(O,J,S,P,W,V){var K=W||this.options.stringParams||P||this.options.data;var I=this.popStack(),U;var M=[],L,N,T;if(K){this.register("tmp1",S);T="tmp1"}else{T="{ hash: {} }"}if(K){var R=(W?this.popStack():"{}");this.source.push("tmp1.hash = "+R+";")}if(this.options.stringParams){this.source.push("tmp1.contexts = [];")}for(var Q=0;Q<O;Q++){L=this.popStack();M.push(L);if(this.options.stringParams){this.source.push("tmp1.contexts.push("+this.popStack()+");")}}if(P){this.source.push("tmp1.fn = tmp1;");this.source.push("tmp1.inverse = "+P+";")}if(this.options.data){this.source.push("tmp1.data = data;")}M.push(T);this.populateCall(M,I,J||I,V,S!=="{}")},populateCall:function(N,J,K,Q,O){var M=["depth0"].concat(N).join(", ");var I=["depth0"].concat(K).concat(N).join(", ");var P=this.nextStack();if(this.usingKnownHelper){this.source.push(P+" = "+J+".call("+M+");")}else{this.context.aliases.functionType='"function"';var L=O?"foundHelper && ":"";this.source.push("if("+L+"typeof "+J+" === functionType) { "+P+" = "+J+".call("+M+"); }")}Q.call(this,P,I,J);this.usingKnownHelper=false},invokePartial:function(I){params=[this.nameLookup("partials",I,"partial"),"'"+I+"'",this.popStack(),"helpers","partials"];if(this.options.data){params.push("data")}this.pushStack("self.invokePartial("+params.join(", ")+");")},assignToHash:function(I){var J=this.popStack();var K=this.topStack();this.source.push(K+"['"+I+"'] = "+J+";")},compiler:E,compileChildren:function(I,L){var N=I.children,P,O;for(var M=0,J=N.length;M<J;M++){P=N[M];O=new this.compiler();this.context.programs.push("");var K=this.context.programs.length;P.index=K;P.name="program"+K;this.context.programs[K]=O.compile(P,L,this.context)}},programExpression:function(J){if(J==null){return"self.noop"}var N=this.environment.children[J],M=N.depths.list;var L=[N.index,N.name,"data"];for(var K=0,I=M.length;K<I;K++){depth=M[K];if(depth===1){L.push("depth0")}else{L.push("depth"+(depth-1))}}if(M.length===0){return"self.program("+L.join(", ")+")"}else{L.shift();return"self.programWithDepth("+L.join(", ")+")"}},register:function(I,J){this.useRegister(I);this.source.push(I+" = "+J+";")},useRegister:function(I){if(!this.context.registers[I]){this.context.registers[I]=true;this.context.registers.list.push(I)}},pushStack:function(I){this.source.push(this.nextStack()+" = "+I+";");return"stack"+this.stackSlot},nextStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(I){return'"'+I.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};var A=("break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield").split(" ");var D=E.RESERVED_WORDS={};for(var C=0,B=A.length;C<B;C++){D[A[C]]=true}E.isValidJavaScriptVariableName=function(I){if(!E.RESERVED_WORDS[I]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(I)){return true}return false}})(Handlebars.Compiler,Handlebars.JavaScriptCompiler);Handlebars.precompile=function(D,C){C=C||{};var B=Handlebars.parse(D);var A=new Handlebars.Compiler().compile(B,C);return new Handlebars.JavaScriptCompiler().compile(A,C)};Handlebars.compile=function(B,A){A=A||{};var D;function C(){var G=Handlebars.parse(B);var F=new Handlebars.Compiler().compile(G,A);var E=new Handlebars.JavaScriptCompiler().compile(F,A,undefined,true);return Handlebars.template(E)}return function(F,E){if(!D){D=C()}return D.call(this,F,E)}};Handlebars.VM={template:function(A){var B={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(D,E,F){var C=this.programs[D];if(F){return Handlebars.VM.program(E,F)}else{if(C){return C}else{C=this.programs[D]=Handlebars.VM.program(E);return C}}},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(D,C){C=C||{};return A.call(B,Handlebars,D,C.helpers,C.partials,C.data)}},programWithDepth:function(B,D,C){var A=Array.prototype.slice.call(arguments,2);return function(F,E){E=E||{};return B.apply(this,[F,E.data||D].concat(A))}},program:function(A,B){return function(D,C){C=C||{};return A(D,C.data||B)}},noop:function(){return""},invokePartial:function(A,B,D,E,C,F){options={helpers:E,partials:C,data:F};if(A===undefined){throw new Handlebars.Exception("The partial "+B+" could not be found")}else{if(A instanceof Function){return A(D,options)}else{if(!Handlebars.compile){throw new Handlebars.Exception("The partial "+B+" could not be compiled when running in runtime-only mode")}else{C[B]=Handlebars.compile(A);return C[B](D,options)}}}}};Handlebars.template=Handlebars.VM.template;(function(C){var A=C.scrollTo=function(F,E,D){C(window).scrollTo(F,E,D)};A.defaults={axis:"xy",duration:parseFloat(C.fn.jquery)>=1.3?0:1};A.window=function(D){return C(window)._scrollable()};C.fn._scrollable=function(){return this.map(function(){var E=this,D=!E.nodeName||C.inArray(E.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!D){return E}var F=(E.contentWindow||E).document||E.ownerDocument||E;return C.browser.safari||F.compatMode=="BackCompat"?F.body:F.documentElement})};C.fn.scrollTo=function(F,E,D){if(typeof E=="object"){D=E;E=0}if(typeof D=="function"){D={onAfter:D}}if(F=="max"){F=9000000000}D=C.extend({},A.defaults,D);E=E||D.speed||D.duration;D.queue=D.queue&&D.axis.length>1;if(D.queue){E/=2}D.offset=B(D.offset);D.over=B(D.over);return this._scrollable().each(function(){var L=this,J=C(L),K=F,I,G={},M=J.is("html,body");switch(typeof K){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(K)){K=B(K);break}K=C(K,this);case"object":if(K.is||K.style){I=(K=C(K)).offset()}}C.each(D.axis.split(""),function(Q,R){var S=R=="x"?"Left":"Top",U=S.toLowerCase(),P="scroll"+S,O=L[P],N=A.max(L,R);if(I){G[P]=I[U]+(M?0:O-J.offset()[U]);if(D.margin){G[P]-=parseInt(K.css("margin"+S))||0;G[P]-=parseInt(K.css("border"+S+"Width"))||0}G[P]+=D.offset[U]||0;if(D.over[U]){G[P]+=K[R=="x"?"width":"height"]()*D.over[U]}}else{var T=K[U];G[P]=T.slice&&T.slice(-1)=="%"?parseFloat(T)/100*N:T}if(/^\d+$/.test(G[P])){G[P]=G[P]<=0?0:Math.min(G[P],N)}if(!Q&&D.queue){if(O!=G[P]){H(D.onAfterFirst)}delete G[P]}});H(D.onAfter);function H(N){J.animate(G,E,D.easing,N&&function(){N.call(this,F,D)})}}).end()};A.max=function(J,I){var H=I=="x"?"Width":"Height",E="scroll"+H;if(!C(J).is("html,body")){return J[E]-C(J)[H.toLowerCase()]()}var G="client"+H,F=J.ownerDocument.documentElement,D=J.ownerDocument.body;return Math.max(F[E],D[E])-Math.min(F[G],D[G])};function B(D){return typeof D=="object"?D:{top:D,left:D}}})(jQuery);(function(A){if(typeof A.fn.each2=="undefined"){A.fn.extend({each2:function(E){var C=A([0]),D=-1,B=this.length;while(++D<B&&(C.context=C[0]=this[D])&&E.call(C[0],D,C)!==false){}return this}})}})(jQuery);(function(J,L){if(window.Select2!==L){return }var C,E,W,c,T,A;C={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(d){d=d.which?d.which:d;switch(d){case C.LEFT:case C.RIGHT:case C.UP:case C.DOWN:return true}return false},isControl:function(f){var d=f.which;switch(d){case C.SHIFT:case C.CTRL:case C.ALT:return true}if(f.metaKey){return true}return false},isFunctionKey:function(d){d=d.which?d.which:d;return d>=112&&d<=123}};T=(function(){var d=1;return function(){return d++}}());function V(d){if(d&&typeof (d)==="string"){return d.replace(/&/g,"&amp;")}else{return d}}function B(g,h){var f=0,d=h.length,e;if(typeof g==="undefined"){return -1}if(g.constructor===String){for(;f<d;f=f+1){if(g.localeCompare(h[f])===0){return f}}}else{for(;f<d;f=f+1){e=h[f];if(e.constructor===String){if(e.localeCompare(g)===0){return f}}else{if(e===g){return f}}}}return -1}function Q(e,d){if(e===d){return true}if(e===L||d===L){return false}if(e===null||d===null){return false}if(e.constructor===String){return e.localeCompare(d)===0}if(d.constructor===String){return d.localeCompare(e)===0}return false}function M(e,g){var h,f,d;if(e===null||e.length<1){return[]}h=e.split(g);for(f=0,d=h.length;f<d;f=f+1){h[f]=J.trim(h[f])}return h}function N(d){return d.outerWidth()-d.width()}function a(e){var d="keyup-change-value";e.bind("keydown",function(){if(J.data(e,d)===L){J.data(e,d,e.val())}});e.bind("keyup",function(){var f=J.data(e,d);if(f!==L&&e.val()!==f){J.removeData(e,d);e.trigger("keyup-change")}})}J(document).delegate("*","mousemove",function(d){J.data(document,"select2-lastpos",{x:d.pageX,y:d.pageY})});function U(d){d.bind("mousemove",function(g){var f=J.data(document,"select2-lastpos");if(f===L||f.x!==g.pageX||f.y!==g.pageY){J(g.target).trigger("mousemove-filtered",g)}})}function G(f,d){var e;return function(){window.clearTimeout(e);e=window.setTimeout(d,f)}}function b(f){var d=false,e;return function(){if(d===false){e=f();d=true}return e}}function F(d,f){var e=G(d,function(g){f.trigger("scroll-debounced",g)});f.bind("scroll",function(g){if(B(g.target,f.get())>=0){e(g)}})}function D(d){d.preventDefault();d.stopPropagation()}function Y(f){if(!A){var d=f[0].currentStyle||window.getComputedStyle(f[0],null);A=J("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:d.fontSize,fontFamily:d.fontFamily,fontStyle:d.fontStyle,fontWeight:d.fontWeight,letterSpacing:d.letterSpacing,textTransform:d.textTransform,whiteSpace:"nowrap"});J("body").append(A)}A.text(f.val());return A.width()}function I(h,g,e){var f=h.toUpperCase().indexOf(g.toUpperCase()),d=g.length;if(f<0){e.push(h);return }e.push(h.substring(0,f));e.push("<span class='select2-match'>");e.push(h.substring(f,f+d));e.push("</span>");e.push(h.substring(f+d,h.length))}function P(e){var g,d=0,f=null,h=e.quietMillis||100;return function(j){window.clearTimeout(g);g=window.setTimeout(function(){d+=1;var k=d,n=e.data,o=e.transport||J.ajax,m=e.traditional||false,l=e.type||"GET";n=n.call(this,j.term,j.page,j.context);if(null!==f){f.abort()}f=o.call(null,{url:e.url,dataType:e.dataType,data:n,type:l,traditional:m,success:function(q){if(k<d){return }var p=e.results(q,j.page);j.callback(p)}})},h)}}function R(d){var f=d,e,g=function(h){return""+h.text};if(!J.isArray(f)){g=f.text;if(!J.isFunction(g)){e=f.text;g=function(h){return h[e]}}f=f.results}return function(k){var j=k.term,h={};if(j===""){k.callback({results:f});return }h.results=J(f).filter(function(){return k.matcher(j,g(this))}).get();k.callback(h)}}function O(d){if(J.isFunction(d)){return d}return function(g){var f=g.term,e={results:[]};J(d).each(function(){var h=this.text!==L,j=h?this.text:this;if(f===""||g.matcher(f,j)){e.results.push(h?this:{id:this,text:this})}});g.callback(e)}}function K(d,e){if(J.isFunction(d)){return true}if(!d){return false}throw new Error("formatterName must be a function or a falsy value")}function S(d){return J.isFunction(d)?d():d}function H(d){var e=0;J.each(d,function(f,g){if(g.children){e+=H(g.children)}else{e++}});return e}function Z(n,o,k,d){var e=n,p=false,g,m,h,f,j;if(!d.createSearchChoice||!d.tokenSeparators||d.tokenSeparators.length<1){return L}while(true){m=-1;for(h=0,f=d.tokenSeparators.length;h<f;h++){j=d.tokenSeparators[h];m=n.indexOf(j);if(m>=0){break}}if(m<0){break}g=n.substring(0,m);n=n.substring(m+j.length);if(g.length>0){g=d.createSearchChoice(g,o);if(g!==L&&g!==null&&d.id(g)!==L&&d.id(g)!==null){p=false;for(h=0,f=o.length;h<f;h++){if(Q(d.id(g),d.id(o[h]))){p=true;break}}if(!p){k(g)}}}}if(e.localeCompare(n)!=0){return n}}J(document).ready(function(){J(document).delegate("*","mousedown touchend",function(g){var f=J(g.target).closest("div.select2-container").get(0),d;if(f){J(document).find("div.select2-container-active").each(function(){if(this!==f){J(this).data("select2").blur()}})}else{f=J(g.target).closest("div.select2-drop").get(0);J(document).find("div.select2-drop-active").each(function(){if(this!==f){J(this).data("select2").blur()}})}f=J(g.target);d=f.attr("for");if("LABEL"===g.target.tagName&&d&&d.length>0){f=J("#"+d);f=f.data("select2");if(f!==L){f.focus();g.preventDefault()}}})});function X(d,e){var f=function(){};f.prototype=new d;f.prototype.constructor=f;f.prototype.parent=d.prototype;f.prototype=J.extend(f.prototype,e);return f}E=X(Object,{bind:function(e){var d=this;return function(){e.apply(d,arguments)}},init:function(f){var e,d,g=".select2-results";this.opts=f=this.prepareOpts(f);this.id=f.id;if(f.element.data("select2")!==L&&f.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id"+T();this.container.attr("id",this.containerId);this.body=b(function(){return f.element.closest("body")});if(f.element.attr("class")!==L){this.container.addClass(f.element.attr("class"))}this.container.css(S(f.containerCss));this.container.addClass(S(f.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(S(f.dropdownCssClass));this.dropdown.data("select2",this);this.results=e=this.container.find(g);this.search=d=this.container.find("input.select2-input");d.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();U(this.results);this.dropdown.delegate(g,"mousemove-filtered",this.bind(this.highlightUnderEvent));F(80,this.results);this.dropdown.delegate(g,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(J.fn.mousewheel){e.mousewheel(function(m,n,k,j){var l=e.scrollTop(),h;if(j>0&&l-j<=0){e.scrollTop(0);D(m)}else{if(j<0&&e.get(0).scrollHeight-e.scrollTop()+j<=e.height()){e.scrollTop(e.get(0).scrollHeight-e.height());D(m)}}})}a(d);d.bind("keyup-change",this.bind(this.updateResults));d.bind("focus",function(){d.addClass("select2-focused");if(d.val()===" "){d.val("")}});d.bind("blur",function(){d.removeClass("select2-focused")});this.dropdown.delegate(g,"mouseup",this.bind(function(h){if(J(h.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(h);this.selectHighlighted(h)}else{this.focusSearch()}D(h)}));this.dropdown.bind("click mouseup mousedown",function(h){h.stopPropagation()});if(J.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(f.element.is(":disabled")||f.element.is("[readonly='readonly']")){this.disable()}},destroy:function(){var d=this.opts.element.data("select2");if(d!==L){d.container.remove();d.dropdown.remove();d.opts.element.removeData("select2").unbind(".select2").show()}},prepareOpts:function(h){var f,e,d,g;f=h.element;if(f.get(0).tagName.toLowerCase()==="select"){this.select=e=h.element}if(e){J.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in h){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}h=J.extend({},{populateResults:function(j,n,p){var o,m,s,l,k=this.opts.id,q=this;o=function(z,u,y){var AA,w,AF,AC,AE,v,AD,AB,x;for(AA=0,w=z.length;AA<w;AA=AA+1){AF=z[AA];AC=k(AF)!==L;AE=("children" in AF)&&AF.children.length>0;v=J("<li></li>");v.addClass("select2-results-dept-"+y);v.addClass("select2-result");v.addClass(AC?"select2-result-selectable":"select2-result-unselectable");if(AE){v.addClass("select2-result-with-children")}v.addClass(q.opts.formatResultCssClass(AF));AD=J("<div></div>");AD.addClass("select2-result-label");x=h.formatResult(AF,AD,p);if(x!==L){AD.html(V(x))}v.append(AD);if(AE){AB=J("<ul></ul>");AB.addClass("select2-result-sub");o(AF.children,AB,y+1);v.append(AB)}v.data("select2-data",AF);u.append(v)}};o(n,j,0)}},J.fn.select2.defaults,h);if(typeof (h.id)!=="function"){d=h.id;h.id=function(j){return j[d]}}if(e){h.query=this.bind(function(m){var l={results:[],more:false},k=m.term,j,o,n;n=function(p,s){var q;if(p.is("option")){if(m.matcher(k,p.text(),p)){s.push({id:p.attr("value"),text:p.text(),element:p.get(),css:p.attr("class")})}}else{if(p.is("optgroup")){q={text:p.attr("label"),children:[],element:p.get(),css:p.attr("class")};p.children().each2(function(u,v){n(v,q.children)});if(q.children.length>0){s.push(q)}}}};j=f.children();if(this.getPlaceholder()!==L&&j.length>0){o=j[0];if(J(o).text()===""){j=j.not(o)}}j.each2(function(p,q){n(q,l.results)});m.callback(l)});h.id=function(j){return j.id};h.formatResultCssClass=function(j){return j.css}}else{if(!("query" in h)){if("ajax" in h){g=h.element.data("ajax-url");if(g&&g.length>0){h.ajax.url=g}h.query=P(h.ajax)}else{if("data" in h){h.query=R(h.data)}else{if("tags" in h){h.query=O(h.tags);h.createSearchChoice=function(j){return{id:j,text:j}};h.initSelection=function(j,l){var k=[];J(M(j.val(),h.separator)).each(function(){var o=this,n=this,m=h.tags;if(J.isFunction(m)){m=m()}J(m).each(function(){if(Q(this.id,o)){n=this.text;return false}});k.push({id:o,text:n})});l(k)}}}}}}if(typeof (h.query)!=="function"){throw"query function not defined for Select2 "+h.element.attr("id")}return h},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(d){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}))},triggerChange:function(d){d=d||{};d=J.extend({},d,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(d);this.opts.element.data("select2-change-triggered",false);this.opts.element.click()},enable:function(){if(this.enabled){return }this.enabled=true;this.container.removeClass("select2-container-disabled")},disable:function(){if(!this.enabled){return }this.close();this.enabled=false;this.container.addClass("select2-container-disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var h=this.container.offset(),o=this.container.outerHeight(),e=this.container.outerWidth(),g=this.dropdown.outerHeight(),l=J(window).scrollTop()+document.documentElement.clientHeight,d=h.top+o,m=d+g<=l,k=(h.top-g)>=this.body().scrollTop(),f=this.dropdown.hasClass("select2-drop-above"),n,j;if(f){n=true;if(!k&&m){n=false}}else{n=false;if(!m&&k){n=true}}if(n&&this.opts.allowPositionAbove){d=h.top-g;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}j={top:d,left:h.left,width:e};this.dropdown.css(j)},shouldOpen:function(){var d;if(this.opened()){return false}d=jQuery.Event("open");this.opts.element.trigger(d);return !d.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var g=this.containerId,e="#"+g,d="scroll."+g,f="resize."+g;this.container.parents().each(function(){J(this).bind(d,function(){var h=J(e);if(h.length==0){J(this).unbind(d)}h.select2("close")})});window.setTimeout(function(){J(window).bind(f,function(){var h=J(e);if(h.length==0){J(window).unbind(f)}h.select2("close")})},10);this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("")}this.dropdown.css(S(this.opts.dropdownCss));this.dropdown.addClass("select2-drop-active");this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.opts.element.trigger(jQuery.Event("aftershow"));this.ensureHighlightVisible();this.positionDropdown();this.focusSearch()},close:function(){if(!this.opened()){return }var d=this;this.container.parents().each(function(){J(this).unbind("scroll."+d.containerId)});J(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(jQuery.Event("close"))},clearSearch:function(){},ensureHighlightVisible:function(){var g=this.results,f,d,l,k,h,j,e;d=this.highlight();if(d<0){return }if(d==0){g.scrollTop(0);return }f=g.find(".select2-result-selectable");l=J(f[d]);k=l.offset().top+l.outerHeight();if(d===f.length-1){e=g.find("li.select2-more-results");if(e.length>0){k=e.offset().top+e.outerHeight()}}h=g.offset().top+g.outerHeight();if(k>h){g.scrollTop(g.scrollTop()+(k-h))}j=l.offset().top-g.offset().top;if(j<0){g.scrollTop(g.scrollTop()+j)}},moveHighlight:function(g){var f=this.results.find(".select2-result-selectable"),e=this.highlight();while(e>-1&&e<f.length){e+=g;var d=J(f[e]);if(d.hasClass("select2-result-selectable")&&!d.hasClass("select2-disabled")){this.highlight(e);break}}},highlight:function(d){var e=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return B(e.filter(".select2-highlighted")[0],e.get())}if(d>=e.length){d=e.length-1}if(d<0){d=0}e.removeClass("select2-highlighted");J(e[d]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(e){var d=J(e.target).closest(".select2-result-selectable");if(d.length>0&&!d.is(".select2-highlighted")){var f=this.results.find(".select2-result-selectable");this.highlight(f.index(d))}else{if(d.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var h=this.results,g=h.find("li.select2-more-results"),l,k=-1,j=this.resultsPage+1,d=this,f=this.search.val(),e=this.context;if(g.length===0){return }l=g.offset().top-h.offset().top-h.height();if(l<=0){g.addClass("select2-active");this.opts.query({term:f,page:j,context:e,matcher:this.opts.matcher,callback:this.bind(function(m){d.opts.populateResults.call(this,h,m.results,{term:f,page:j,context:e});if(m.more===true){g.detach().appendTo(h).text(d.opts.formatLoadMore(j+1));window.setTimeout(function(){d.loadMoreIfNeeded()},10)}else{g.remove()}d.positionDropdown();d.resultsPage=j})})}},tokenize:function(){},updateResults:function(j){var m=this.search,g=this.results,d=this.opts,f,l=this,k;if(j!==true&&(this.showSearchInput===false||!this.opened())){return }m.addClass("select2-active");function h(){g.scrollTop(0);m.removeClass("select2-active");l.positionDropdown()}function e(n){g.html(V(n));h()}if(d.maximumSelectionSize>=1){f=this.data();if(J.isArray(f)&&f.length>=d.maximumSelectionSize&&K(d.formatSelectionTooBig,"formatSelectionTooBig")){e("<li class='select2-selection-limit'>"+d.formatSelectionTooBig(d.maximumSelectionSize)+"</li>");return }}if(m.val().length<d.minimumInputLength&&K(d.formatInputTooShort,"formatInputTooShort")){e("<li class='select2-no-results'>"+d.formatInputTooShort(m.val(),d.minimumInputLength)+"</li>");return }else{e("<li class='select2-searching'>"+d.formatSearching()+"</li>")}k=this.tokenize();if(k!=L&&k!=null){m.val(k)}this.resultsPage=1;d.query({term:m.val(),page:this.resultsPage,context:null,matcher:d.matcher,callback:this.bind(function(o){var n;this.context=(o.context===L)?null:o.context;if(this.opts.createSearchChoice&&m.val()!==""){n=this.opts.createSearchChoice.call(null,m.val(),o.results);if(n!==L&&n!==null&&l.id(n)!==L&&l.id(n)!==null){if(J(o.results).filter(function(){return Q(l.id(this),l.id(n))}).length===0){o.results.unshift(n)}}}if(o.results.length===0&&K(d.formatNoMatches,"formatNoMatches")){e("<li class='select2-no-results'>"+d.formatNoMatches(m.val())+"</li>");return }g.empty();l.opts.populateResults.call(this,g,o.results,{term:m.val(),page:this.resultsPage,context:null});if(o.more===true&&K(d.formatLoadMore,"formatLoadMore")){g.append("<li class='select2-more-results'>"+V(d.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){l.loadMoreIfNeeded()},10)}this.postprocessResults(o,j);h()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var d=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),f=e.closest(".select2-result-selectable").data("select2-data");if(f){e.addClass("select2-disabled");this.highlight(d);this.onSelect(f)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function e(){var j,g,k,h,f;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){j=this.opts.element.attr("style");if(j!==L){g=j.split(";");for(h=0,f=g.length;h<f;h=h+1){k=g[h].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(k!==null&&k.length>=1){return k[1]}}}if(this.opts.width==="resolve"){j=this.opts.element.css("width");if(j.indexOf("%")>0){return j}return(this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px")}return null}else{if(J.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var d=e.call(this);if(d!==null){this.container.attr("style","width: "+d)}}});W=X(E,{createContainer:function(){var d=J("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return d},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var f,e=this.container,g=this.dropdown,d=false;this.selection=f=e.find(".select2-choice");this.search.bind("keydown",this.bind(function(h){if(!this.enabled){return }if(h.which===C.PAGE_UP||h.which===C.PAGE_DOWN){D(h);return }if(this.opened()){switch(h.which){case C.UP:case C.DOWN:this.moveHighlight((h.which===C.UP)?-1:1);D(h);return ;case C.TAB:case C.ENTER:this.selectHighlighted();D(h);return ;case C.ESC:this.cancel(h);D(h);return }}else{if(h.which===C.TAB||C.isControl(h)||C.isFunctionKey(h)||h.which===C.ESC){return }if(this.opts.openOnEnter===false&&h.which===C.ENTER){return }this.open();if(h.which===C.ENTER){return }}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("mousedown",this.bind(function(h){d=true;if(this.opened()){this.close();this.selection.focus()}else{if(this.enabled){this.open()}}d=false}));g.bind("mousedown",this.bind(function(){this.search.focus()}));f.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));f.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("keydown",this.bind(function(j){if(!this.enabled){return }if(j.which===C.PAGE_UP||j.which===C.PAGE_DOWN){D(j);return }if(j.which===C.TAB||C.isControl(j)||C.isFunctionKey(j)||j.which===C.ESC){return }if(this.opts.openOnEnter===false&&j.which===C.ENTER){return }if(j.which==C.DELETE){if(this.opts.allowClear){this.clear()}return }this.open();if(j.which===C.ENTER){D(j);return }if(j.which<48){D(j);return }var h=String.fromCharCode(j.which).toLowerCase();if(j.shiftKey){h=h.toUpperCase()}this.search.focus();this.search.val(h);D(j)}));f.delegate("abbr","mousedown",this.bind(function(h){if(!this.enabled){return }this.clear();D(h);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){var e;if(this.opts.element.val()===""){this.close();this.setPlaceholder()}else{var d=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==L&&f!==null){d.updateSelection(f);d.close();d.setPlaceholder()}})}},prepareOpts:function(){var d=this.parent.prepareOpts.apply(this,arguments);if(d.element.get(0).tagName.toLowerCase()==="select"){d.initSelection=function(e,g){var f=e.find(":selected");if(J.isFunction(g)){g({id:f.attr("value"),text:f.text()})}}}return d},setPlaceholder:function(){var d=this.getPlaceholder();if(this.opts.element.val()===""&&d!==L){if(this.select&&this.select.find("option:first").text()!==""){return }this.selection.find("span").html(V(d));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(g,e){var f=0,d=this,h=true;this.results.find(".select2-result-selectable").each2(function(j,k){if(Q(d.id(k.data("select2-data")),d.opts.element.val())){f=j;return false}});this.highlight(f);if(e===true){h=this.showSearchInput=H(g.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[h?"removeClass":"addClass"]("select2-search-hidden");J(this.dropdown,this.container)[h?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(e){var d=this.opts.element.val();this.opts.element.val(this.id(e));this.updateSelection(e);this.close();this.selection.focus();if(!Q(d,this.id(e))){this.triggerChange()}},updateSelection:function(f){var d=this.selection.find("span"),e;this.selection.data("select2-data",f);d.empty();e=this.opts.formatSelection(f,d);if(e!==L){d.append(V(e))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==L){this.selection.find("abbr").show()}},val:function(){var f,e=null,d=this;if(arguments.length===0){return this.opts.element.val()}f=arguments[0];if(this.select){this.select.val(f).find(":selected").each2(function(g,h){e={id:h.attr("value"),text:h.text()};return false});this.updateSelection(e);this.setPlaceholder()}else{if(this.opts.initSelection===L){throw new Error("cannot call val() if initSelection() is not defined")}if(!f){this.clear();return }this.opts.initSelection(this.opts.element,function(g){d.opts.element.val(!g?"":d.id(g));d.updateSelection(g);d.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(e){var d;if(arguments.length===0){d=this.selection.data("select2-data");if(d==L){d=null}return d}else{if(!e||e===""){this.clear()}else{this.opts.element.val(!e?"":this.id(e));this.updateSelection(e)}}}});c=X(E,{createContainer:function(){var d=J("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return d},prepareOpts:function(){var d=this.parent.prepareOpts.apply(this,arguments);if(d.element.get(0).tagName.toLowerCase()==="select"){d.initSelection=function(e,g){var f=[];e.find(":selected").each2(function(h,j){f.push({id:j.attr("value"),text:j.text()})});if(J.isFunction(g)){g(f)}}}return d},initContainer:function(){var d=".select2-choices",e;this.searchContainer=this.container.find(".select2-search-field");this.selection=e=this.container.find(d);this.search.bind("keydown",this.bind(function(g){if(!this.enabled){return }if(g.which===C.BACKSPACE&&this.search.val()===""){this.close();var h,f=e.find(".select2-search-choice-focus");if(f.length>0){this.unselect(f.first());this.search.width(10);D(g);return }h=e.find(".select2-search-choice");if(h.length>0){h.last().addClass("select2-search-choice-focus")}}else{e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(g.which){case C.UP:case C.DOWN:this.moveHighlight((g.which===C.UP)?-1:1);D(g);return ;case C.ENTER:case C.TAB:this.selectHighlighted();D(g);return ;case C.ESC:this.cancel(g);D(g);return }}if(g.which===C.TAB||C.isControl(g)||C.isFunctionKey(g)||g.which===C.BACKSPACE||g.which===C.ESC){return }if(this.opts.openOnEnter===false&&g.which===C.ENTER){return }this.open();if(g.which===C.PAGE_UP||g.which===C.PAGE_DOWN){D(g)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(){this.container.removeClass("select2-container-active")}));this.container.delegate(d,"mousedown",this.bind(function(f){if(!this.enabled){return }this.clearPlaceholder();this.open();this.focusSearch();f.preventDefault()}));this.container.delegate(d,"focus",this.bind(function(){if(!this.enabled){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled){return }this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled){return }this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var e;if(this.opts.element.val()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var d=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==L&&f!==null){d.updateSelection(f);d.close();d.clearSearch()}})}},clearSearch:function(){var d=this.getPlaceholder();if(d!==L&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(d).addClass("select2-default");this.resizeSearch()}else{this.search.val(" ").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}else{if(this.search.val()===" "){this.search.val("")}}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(g){var f=[],e=[],d=this;J(g).each(function(){if(B(d.id(this),f)<0){f.push(d.id(this));e.push(this)}});g=e;this.selection.find(".select2-search-choice").remove();J(g).each(function(){d.addSelectedChoice(this)});d.postprocessResults()},tokenize:function(){var d=this.search.val();d=this.opts.tokenizer(d,this.data(),this.bind(this.onSelect),this.opts);if(d!=null&&d!=L){this.search.val(d);if(d.length>0){this.open()}}},onSelect:function(d){this.addSelectedChoice(d);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:d});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(f){var d=J("<li class='select2-search-choice'>    <div></div>    <a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a></li>"),h=this.id(f),g=this.getVal(),e;e=this.opts.formatSelection(f,d);d.find("div").replaceWith("<div>"+V(e)+"</div>");d.find(".select2-search-choice-close").bind("mousedown",D).bind("click dblclick",this.bind(function(j){if(!this.enabled){return }J(j.target).closest(".select2-search-choice").fadeOut("fast").animate({width:"hide"},0,this.bind(function(){this.unselect(J(j.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();D(j)})).bind("focus",this.bind(function(){if(!this.enabled){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}));d.data("select2-data",f);d.insertBefore(this.searchContainer);g.push(h);this.setVal(g)},unselect:function(e){var g=this.getVal(),f,d;e=e.closest(".select2-search-choice");if(e.length===0){throw"Invalid argument: "+e+". Must be .select2-search-choice"}f=e.data("select2-data");d=B(this.id(f),g);if(d>=0){g.splice(d,1);this.setVal(g);if(this.select){this.postprocessResults()}}e.remove();this.triggerChange({removed:f})},postprocessResults:function(){var f=this.getVal(),g=this.results.find(".select2-result-selectable"),e=this.results.find(".select2-result-with-children"),d=this;g.each2(function(j,h){var k=d.id(h.data("select2-data"));if(B(k,f)>=0){h.addClass("select2-disabled").removeClass("select2-result-selectable")}else{h.removeClass("select2-disabled").addClass("select2-result-selectable")}});e.each2(function(h,j){if(j.find(".select2-result-selectable").length==0){j.addClass("select2-disabled")}else{j.removeClass("select2-disabled")}});g.each2(function(j,h){if(!h.hasClass("select2-disabled")&&h.hasClass("select2-result-selectable")){d.highlight(0);return false}})},resizeSearch:function(){var j,g,f,d,e,h=N(this.search);j=Y(this.search)+10;g=this.search.offset().left;f=this.selection.width();d=this.selection.offset().left;e=f-(g-d)-h;if(e<j){e=f-h}if(e<40){e=f-h}this.search.width(e)},getVal:function(){var d;if(this.select){d=this.select.val();return d===null?[]:d}else{d=this.opts.element.val();return M(d,this.opts.separator)}},setVal:function(e){var d;if(this.select){this.select.val(e)}else{d=[];J(e).each(function(){if(B(this,d)<0){d.push(this)}});this.opts.element.val(d.length===0?"":d.join(this.opts.separator))}},val:function(){var f,e=[],d=this;if(arguments.length===0){return this.getVal()}f=arguments[0];if(!f){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return }this.setVal(f);if(this.select){this.select.find(":selected").each(function(){e.push({id:J(this).attr("value"),text:J(this).text()})});this.updateSelection(e)}else{if(this.opts.initSelection===L){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(h){var g=J(h).map(d.id);d.setVal(g);d.updateSelection(h);d.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var e=[],d=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){e.push(d.opts.id(J(this).data("select2-data")))});this.setVal(e);this.triggerChange()},data:function(e){var d=this,f;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return J(this).data("select2-data")}).get()}else{if(!e){e=[]}f=J.map(e,function(g){return d.opts.id(g)});this.setVal(f);this.updateSelection(e);this.clearSearch()}}});J.fn.select2=function(){var g=Array.prototype.slice.call(arguments,0),h,f,j,e,d=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(g.length===0||typeof (g[0])==="object"){h=g.length===0?{}:J.extend({},g[0]);h.element=J(this);if(h.element.get(0).tagName.toLowerCase()==="select"){e=h.element.attr("multiple")}else{e=h.multiple||false;if("tags" in h){h.multiple=e=true}}f=e?new c():new W();f.init(h)}else{if(typeof (g[0])==="string"){if(B(g[0],d)<0){throw"Unknown method: "+g[0]}j=L;f=J(this).data("select2");if(f===L){return }if(g[0]==="container"){j=f.container}else{j=f[g[0]].apply(f,g.slice(1))}if(j!==L){return false}}else{throw"Invalid arguments to select2 plugin: "+g}}});return(j===L)?this:j};J.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",allowPositionAbove:false,formatResult:function(d,e,g){var f=[];I(d.text,g.term,f);return f.join("")},formatSelection:function(e,d){return e.text},formatResultCssClass:function(d){return L},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(d,e){return"Please enter "+(e-d.length)+" more characters"},formatSelectionTooBig:function(d){return"You can only select "+d+" items"},formatLoadMore:function(d){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(d){return d.id},matcher:function(d,e){return e.toUpperCase().indexOf(d.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:Z};window.Select2={query:{ajax:P,local:R,tags:O},util:{debounce:G,markMatch:I},"class":{"abstract":E,single:W,multi:c}}}(jQuery));(function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(type,name){this.defaults.type=type;this.defaults.name=name},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);if(!settings.single.length){settings.single="metadata"}var data=$.data(elem,settings.single);if(data&&settings.cache){return data}data="{}";var getData=function(data){if(typeof data!="string"){return data}if(data.indexOf("{")<0){data=eval("("+data+")")}};var getObject=function(data){if(typeof data!="string"){return data}data=eval("("+data+")");return data};if(settings.type=="html5"){var object={};$(elem.attributes).each(function(){var name=this.nodeName;if(name.match(/^data-/)){name=name.replace(/^data-/,"")}else{return true}object[name]=getObject(this.nodeValue)})}else{if(settings.type=="class"){var m=settings.cre.exec(elem.className);if(m){data=m[1]}}else{if(settings.type=="elem"){if(!elem.getElementsByTagName){return }var e=elem.getElementsByTagName(settings.name);if(e.length){data=$.trim(e[0].innerHTML)}}else{if(elem.getAttribute!=undefined){var attr=elem.getAttribute(settings.name);if(attr){data=attr}}}}object=getObject(data.indexOf("{")<0?"{"+data+"}":data)}$.data(elem,settings.single,object);return object}}});$.fn.metadata=function(opts){return $.metadata.get(this[0],opts)}})(jQuery);
/*
Copyright (c) 2010 Ryan Schuft (ryan.schuft@gmail.com)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
if(window&&!window.InflectionJS){window.InflectionJS=null}InflectionJS={uncountable_words:["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],plural_rules:[[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],singular_rules:[[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("s$","gi"),""]],non_titlecased_words:["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],uppercased_words:["url","pdf","html","xhtml","css","js"],id_suffix:new RegExp("(_ids|_id)$","g"),underbar:new RegExp("_","g"),space_or_underbar:new RegExp("[ _]","g"),uppercase:new RegExp("([A-Z])","g"),underbar_prefix:new RegExp("^_"),apply_rules:function(E,D,C,B){if(B){E=B}else{var F=(C.indexOf(E.toLowerCase())>-1);if(!F){for(var A=0;A<D.length;A++){if(E.match(D[A][0])){E=E.replace(D[A][0],D[A][1]);break}}}}return E}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(D,C,E){if(!C){C=-1}var A=-1;for(var B=C;B<this.length;B++){if(this[B]===D||E&&E(this[B],D)){A=B;break}}return A}}if(!String.prototype._uncountable_words){String.prototype._uncountable_words=InflectionJS.uncountable_words}if(!String.prototype._plural_rules){String.prototype._plural_rules=InflectionJS.plural_rules}if(!String.prototype._singular_rules){String.prototype._singular_rules=InflectionJS.singular_rules}if(!String.prototype._non_titlecased_words){String.prototype._non_titlecased_words=InflectionJS.non_titlecased_words}if(!String.prototype._uppercased_words){String.prototype._uppercased_words=InflectionJS.uppercased_words}if(!String.prototype.pluralize){String.prototype.pluralize=function(A){return InflectionJS.apply_rules(this,this._plural_rules,this._uncountable_words,A)}}if(!String.prototype.singularize){String.prototype.singularize=function(A){return InflectionJS.apply_rules(this,this._singular_rules,this._uncountable_words,A)}}if(!String.prototype.camelize){String.prototype.camelize=function(G){var F=this.toLowerCase();var C=F.split("/");for(var D=0;D<C.length;D++){var E=C[D].split("_");var B=((G&&D+1===C.length)?(1):(0));for(var A=B;A<E.length;A++){E[A]=E[A].charAt(0).toUpperCase()+E[A].substring(1)}C[D]=E.join("")}F=C.join("::");return F}}if(!String.prototype.underscore){String.prototype.underscore=function(){var C=this;var A=C.split("::");for(var B=0;B<A.length;B++){A[B]=A[B].replace(InflectionJS.uppercase,"_$1");A[B]=A[B].replace(InflectionJS.underbar_prefix,"")}C=A.join("/").toLowerCase();return C}}if(!String.prototype.humanize){String.prototype.humanize=function(B){var A=this.toLowerCase();A=A.replace(InflectionJS.id_suffix,"");A=A.replace(InflectionJS.underbar," ");if(!B){A=A.capitalize()}return A}}if(!String.prototype.capitalize){String.prototype.capitalize=function(){var A=this.toLowerCase();A=A.substring(0,1).toUpperCase()+A.substring(1);return A}}if(!String.prototype.dasherize){String.prototype.dasherize=function(){var A=this;A=A.replace(InflectionJS.space_or_underbar,"-");return A}}if(!String.prototype.titleize){String.prototype.titleize=function(){var E=this.toLowerCase();E=E.replace(InflectionJS.underbar," ");var C=E.split(" ");for(var A=0;A<C.length;A++){var D=C[A].split("-");for(var B=0;B<D.length;B++){if(this._non_titlecased_words.indexOf(D[B].toLowerCase())<0){D[B]=D[B].capitalize()}if(this._uppercased_words.indexOf(D[B].toLowerCase())!=-1){D[B]=D[B].toUpperCase()}}C[A]=D.join("-")}E=C.join(" ");E=E.substring(0,1).toUpperCase()+E.substring(1);return E}}if(!String.prototype.demodulize){String.prototype.demodulize=function(){var B=this;var A=B.split("::");B=A[A.length-1];return B}}if(!String.prototype.tableize){String.prototype.tableize=function(){var A=this;A=A.underscore().pluralize();return A}}if(!String.prototype.classify){String.prototype.classify=function(){var A=this;A=A.camelize().singularize();return A}}if(!String.prototype.foreign_key){String.prototype.foreign_key=function(A){var B=this;B=B.demodulize().underscore()+((A)?(""):("_"))+"id";return B}}if(!String.prototype.ordinalize){String.prototype.ordinalize=function(){var G=this;var E=G.split(" ");for(var A=0;A<E.length;A++){var C=parseInt(E[A]);if(C===NaN){var F=E[A].substring(E[A].length-2);var D=E[A].substring(E[A].length-1);var B="th";if(F!="11"&&F!="12"&&F!="13"){if(D==="1"){B="st"}else{if(D==="2"){B="nd"}else{if(D==="3"){B="rd"}}}}E[A]+=B}}G=E.join(" ");return G};
/* Iris - v0.9.10 - 2012-11-07
* https://github.com/Automattic/Iris
* Copyright (c) 2012 Matt Wiebe; Licensed GPL */
}(function(G,E){var D='<div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="#"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div>';var N=!!(G.browser.msie&&parseInt(G.browser.version,10)<10);var B=false;var A=["-moz-","-webkit-","-o-","-ms-"];var L='.iris-picker{display:block;position:relative}.iris-error{background-color:#ffafaf}.iris-border{border-radius:3px;border:1px solid #aaa;width:200px;background-color:#fff}.iris-picker-inner{position:absolute;top:0;right:0;left:0;bottom:0}.iris-border .iris-picker-inner{top:10px;right:10px;left:10px;bottom:10px}.iris-picker .iris-square-inner{position:absolute;left:0;right:0;top:0;bottom:0}.iris-picker .iris-square,.iris-picker .iris-slider,.iris-picker .iris-square-inner,.iris-picker .iris-palette{border-radius:3px;-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.4);-moz-box-shadow:inset 0 0 5px rgba(0,0,0,0.4);box-shadow:inset 0 0 5px rgba(0,0,0,0.4);height:100%;width:12.5%;float:left;margin-right:5%}.iris-picker .iris-square{width:76%;margin-right:10%;position:relative}.iris-picker .iris-square-inner{width:auto;margin:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-square-inner,.iris-ie-9 .iris-palette{box-shadow:none;border-radius:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-palette{outline:1px solid rgba(0,0,0,.1)}.iris-ie-lt9 .iris-square,.iris-ie-lt9 .iris-slider,.iris-ie-lt9 .iris-square-inner,.iris-ie-lt9 .iris-palette{outline:1px solid #aaa}.iris-ie-lt9 .iris-square .ui-slider-handle{outline:1px solid #aaa;background-color:#fff;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=30)"}.iris-ie-lt9 .iris-square .iris-square-handle{background:none;border:3px solid #fff;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)"}.iris-picker .iris-strip{margin-right:0;position:relative}.iris-picker .iris-strip .ui-slider-handle{position:absolute;background:none;right:-3px;left:-3px;border:4px solid #aaa;border-width:4px 3px;width:auto;height:6px;border-radius:4px;box-shadow:0 1px 2px rgba(0,0,0,.2);opacity:.9;z-index:5}.iris-strip .ui-slider-handle:before{content:" ";position:absolute;left:-2px;right:-2px;top:-3px;bottom:-3px;border:2px solid #fff;-webkit-border-radius:3px;border-radius:3px}.iris-picker .iris-slider-offset{position:absolute;top:11px;left:0;right:0;bottom:-3px}.iris-picker .iris-square-handle{background:transparent;border:5px solid #aaa;-webkit-border-radius:6px;-moz-border-radius:50%;border-radius:50%;border-color:rgba(128,128,128,.5);box-shadow:none;width:12px;height:12px;position:absolute;left:-10px;top:-10px;cursor:move;opacity:1;z-index:10}.iris-picker .ui-state-focus .iris-square-handle{opacity:.8}.iris-picker .iris-square-handle:hover{border-color:#999}.iris-picker .iris-square-handle:hover::after{border-color:#fff}.iris-picker .iris-square-handle::after{position:absolute;bottom:-4px;right:-4px;left:-4px;top:-4px;border:3px solid #f9f9f9;border-color:rgba(255,255,255,.8);border-radius:50%;content:" "}.iris-picker .iris-square-value{width:8px;height:8px;position:absolute}.iris-ie-lt9 .iris-square-value,.iris-mozilla .iris-square-value{width:1px;height:1px}.iris-palette-container{position:absolute;bottom:0;left:0;margin:0;padding:0}.iris-border .iris-palette-container{left:10px;bottom:10px}.iris-picker .iris-palette{margin:0;list-style-type:none;cursor:pointer}';if(N&&parseInt(G.browser.version,10)<=7){return G.fn.iris=G.noop}function M(){if(N){B="filter"}else{var O=G('<div id="iris-gradtest" />');var P="linear-gradient(top,#fff,#000)";G.each(A,function(Q,R){O.css("backgroundImage",R+P);if(O.css("backgroundImage").match("gradient")){B=Q;return false}});if(G.browser.webkit&&B===false){O.css("background","-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))");if(O.css("backgroundImage").match("gradient")){B="webkit"}}O.remove()}}function K(O,P){O=(O==="top")?"top":"left";P=G.isArray(P)?P:Array.prototype.slice.call(arguments,1);if(B==="webkit"){return J(O,P)}else{return A[B]+"linear-gradient("+O+", "+P.join(", ")+")"}}function F(T,W){T=(T==="top")?"top":"left";W=G.isArray(W)?W:Array.prototype.slice.call(arguments,1);var S=(T==="top")?0:1;var Y=G(this);var Q=W.length-1;var O=(parseInt(G.browser.version,10)>=8)?"-ms-filter":"filter";O="filter";var R=(S===1)?"left":"top";var X=(S===1)?"right":"bottom";var V=(S===1)?"height":"width";var U='<div class="iris-ie-gradient-shim" style="position:absolute;'+V+":100%;"+R+":%start%;"+X+":%end%;"+O+':%filter%;" data-color:"%color%"></div>';var P="";if(Y.css("position")==="static"){Y.css({position:"relative"})}W=H(W);G.each(W,function(Z,b){if(Z===Q){return false}var a=W[Z+1];if(b.stop===a.stop){return }var c=100-parseFloat(a.stop)+"%";b.octoHex=new Color(b.color).toIEOctoHex();a.octoHex=new Color(a.color).toIEOctoHex();var d="progid:DXImageTransform.Microsoft.Gradient(GradientType="+S+", StartColorStr='"+b.octoHex+"', EndColorStr='"+a.octoHex+"')";P+=U.replace("%start%",b.stop).replace("%end%",c).replace("%filter%",d)});Y.find(".iris-ie-gradient-shim").remove();G(P).prependTo(Y)}function J(O,P){var Q=[];O=(O==="top")?"0% 0%,0% 100%,":"0% 100%,100% 100%,";P=H(P);G.each(P,function(R,S){Q.push("color-stop("+(parseFloat(S.stop)/100)+", "+S.color+")")});return"-webkit-gradient(linear,"+O+Q.join(",")+")"}function H(Q){var P=[];var R=[];var O=[];var S=Q.length-1;G.each(Q,function(V,X){var T=X;var W=false;var U=X.match(/1?[0-9]{1,2}%$/);if(U){T=X.replace(/\s?1?[0-9]{1,2}%$/,"");W=U.shift()}P.push(T);R.push(W)});if(R[0]===false){R[0]="0%"}if(R[S]===false){R[S]="100%"}R=I(R);G.each(R,function(T){O[T]={color:P[T],stop:R[T]}});return O}function I(W){var R=0,V=W.length-1,Q=0,T=false;var O,U,P,S;if(W.length<=2||G.inArray(false,W)<0){return W}while(Q<W.length-1){if(!T&&W[Q]===false){R=Q-1;T=true}else{if(T&&W[Q]!==false){V=Q;Q=W.length}}Q++}U=V-R;S=parseInt(W[R].replace("%"),10);O=(parseFloat(W[V].replace("%"))-S)/U;Q=R+1;P=1;while(Q<V){W[Q]=(S+(P*O))+"%";P++;Q++}return I(W)}G.fn.gradient=function(O){var P=arguments;return this.each(function(){if(N){F.apply(this,P)}else{G(this).css("backgroundImage",K.apply(this,P))}})};G.fn.raninbowGradient=function(P,Q){P=P||"top";var T=G.extend({},{s:100,l:50},Q);var S="hsl(%h%,"+T.s+"%,"+T.l+"%)";var R=0;var O=[];while(R<=360){O.push(S.replace("%h%",R));R+=30}return this.each(function(){G(this).gradient(P,O)})};var C={options:{color:false,mode:"hsl",controls:{horiz:"s",vert:"l",strip:"h"},hide:true,border:true,target:false,width:200,palettes:false},_palettes:["#000","#fff","#d33","#d93","#ee2","#81d742","#1e73be","#8224e3"],_inited:false,_scale:{h:360,s:100,l:100,v:100},_create:function(){var Q=this,S=Q.element,P=Q.options.color||S.val(),O;if(B===false){M()}if(S.is("input")){if(Q.options.target){Q.picker=G(D).appendTo(Q.options.target)}else{Q.picker=G(D).insertAfter(S)}Q._addInputListeners(S)}else{S.append(D);Q.picker=S.find(".iris-picker")}if(G.browser.mozilla){Q.picker.addClass("iris-mozilla")}else{if(G.browser.msie){var R=parseInt(G.browser.version,10);if(R===9){Q.picker.addClass("iris-ie-9")}else{if(R<=8){Q.picker.addClass("iris-ie-lt9")}}}}if(Q.options.palettes){Q._addPalettes()}Q.color=new Color(P).setHSpace(Q.options.mode);Q.options.color=Q.color.toString();Q.controls={square:Q.picker.find(".iris-square"),squareDrag:Q.picker.find(".iris-square-value"),horiz:Q.picker.find(".iris-square-horiz"),vert:Q.picker.find(".iris-square-vert"),strip:Q.picker.find(".iris-strip"),stripSlider:Q.picker.find(".iris-strip .iris-slider-offset")};if(Q.options.mode==="hsv"&&Q.options.controls.vert==="l"){Q.options.controls={horiz:"h",vert:"v",strip:"s"}}Q.hue=Q.color.h();if(Q.options.hide){Q.picker.hide()}if(Q.options.border){Q.picker.addClass("iris-border")}Q._initControls();Q.active="external";Q._dimensions();Q._change()},_addPalettes:function(){var Q=G("<ul class='iris-palette-container' />"),P=G("<li class='iris-palette' />"),O=G.isArray(this.options.palettes)?this.options.palettes:this._palettes;G.each(O,function(R,S){P.clone().data("color",S).css("backgroundColor",S).appendTo(Q).height(10).width(10)});this.picker.append(Q)},_paint:function(){var O=this;O._paintDimension("top","strip");O._paintDimension("top","vert");O._paintDimension("left","horiz")},_paintDimension:function(U,P){var W=this,T=W.color,R=W.options.mode,O=W._getHSpaceColor(),S=W.controls[P],Q=W.options.controls,V;if(P===W.active||(W.active==="square"&&P!=="strip")){return }switch(Q[P]){case"h":if(R==="hsv"){O=T.clone();switch(P){case"horiz":O[Q.vert](100);break;case"vert":O[Q.horiz](100);break;case"strip":O.setHSpace("hsl");break}V=O.toHsl()}else{if(P==="strip"){V={s:O.s,l:O.l}}else{V={s:100,l:O.l}}}S.raninbowGradient(U,V);break;case"s":if(R==="hsv"){if(P==="vert"){V=[T.clone().a(0).s(0).toCSS("rgba"),T.clone().a(1).s(0).toCSS("rgba")]}else{if(P==="strip"){V=[T.clone().s(100).toCSS("hsl"),T.clone().s(0).toCSS("hsl")]}else{if(P==="horiz"){V=["#fff","hsl("+O.h+",100%,50%)"]}}}}else{if(P==="vert"&&W.options.controls.horiz==="h"){V=["hsla(0, 0%, "+O.l+"%, 0)","hsla(0, 0%, "+O.l+"%, 1)"]}else{V=["hsl("+O.h+",0%,50%)","hsl("+O.h+",100%,50%)"]}}S.gradient(U,V);break;case"l":if(P==="strip"){V=["hsl("+O.h+",100%,100%)","hsl("+O.h+", "+O.s+"%,50%)","hsl("+O.h+",100%,0%)"]}else{V=["#fff","rgba(255,255,255,0) 50%","rgba(0,0,0,0) 50%","rgba(0,0,0,1)"]}S.gradient(U,V);break;case"v":if(P==="strip"){V=[T.clone().v(100).toCSS(),T.clone().v(0).toCSS()]}else{V=["rgba(0,0,0,0)","#000"]}S.gradient(U,V);break;default:break}},_getHSpaceColor:function(){return(this.options.mode==="hsv")?this.color.toHsv():this.color.toHsl()},_dimensions:function(X){var c=this,P=c.options,d=c.picker.find(".iris-picker-inner"),Z=c.controls,b=Z.square,Q=c.picker.find(".iris-strip"),U="77.5%",S="12%",R=20,Y=P.border?P.width-R:P.width,W,T=G.isArray(P.palettes)?P.palettes.length:c._palettes.length,V,a,O;if(X){b.css("width","");Q.css("width","");c.picker.removeAttr("style")}U=Y*(parseFloat(U)/100);S=Y*(parseFloat(S)/100);W=P.border?U+R:U;b.width(U).height(U);Q.height(U).width(S);c.picker.css({width:P.width,height:W});if(!P.palettes){return }V=U*2/100;O=U-((T-1)*V);a=O/T;c.picker.find(".iris-palette").each(function(e,g){var f=e===0?0:V;G(this).css({width:a,height:a,marginLeft:f})});c.picker.css("paddingBottom",a+V);Q.height(a+V+U)},_addInputListeners:function(P){var O=this;P.on("change",function(R){var Q=new Color(P.val());var S=P.val().replace(/^#/,"");P.removeClass("iris-error");if(Q.error){if(S!==""){P.addClass("iris-error")}}else{O._setOption("color",Q.toString())}})},_initControls:function(){var Q=this,P=Q.controls,R=P.square,O=Q.options.controls,S=Q._scale[O.strip];P.stripSlider.slider({orientation:"vertical",max:S,slide:function(T,U){Q.active="strip";if(O.strip==="h"){U.value=S-U.value}Q.color[O.strip](U.value);Q._change.apply(Q,arguments)}});P.squareDrag.draggable({containment:"parent",zIndex:1000,cursor:"move",drag:function(T,U){Q._squareDrag(T,U)},start:function(){R.addClass("iris-dragging");G(this).addClass("ui-state-focus")},stop:function(){R.removeClass("iris-dragging");G(this).removeClass("ui-state-focus")}}).on("mousedown mouseup",function(U){U.preventDefault();var T="ui-state-focus";if(U.type==="mousedown"){Q.picker.find("."+T).removeClass(T).blur();G(this).addClass(T)}else{G(this).removeClass("ui-state-focus")}});R.mousedown(function(T){if(T.which!==1){return }if(!G(T.target).is("div")){return }var U=Q.controls.square.offset();var V={top:T.pageY-U.top,left:T.pageX-U.left};T.preventDefault();Q._squareDrag(T,{position:V});T.target=Q.controls.squareDrag.get(0);Q.controls.squareDrag.css(V).trigger(T)});if(Q.options.palettes){Q.picker.find(".iris-palette-container").on("click",".iris-palette",function(T){Q.color.fromCSS(G(this).data("color"));Q.active="external";Q._change()})}},_squareDrag:function(T,U){var Q=this,O=Q.options.controls,S=Q._squareDimensions(),R=Math.round((S.h-U.position.top)/S.h*Q._scale[O.vert]),P=Q._scale[O.horiz]-Math.round((S.w-U.position.left)/S.w*Q._scale[O.horiz]);Q.color[O.horiz](P)[O.vert](R);Q.active="square";Q._change.apply(Q,arguments)},_setOption:function(R,S){var Q=this.options[R];if(R==="color"){S=""+S;var O=S.replace(/^#/,"");var P=new Color(S).setHSpace(this.options.mode);if(!(P.error)){this.color=P;this.options.color=this.options[R]=this.color.toString();this.active="external";this._change()}}},_squareDimensions:function(R){var P=this.controls.square;var O,Q;if(R!==E&&P.data("dimensions")){return P.data("dimensions")}Q=this.controls.squareDrag;O={w:P.width(),h:P.height()};P.data("dimensions",O);return O},_isNonHueControl:function(P,O){if(P==="square"&&this.options.controls.strip==="h"){return true}else{if(O==="external"||(O==="h"&&P==="strip")){return false}}return true},_change:function(O,V){var X=this,W=X.controls,R=X._getHSpaceColor(),Q=X.color.toString(),S=["square","strip"],T=X.options.controls,U=T[X.active]||"external",P=X.hue;if(X.active==="strip"){S=[]}else{if(X.active!=="external"){S.pop()}}G.each(S,function(Y,a){var b;if(a!==X.active){switch(a){case"strip":b=(T.strip==="h")?X._scale[T.strip]-R[T.strip]:R[T.strip];W.stripSlider.slider("value",b);break;case"square":var Z=X._squareDimensions(),c={left:R[T.horiz]/X._scale[T.horiz]*Z.w,top:Z.h-(R[T.vert]/X._scale[T.vert]*Z.h)};X.controls.squareDrag.css(c);break}}});if(R.h!==P&&X._isNonHueControl(X.active,U)){X.color.h(P)}X.hue=X.color.h();X.options.color=X.color.toString();if(X._inited){X._trigger("change",{type:X.active},{color:X.color})}if(X.element.is(":input")&&!X.color.error){X.element.val(X.color.toString()).removeClass("iris-error")}X._paint();X._inited=true;X.active=false},show:function(){this.picker.show()},hide:function(){this.picker.hide()},toggle:function(){this.picker.toggle()}};G.widget("a8c.iris",C);G('<style id="iris-css">'+L+"</style>").appendTo("head")}(jQuery));
/* Color.js - v0.9.8 - 2012-10-04
* https://github.com/Automattic/Color.js
* Copyright (c) 2012 Matt Wiebe; Licensed GPL v2 */
(function(B,D){var E=function(F,G){if(!(this instanceof E)){return new E(F,G)}return this._init(F,G)};E.fn=E.prototype={_color:0,_alpha:1,error:false,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:"hsl",_init:function(F){var G="noop";switch(typeof F){case"object":if(F.a!==D){this.a(F.a)}G=(F.r!==D)?"fromRgb":(F.l!==D)?"fromHsl":(F.v!==D)?"fromHsv":G;return this[G](F);case"string":return this.fromCSS(F);case"number":return this.fromInt(parseInt(F,10))}return this},clone:function(){var F=new E(this.toInt()),H=["_alpha","_hSpace","_hsl","_hsv","error"];for(var G=H.length-1;G>=0;G--){F[H[G]]=this[H[G]]}return F},setHSpace:function(F){this._hSpace=(F==="hsv")?"hsv":"hsl";return this},noop:function(){return this},fromCSS:function(F){var H,G;this.error=false;if(F.match(/^(rgb|hsl)a?/)){G=F.replace(/(\s|%)/g,"").replace(/^(rgb|hsl)a?\(/,"").replace(/\);?$/,"").split(",");if(G.length===4){this.a(parseFloat(G.pop()))}if(F.match(/^rgb/)){return this.fromRgb({r:parseInt(G[0],10),g:parseInt(G[1],10),b:parseInt(G[2],10)})}else{return this.fromHsl({h:parseInt(G[0],10),s:parseInt(G[1],10),l:parseInt(G[2],10)})}}else{return this.fromHex(F)}},fromRgb:function(F,G){if(typeof F!=="object"||F.r===D||F.g===D||F.b===D){this.error=true;return this}this.error=false;return this.fromInt(parseInt((F.r<<16)+(F.g<<8)+F.b,10),G)},fromHex:function(F){F=F.replace(/^#/,"").replace(/^0x/,"");if(F.length===3){F=F[0]+F[0]+F[1]+F[1]+F[2]+F[2]}this.error=!/^[0-9A-F]{6}$/i.test(F);return this.fromInt(parseInt(F,16))},fromHsl:function(M){var F,K,L,G,H,J,N,I;if(typeof M!=="object"||M.h===D||M.s===D||M.l===D){this.error=true;return this}this._hsl=M;this._hSpace="hsl";J=M.h/360;N=M.s/100;I=M.l/100;if(N===0){F=K=L=I}else{G=I<0.5?I*(1+N):I+N-I*N;H=2*I-G;F=this.hue2rgb(H,G,J+1/3);K=this.hue2rgb(H,G,J);L=this.hue2rgb(H,G,J-1/3)}return this.fromRgb({r:F*255,g:K*255,b:L*255},true)},fromHsv:function(K){var J,Q,O,F,L,N,I,M,H,G,P;if(typeof K!=="object"||K.h===D||K.s===D||K.v===D){this.error=true;return this}this._hsv=K;this._hSpace="hsv";J=K.h/360;Q=K.s/100;O=K.v/100;I=Math.floor(J*6);M=J*6-I;H=O*(1-Q);G=O*(1-M*Q);P=O*(1-(1-M)*Q);switch(I%6){case 0:F=O;L=P;N=H;break;case 1:F=G;L=O;N=H;break;case 2:F=H;L=O;N=P;break;case 3:F=H;L=G;N=O;break;case 4:F=P;L=H;N=O;break;case 5:F=O;L=H;N=G;break}return this.fromRgb({r:F*255,g:L*255,b:N*255},true)},fromInt:function(F,G){this._color=parseInt(F,10);if(isNaN(this._color)){this._color=0}if(this._color>16777215){this._color=16777215}else{if(this._color<0){this._color=0}}if(G===D){this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0}return this},hue2rgb:function(H,G,F){if(F<0){F+=1}if(F>1){F-=1}if(F<1/6){return H+(G-H)*6*F}if(F<1/2){return G}if(F<2/3){return H+(G-H)*(2/3-F)*6}return H},toString:function(){var G=parseInt(this._color,10).toString(16);if(this.error){return""}if(G.length<6){for(var F=6-G.length-1;F>=0;F--){G="0"+G}}return"#"+G},toCSS:function(H,I){H=H||"hex";I=parseFloat(I||this._alpha);switch(H){case"rgb":case"rgba":var G=this.toRgb();if(I<1){return"rgba( "+G.r+", "+G.g+", "+G.b+", "+I+" )"}else{return"rgb( "+G.r+", "+G.g+", "+G.b+" )"}break;case"hsl":case"hsla":var F=this.toHsl();if(I<1){return"hsla( "+F.h+", "+F.s+"%, "+F.l+"%, "+I+" )"}else{return"hsl( "+F.h+", "+F.s+"%, "+F.l+"% )"}break;default:return this.toString()}},toRgb:function(){return{r:255&(this._color>>16),g:255&(this._color>>8),b:255&(this._color)}},toHsl:function(){var L=this.toRgb();var F=L.r/255,J=L.g/255,M=L.b/255;var N=Math.max(F,J,M),H=Math.min(F,J,M);var I,O,G=(N+H)/2;if(N===H){I=O=0}else{var K=N-H;O=G>0.5?K/(2-N-H):K/(N+H);switch(N){case F:I=(J-M)/K+(J<M?6:0);break;case J:I=(M-F)/K+2;break;case M:I=(F-J)/K+4;break}I/=6}I=Math.round(I*360);if(I===0&&this._hsl.h!==I){I=this._hsl.h}O=Math.round(O*100);if(O===0&&this._hsl.s){O=this._hsl.s}return{h:I,s:O,l:Math.round(G*100)}},toHsv:function(){var K=this.toRgb();var F=K.r/255,I=K.g/255,L=K.b/255;var M=Math.max(F,I,L),G=Math.min(F,I,L);var H,O,N=M;var J=M-G;O=M===0?0:J/M;if(M===G){H=O=0}else{switch(M){case F:H=(I-L)/J+(I<L?6:0);break;case I:H=(L-F)/J+2;break;case L:H=(F-I)/J+4;break}H/=6}H=Math.round(H*360);if(H===0&&this._hsv.h!==H){H=this._hsv.h}O=Math.round(O*100);if(O===0&&this._hsv.s){O=this._hsv.s}return{h:H,s:O,v:Math.round(N*100)}},toInt:function(){return this._color},toIEOctoHex:function(){var F=this.toString();var G=parseInt(255*this._alpha,10).toString(16);if(G.length===1){G="0"+G}return"#"+G+F.replace(/^#/,"")},toLuminosity:function(){var F=this.toRgb();return 0.2126*Math.pow(F.r/255,2.2)+0.7152*Math.pow(F.g/255,2.2)+0.0722*Math.pow(F.b/255,2.2)},getDistanceLuminosityFrom:function(G){if(!(G instanceof E)){throw"getDistanceLuminosityFrom requires a Color object"}var H=this.toLuminosity();var F=G.toLuminosity();if(H>F){return(H+0.05)/(F+0.05)}else{return(F+0.05)/(H+0.05)}},getMaxContrastColor:function(){var F=this.toLuminosity();var G=(F>=0.5)?"000000":"ffffff";return new E(G)},getGrayscaleContrastingColor:function(G){if(!G){return this.getMaxContrastColor()}var I=(G<5)?5:G;var F=this.getMaxContrastColor();G=F.getDistanceLuminosityFrom(this);if(G<=I){return F}var H=(0===F.toInt())?1:-1;while(G>I){F=F.incrementLightness(H);G=F.getDistanceLuminosityFrom(this)}return F},getReadableContrastingColor:function(K,J){if(!K instanceof E){return this}var F=(J===D)?5:J;var I=K.getDistanceLuminosityFrom(this);var H=K.getMaxContrastColor();var G=H.getDistanceLuminosityFrom(K);if(G<=F){return H}else{if(I>=F){return this}}var L=(0===H.toInt())?-1:1;while(I<F){this.incrementLightness(L);I=this.getDistanceLuminosityFrom(K);if(this._color===0||this._color===16777215){break}}return this},a:function(F){if(F===D){return this._alpha}this._alpha=parseFloat(F);return this},darken:function(F){F=F||5;return this.l(-F,true)},lighten:function(F){F=F||5;return this.l(F,true)},saturate:function(F){F=F||15;return this.s(F,true)},desaturate:function(F){F=F||15;return this.s(-F,true)},toGrayscale:function(){return this.setHSpace("hsl").s(0)},getComplement:function(){return this.h(180,true)},getSplitComplement:function(F){F=F||1;var G=180+(F*30);return this.h(G,true)},getAnalog:function(F){F=F||1;var G=F*30;return this.h(G,true)},getTetrad:function(F){F=F||1;var G=F*60;return this.h(G,true)},getTriad:function(F){F=F||1;var G=F*120;return this.h(G,true)},_partial:function(F){var G=A[F];return function(I,J){var H=this._spaceFunc("to",G.space);if(I===D){return H[F]}if(J===true){I=H[F]+I}if(G.mod){I=I%G.mod}if(G.range){I=(I<G.range[0])?G.range[0]:(I>G.range[1])?G.range[1]:I}H[F]=I;return this._spaceFunc("from",G.space,H)}},_spaceFunc:function(F,G,J){var H=G||this._hSpace,I=F+H.charAt(0).toUpperCase()+H.substr(1);return this[I](J)}};var A={h:{mod:360},s:{range:[0,100]},l:{space:"hsl",range:[0,100]},v:{space:"hsv",range:[0,100]},r:{space:"rgb",range:[0,255]},g:{space:"rgb",range:[0,255]},b:{space:"rgb",range:[0,255]}};for(var C in A){if(A.hasOwnProperty(C)){E.fn[C]=E.fn._partial(C)}}B.Color=E}(typeof exports==="object"&&exports||this));Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}};Date.getMonthNumberFromName=function(B){var E=Date.CultureInfo.monthNames,A=Date.CultureInfo.abbreviatedMonthNames,D=B.toLowerCase();for(var C=0;C<E.length;C++){if(E[C].toLowerCase()==D||A[C].toLowerCase()==D){return C}}return -1};Date.getDayNumberFromName=function(B){var F=Date.CultureInfo.dayNames,A=Date.CultureInfo.abbreviatedDayNames,E=Date.CultureInfo.shortestDayNames,D=B.toLowerCase();for(var C=0;C<F.length;C++){if(F[C].toLowerCase()==D||A[C].toLowerCase()==D){return C}}return -1};Date.isLeapYear=function(A){return(((A%4===0)&&(A%100!==0))||(A%400===0))};Date.getDaysInMonth=function(A,B){return[31,(Date.isLeapYear(A)?29:28),31,30,31,30,31,31,30,31,30,31][B]};Date.getTimezoneOffset=function(A,B){return(B||false)?Date.CultureInfo.abbreviatedTimeZoneDST[A.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[A.toUpperCase()]};Date.getTimezoneAbbreviation=function(B,D){var C=(D||false)?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,A;for(A in C){if(C[A]===B){return A}}return null};Date.prototype.clone=function(){return new Date(this.getTime())};Date.prototype.compareTo=function(A){if(isNaN(this)){throw new Error(this)}if(A instanceof Date&&!isNaN(A)){return(this>A)?1:(this<A)?-1:0}else{throw new TypeError(A)}};Date.prototype.equals=function(A){return(this.compareTo(A)===0)};Date.prototype.between=function(C,A){var B=this.getTime();return B>=C.getTime()&&B<=A.getTime()};Date.prototype.addMilliseconds=function(A){this.setMilliseconds(this.getMilliseconds()+A);return this};Date.prototype.addSeconds=function(A){return this.addMilliseconds(A*1000)};Date.prototype.addMinutes=function(A){return this.addMilliseconds(A*60000)};Date.prototype.addHours=function(A){return this.addMilliseconds(A*3600000)};Date.prototype.addDays=function(A){return this.addMilliseconds(A*86400000)};Date.prototype.addWeeks=function(A){return this.addMilliseconds(A*604800000)};Date.prototype.addMonths=function(A){var B=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+A);this.setDate(Math.min(B,this.getDaysInMonth()));return this};Date.prototype.addYears=function(A){return this.addMonths(A*12)};Date.prototype.add=function(B){if(typeof B=="number"){this._orient=B;return this}var A=B;if(A.millisecond||A.milliseconds){this.addMilliseconds(A.millisecond||A.milliseconds)}if(A.second||A.seconds){this.addSeconds(A.second||A.seconds)}if(A.minute||A.minutes){this.addMinutes(A.minute||A.minutes)}if(A.hour||A.hours){this.addHours(A.hour||A.hours)}if(A.month||A.months){this.addMonths(A.month||A.months)}if(A.year||A.years){this.addYears(A.year||A.years)}if(A.day||A.days){this.addDays(A.day||A.days)}return this};Date._validate=function(D,C,A,B){if(typeof D!="number"){throw new TypeError(D+" is not a Number.")}else{if(D<C||D>A){throw new RangeError(D+" is not a valid value for "+B+".")}}return true};Date.validateMillisecond=function(A){return Date._validate(A,0,999,"milliseconds")};Date.validateSecond=function(A){return Date._validate(A,0,59,"seconds")};Date.validateMinute=function(A){return Date._validate(A,0,59,"minutes")};Date.validateHour=function(A){return Date._validate(A,0,23,"hours")};Date.validateDay=function(C,A,B){return Date._validate(C,1,Date.getDaysInMonth(A,B),"days")};Date.validateMonth=function(A){return Date._validate(A,0,11,"months")};Date.validateYear=function(A){return Date._validate(A,1,9999,"seconds")};Date.prototype.set=function(B){var A=B;if(!A.millisecond&&A.millisecond!==0){A.millisecond=-1}if(!A.second&&A.second!==0){A.second=-1}if(!A.minute&&A.minute!==0){A.minute=-1}if(!A.hour&&A.hour!==0){A.hour=-1}if(!A.day&&A.day!==0){A.day=-1}if(!A.month&&A.month!==0){A.month=-1}if(!A.year&&A.year!==0){A.year=-1}if(A.millisecond!=-1&&Date.validateMillisecond(A.millisecond)){this.addMilliseconds(A.millisecond-this.getMilliseconds())}if(A.second!=-1&&Date.validateSecond(A.second)){this.addSeconds(A.second-this.getSeconds())}if(A.minute!=-1&&Date.validateMinute(A.minute)){this.addMinutes(A.minute-this.getMinutes())}if(A.hour!=-1&&Date.validateHour(A.hour)){this.addHours(A.hour-this.getHours())}if(A.month!==-1&&Date.validateMonth(A.month)){this.addMonths(A.month-this.getMonth())}if(A.year!=-1&&Date.validateYear(A.year)){this.addYears(A.year-this.getFullYear())}if(A.day!=-1&&Date.validateDay(A.day,this.getFullYear(),this.getMonth())){this.addDays(A.day-this.getDate())}if(A.timezone){this.setTimezone(A.timezone)}if(A.timezoneOffset){this.setTimezoneOffset(A.timezoneOffset)}return this};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};Date.prototype.isLeapYear=function(){var A=this.getFullYear();return(((A%4===0)&&(A%100!==0))||(A%400===0))};Date.prototype.isWeekday=function(){return !(this.is().sat()||this.is().sun())};Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())};Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})};Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})};Date.prototype.moveToDayOfWeek=function(A,B){var C=(A-this.getDay()+7*(B||+1))%7;return this.addDays((C===0)?C+=7*(B||+1):C)};Date.prototype.moveToMonth=function(C,A){var B=(C-this.getMonth()+12*(A||+1))%12;return this.addMonths((B===0)?B+=12*(A||+1):B)};Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/86400000)};Date.prototype.getWeekOfYear=function(A){var G=this.getFullYear(),C=this.getMonth(),E=this.getDate();var I=A||Date.CultureInfo.firstDayOfWeek;var D=7+1-new Date(G,0,1).getDay();if(D==8){D=1}var B=((Date.UTC(G,C,E,0,0,0)-Date.UTC(G,0,1,0,0,0))/86400000)+1;var H=Math.floor((B-D+7)/7);if(H===I){G--;var F=7+1-new Date(G,0,1).getDay();if(F==2||F==8){H=53}else{H=52}}return H};Date.prototype.isDST=function(){console.log("isDST");return this.toString().match(/(E|C|M|P)(S|D)T/)[2]=="D"};Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())};Date.prototype.setTimezoneOffset=function(B){var A=this.getTimezoneOffset(),C=Number(B)*-6/10;this.addMinutes(C-A);return this};Date.prototype.setTimezone=function(A){return this.setTimezoneOffset(Date.getTimezoneOffset(A))};Date.prototype.getUTCOffset=function(){var B=this.getTimezoneOffset()*-10/6,A;if(B<0){A=(B-10000).toString();return A[0]+A.substr(2)}else{A=(B+10000).toString();return"+"+A.substr(1)}};Date.prototype.getDayName=function(A){return A?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]};Date.prototype.getMonthName=function(A){return A?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]};Date.prototype._toString=Date.prototype.toString;Date.prototype.toString=function(C){var A=this;var B=function B(D){return(D.toString().length==1)?"0"+D:D};return C?C.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(D){switch(D){case"hh":return B(A.getHours()<13?A.getHours():(A.getHours()-12));case"h":return A.getHours()<13?A.getHours():(A.getHours()-12);case"HH":return B(A.getHours());case"H":return A.getHours();case"mm":return B(A.getMinutes());case"m":return A.getMinutes();case"ss":return B(A.getSeconds());case"s":return A.getSeconds();case"yyyy":return A.getFullYear();case"yy":return A.getFullYear().toString().substring(2,4);case"dddd":return A.getDayName();case"ddd":return A.getDayName(true);case"dd":return B(A.getDate());case"d":return A.getDate().toString();case"MMMM":return A.getMonthName();case"MMM":return A.getMonthName(true);case"MM":return B((A.getMonth()+1));case"M":return A.getMonth()+1;case"t":return A.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return A.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()};Date.now=function(){return new Date()};Date.today=function(){return Date.now().clearTime()};Date.prototype._orient=+1;Date.prototype.next=function(){this._orient=+1;return this};Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){this._orient=-1;return this};Date.prototype._is=false;Date.prototype.is=function(){this._is=true;return this};Number.prototype._dateElement="day";Number.prototype.fromNow=function(){var A={};A[this._dateElement]=this;return Date.now().add(A)};Number.prototype.ago=function(){var A={};A[this._dateElement]=this*-1;return Date.now().add(A)};(function(){var G=Date.prototype,A=Number.prototype;var M=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),L=("january february march april may june july august september october november december").split(/\s/),K=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),J;var I=function(N){return function(){if(this._is){this._is=false;return this.getDay()==N}return this.moveToDayOfWeek(N,this._orient)}};for(var F=0;F<M.length;F++){G[M[F]]=G[M[F].substring(0,3)]=I(F)}var H=function(N){return function(){if(this._is){this._is=false;return this.getMonth()===N}return this.moveToMonth(N,this._orient)}};for(var D=0;D<L.length;D++){G[L[D]]=G[L[D].substring(0,3)]=H(D)}var E=function(N){return function(){if(N.substring(N.length-1)!="s"){N+="s"}return this["add"+N](this._orient)}};var B=function(N){return function(){this._dateElement=N;return this}};for(var C=0;C<K.length;C++){J=K[C].toLowerCase();G[J]=G[J+"s"]=E(K[C]);A[J]=A[J+"s"]=B(J)}}());Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")};Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)};Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)};Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)};Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)};Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};(function(){Date.Parsing={Exception:function(I){this.message="Parse error at '"+I.substring(0,10)+" ...'"}};var A=Date.Parsing;var C=A.Operators={rtoken:function(I){return function(J){var K=J.match(I);if(K){return([K[0],J.substring(K[0].length)])}else{throw new A.Exception(J)}}},token:function(I){return function(J){return C.rtoken(new RegExp("^s*"+J+"s*"))(J)}},stoken:function(I){return C.rtoken(new RegExp("^"+I))},until:function(I){return function(J){var K=[],M=null;while(J.length){try{M=I.call(this,J)}catch(L){K.push(M[0]);J=M[1];continue}break}return[K,J]}},many:function(I){return function(J){var M=[],K=null;while(J.length){try{K=I.call(this,J)}catch(L){return[M,J]}M.push(K[0]);J=K[1]}return[M,J]}},optional:function(I){return function(J){var K=null;try{K=I.call(this,J)}catch(L){return[null,J]}return[K[0],K[1]]}},not:function(I){return function(J){try{I.call(this,J)}catch(K){return[null,J]}throw new A.Exception(J)}},ignore:function(I){return I?function(J){var K=null;K=I.call(this,J);return[null,K[1]]}:null},product:function(){var J=arguments[0],K=Array.prototype.slice.call(arguments,1),L=[];for(var I=0;I<J.length;I++){L.push(C.each(J[I],K))}return L},cache:function(K){var I={},J=null;return function(L){try{J=I[L]=(I[L]||K.call(this,L))}catch(M){J=I[L]=M}if(J instanceof A.Exception){throw J}else{return J}}},any:function(){var I=arguments;return function(K){var L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue}try{L=(I[J].call(this,K))}catch(M){L=null}if(L){return L}}throw new A.Exception(K)}},each:function(){var I=arguments;return function(K){var N=[],L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue}try{L=(I[J].call(this,K))}catch(M){throw new A.Exception(K)}N.push(L[0]);K=L[1]}return[N,K]}},all:function(){var J=arguments,I=I;return I.each(I.optional(J))},sequence:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;if(I.length==1){return I[0]}return function(O){var P=null,Q=null;var S=[];for(var N=0;N<I.length;N++){try{P=I[N].call(this,O)}catch(R){break}S.push(P[0]);try{Q=J.call(this,P[1])}catch(M){Q=null;break}O=Q[1]}if(!P){throw new A.Exception(O)}if(Q){throw new A.Exception(Q[1])}if(K){try{P=K.call(this,P[1])}catch(L){throw new A.Exception(P[1])}}return[S,(P?P[1]:O)]}},between:function(J,K,I){I=I||J;var L=C.each(C.ignore(J),K,C.ignore(I));return function(M){var N=L.call(this,M);return[[N[0][0],r[0][2]],N[1]]}},list:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return(I instanceof Array?C.each(C.product(I.slice(0,-1),C.ignore(J)),I.slice(-1),C.ignore(K)):C.each(C.many(C.each(I,C.ignore(J))),px,C.ignore(K)))},set:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return function(X){var L=null,N=null,M=null,O=null,P=[[],X],W=false;for(var R=0;R<I.length;R++){M=null;N=null;L=null;W=(I.length==1);try{L=I[R].call(this,X)}catch(U){continue}O=[[L[0]],L[1]];if(L[1].length>0&&!W){try{M=J.call(this,L[1])}catch(V){W=true}}else{W=true}if(!W&&M[1].length===0){W=true}if(!W){var S=[];for(var Q=0;Q<I.length;Q++){if(R!=Q){S.push(I[Q])}}N=C.set(S,J).call(this,M[1]);if(N[0].length>0){O[0]=O[0].concat(N[0]);O[1]=N[1]}}if(O[1].length<P[1].length){P=O}if(P[1].length===0){break}}if(P[0].length===0){return P}if(K){try{M=K.call(this,P[1])}catch(T){throw new A.Exception(P[1])}P[1]=M[1]}return P}},forward:function(I,J){return function(K){return I[J].call(this,K)}},replace:function(J,I){return function(K){var L=J.call(this,K);return[I,L[1]]}},process:function(J,I){return function(K){var L=J.call(this,K);return[I.call(this,L[0]),L[1]]}},min:function(I,J){return function(K){var L=J.call(this,K);if(L[0].length<I){throw new A.Exception(K)}return L}}};var H=function(I){return function(){var J=null,M=[];if(arguments.length>1){J=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){J=arguments[0]}}if(J){for(var L=0,K=J.shift();L<K.length;L++){J.unshift(K[L]);M.push(I.apply(null,J));J.shift();return M}}else{return I.apply(null,arguments)}}};var G="optional not ignore cache".split(/\s/);for(var D=0;D<G.length;D++){C[G[D]]=H(C[G[D]])}var F=function(I){return function(){if(arguments[0] instanceof Array){return I.apply(null,arguments[0])}else{return I.apply(null,arguments)}}};var E="each any all".split(/\s/);for(var B=0;B<E.length;B++){C[E[B]]=F(C[E[B]])}}());(function(){var F=function(J){var K=[];for(var I=0;I<J.length;I++){if(J[I] instanceof Array){K=K.concat(F(J[I]))}else{if(J[I]){K.push(J[I])}}}return K};Date.Grammar={};Date.Translator={hour:function(I){return function(){this.hour=Number(I)}},minute:function(I){return function(){this.minute=Number(I)}},second:function(I){return function(){this.second=Number(I)}},meridian:function(I){return function(){this.meridian=I.slice(0,1).toLowerCase()}},timezone:function(I){return function(){var J=I.replace(/[^\d\+\-]/g,"");if(J.length){this.timezoneOffset=Number(J)}else{this.timezone=I.toLowerCase()}}},day:function(I){var J=I[0];return function(){this.day=Number(J.match(/\d+/)[0])}},month:function(I){return function(){this.month=((I.length==3)?Date.getMonthNumberFromName(I):(Number(I)-1))}},year:function(I){return function(){var J=Number(I);this.year=((I.length>2)?J:(J+(((J+2000)<Date.CultureInfo.twoDigitYearMax)?2000:1900)))}},rday:function(I){return function(){switch(I){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(I){I=(I instanceof Array)?I:[I];var J=new Date();this.year=J.getFullYear();this.month=J.getMonth();this.day=1;this.hour=0;this.minute=0;this.second=0;for(var K=0;K<I.length;K++){if(I[K]){I[K].call(this)}}this.hour=(this.meridian=="p"&&this.hour<13)?this.hour+12:this.hour;if(this.day>Date.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var L=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){L.set({timezone:this.timezone})}else{if(this.timezoneOffset){L.set({timezoneOffset:this.timezoneOffset})}}return L},finish:function(I){I=(I instanceof Array)?F(I):[I];if(I.length===0){return null}for(var M=0;M<I.length;M++){if(typeof I[M]=="function"){I[M].call(this)}}if(this.now){return new Date()}var J=Date.today();var P=null;var N=!!(this.days!=null||this.orient||this.operator);if(N){var O,L,K;K=((this.orient=="past"||this.operator=="subtract")?-1:1);if(this.weekday){this.unit="day";O=(Date.getDayNumberFromName(this.weekday)-J.getDay());L=7;this.days=O?((O+(K*L))%L):(K*L)}if(this.month){this.unit="month";O=(this.month-J.getMonth());L=12;this.months=O?((O+(K*L))%L):(K*L);this.month=null}if(!this.unit){this.unit="day"}if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}if(this.unit=="week"){this.unit="day";this.value=this.value*7}this[this.unit+"s"]=this.value*K}return J.add(this)}else{if(this.meridian&&this.hour){this.hour=(this.hour<13&&this.meridian=="p")?this.hour+12:this.hour}if(this.weekday&&!this.day){this.day=(J.addDays((Date.getDayNumberFromName(this.weekday)-J.getDay()))).getDate()}if(this.month&&!this.day){this.day=1}return J.set(this)}}};var B=Date.Parsing.Operators,E=Date.Grammar,D=Date.Translator,H;E.datePartDelimiter=B.rtoken(/^([\s\-\.\,\/\x27]+)/);E.timePartDelimiter=B.stoken(":");E.whiteSpace=B.rtoken(/^\s*/);E.generalDelimiter=B.rtoken(/^(([\s\,]|at|on)+)/);var A={};E.ctoken=function(M){var L=A[M];if(!L){var N=Date.CultureInfo.regexPatterns;var K=M.split(/\s+/),J=[];for(var I=0;I<K.length;I++){J.push(B.replace(B.rtoken(N[K[I]]),K[I]))}L=A[M]=B.any.apply(null,J)}return L};E.ctoken2=function(I){return B.rtoken(Date.CultureInfo.regexPatterns[I])};E.h=B.cache(B.process(B.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),D.hour));E.hh=B.cache(B.process(B.rtoken(/^(0[0-9]|1[0-2])/),D.hour));E.H=B.cache(B.process(B.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),D.hour));E.HH=B.cache(B.process(B.rtoken(/^([0-1][0-9]|2[0-3])/),D.hour));E.m=B.cache(B.process(B.rtoken(/^([0-5][0-9]|[0-9])/),D.minute));E.mm=B.cache(B.process(B.rtoken(/^[0-5][0-9]/),D.minute));E.s=B.cache(B.process(B.rtoken(/^([0-5][0-9]|[0-9])/),D.second));E.ss=B.cache(B.process(B.rtoken(/^[0-5][0-9]/),D.second));E.hms=B.cache(B.sequence([E.H,E.mm,E.ss],E.timePartDelimiter));E.t=B.cache(B.process(E.ctoken2("shortMeridian"),D.meridian));E.tt=B.cache(B.process(E.ctoken2("longMeridian"),D.meridian));E.z=B.cache(B.process(B.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),D.timezone));E.zz=B.cache(B.process(B.rtoken(/^(\+|\-)\s*\d\d\d\d/),D.timezone));E.zzz=B.cache(B.process(E.ctoken2("timezone"),D.timezone));E.timeSuffix=B.each(B.ignore(E.whiteSpace),B.set([E.tt,E.zzz]));E.time=B.each(B.optional(B.ignore(B.stoken("T"))),E.hms,E.timeSuffix);E.d=B.cache(B.process(B.each(B.rtoken(/^([0-2]\d|3[0-1]|\d)/),B.optional(E.ctoken2("ordinalSuffix"))),D.day));E.dd=B.cache(B.process(B.each(B.rtoken(/^([0-2]\d|3[0-1])/),B.optional(E.ctoken2("ordinalSuffix"))),D.day));E.ddd=E.dddd=B.cache(B.process(E.ctoken("sun mon tue wed thu fri sat"),function(I){return function(){this.weekday=I}}));E.M=B.cache(B.process(B.rtoken(/^(1[0-2]|0\d|\d)/),D.month));E.MM=B.cache(B.process(B.rtoken(/^(1[0-2]|0\d)/),D.month));E.MMM=E.MMMM=B.cache(B.process(E.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),D.month));E.y=B.cache(B.process(B.rtoken(/^(\d\d?)/),D.year));E.yy=B.cache(B.process(B.rtoken(/^(\d\d)/),D.year));E.yyy=B.cache(B.process(B.rtoken(/^(\d\d?\d?\d?)/),D.year));E.yyyy=B.cache(B.process(B.rtoken(/^(\d\d\d\d)/),D.year));H=function(){return B.each(B.any.apply(null,arguments),B.not(E.ctoken2("timeContext")))};E.day=H(E.d,E.dd);E.month=H(E.M,E.MMM);E.year=H(E.yyyy,E.yy);E.orientation=B.process(E.ctoken("past future"),function(I){return function(){this.orient=I}});E.operator=B.process(E.ctoken("add subtract"),function(I){return function(){this.operator=I}});E.rday=B.process(E.ctoken("yesterday tomorrow today now"),D.rday);E.unit=B.process(E.ctoken("minute hour day week month year"),function(I){return function(){this.unit=I}});E.value=B.process(B.rtoken(/^\d\d?(st|nd|rd|th)?/),function(I){return function(){this.value=I.replace(/\D/g,"")}});E.expression=B.set([E.rday,E.operator,E.value,E.unit,E.orientation,E.ddd,E.MMM]);H=function(){return B.set(arguments,E.datePartDelimiter)};E.mdy=H(E.ddd,E.month,E.day,E.year);E.ymd=H(E.ddd,E.year,E.month,E.day);E.dmy=H(E.ddd,E.day,E.month,E.year);E.date=function(I){return((E[Date.CultureInfo.dateElementOrder]||E.mdy).call(this,I))};E.format=B.process(B.many(B.any(B.process(B.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(I){if(E[I]){return E[I]}else{throw Date.Parsing.Exception(I)}}),B.process(B.rtoken(/^[^dMyhHmstz]+/),function(I){return B.ignore(B.stoken(I))}))),function(I){return B.process(B.each.apply(null,I),D.finishExact)});var G={};var C=function(I){return G[I]=(G[I]||E.format(I)[0])};E.formats=function(J){if(J instanceof Array){var K=[];for(var I=0;I<J.length;I++){K.push(C(J[I]))}return B.any.apply(null,K)}else{return C(J)}};E._formats=E.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]);E._start=B.process(B.set([E.date,E.time,E.expression],E.generalDelimiter,E.whiteSpace),D.finish);E.start=function(I){try{var J=E._formats.call({},I);if(J[1].length===0){return J}}catch(K){}return E._start.call({},I)}}());Date._parse=Date.parse;Date.parse=function(A){var B=null;if(!A){return null}try{B=Date.Grammar.start.call({},A)}catch(C){return null}return((B[1].length===0)?B[0]:null)};Date.getParseFunction=function(B){var A=Date.Grammar.formats(B);return function(C){var D=null;try{D=A.call({},C)}catch(E){return null}return((D[1].length===0)?D[0]:null)}};Date.parseExact=function(A,B){return Date.getParseFunction(B)(A)};
/*
  affix plug-in for jQuery, License - MIT, Copyright 2009 Traversal: http://traversal.com.au
*/
(function(G){var H={animate:false,animateOptions:{duration:"normal"},to:"ne",keepInWindow:true,offset:[0,0],inset:[0,0],use:"offset",fixed:true,smartOffscreenInset:true,classGlueFromPrefix:"glue-",classGlueToPrefix:"glue-",layerfix:false,autoEvents:{scroll:true,resize:true}};var F=(function(){var I=["Moz","Webkit","Khtml","O","Ms"];var K={};function J(L,O){O=O||document.documentElement;var N=O.style,R,M,P,Q;if(arguments.length===1&&typeof K[L]==="string"){return K[L]}if(typeof N[L]==="string"){return(K[L]=L)}M=L.charAt(0).toUpperCase()+L.slice(1);for(P=0,Q=I.length;P<Q;P++){R=I[P]+M;if(typeof N[R]==="string"){return(K[L]=R)}}}return J}());var D=false;var C=false;var A=G.browser.msie&&G.browser.version<7;var B="affix";var E=function(){var K,L,I='<div style="position:absolute; top:0; left:0; margin:0; padding:0; width:1px; height:1px;"><div></div></div>';D=true;var J=G("<div/>").css({position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}).html(I);var L=J.find("div>div").get(0);G("body").prepend(J);window.cTest=J;L.style.position="absolute";L.style[F("transform")]="translate(20px, 0px)";C=G(L).position().left===0;J.remove()};G.fn[B+"_translate"]=function(){var K=G(this).eq(0);var J={top:0,left:0};var M=F("transform");if(M){var I=K.css(M);if(I){var L=I.match(/matrix\((.*?)\)/);if(L&&L.length&&L.length==2){vals=L[1].split(",");if(vals.length==6){J.top+=parseInt(vals[5]);J.left+=parseInt(vals[4])}}}}return J};G.fn[B+"_position"]=function(){if(!D){E()}var K=G(this);var I=K.position();if(C){var J=K[B+"_translate"]();I.top+=J.top;I.left+=J.left}return I};G.fn[B+"_offset"]=function(){if(!D){E()}var J=G(this);var K=J.offset();if(C){var I=J[B+"_translate"]();K.top+=I.top;K.left+=I.left}return K};G.fn.affixPosition=function(){var f,R={},s={},w=arguments;if(w.length>=1){if(typeof (w[0])=="string"){f=w[0]}else{R=w[0]}if(w.length>=2){s=w[1]}}var q,Y=s,Z={},x={},L=G(this).eq(0);if(G.fn.metadata){x=L.metadata({type:"class"})}if(!f){q=L.data(B);if(!q){q={};L.data(B,q)}G.extend(true,Z,H,R,x[B]||x||{});q.options=Z}else{q=L.data(B);if(q){Z=q.options}else{return this}}var M,I,v,y,P,K,l;if(Z.offsets){Z.offset=Z.offsets}if(R&&(R.animateOptions||R.animateParams)){Z.animate=true}if(R&&(R.reaffixing)){Z.animate=false}if(Z.glueInsideWindow){Z.keepInWindow=Z.glueInsideWindow}Z.element=Z.element||Z.el||Z.e||Z.target;Z.window=Z.window||Z.win||Z.w;Z.offscreen=Z.offscreen||Z.os||Z.o;if(!(Z.element||Z.window||Z.offscreen)){throw ("No affix target specified")}K={width:G(window).width(),height:G(window).height()};P={top:G(window).scrollTop(),left:G(window).scrollLeft()};v={width:L.outerWidth(),height:L.outerHeight()};var T={derive:function(d){var a={from:Z.from,to:Z.to};var p=u(d||T.eqn,Z.from);var o=S(p,a);var m=j(p,a);e(L,Z.from,Z.classGlueFromPrefix);return{left:p.left,top:p.top,from:a.from,to:a.to,offset:o,insetOffset:m}},eqn:{n:"wx+h:ww-h:fw,wy",ne:"wx+ww-fw,wy",e:"wx+ww-fw,wy+h:wh-h:fh",se:"wx+ww-fw,wy+wh-fh",s:"wx+h:ww-h:fw,wy+wh-fh",sw:"wx,wy+wh-fh",w:"wx,wy+h:wh-h:fh",nw:"wx,wy",c:"wx+h:ww-h:fw,wy+h:wh-h:fh"}};var N={derive:function(){return T.derive(N.eqn)},eqn:{n:"wx+h:ww-h:fw,wy-fh",nne:"wx+ww-fw,wy-fh",ne:"wx+ww,wy-fh",ene:"wx+ww,wy",e:"wx+ww,wy+h:wh-h:fh",ese:"wx+ww,wy+wh-fh",se:"wx+ww,wy+wh",sse:"wx+ww-fw,wy+wh",s:"wx+h:ww-h:fw,wy+wh",ssw:"wx,wy+wh",sw:"wx-fw,wy+wh",wsw:"wx-fw,wy+wh-fh",w:"wx-fw,wy+h:wh-h:fh",wnw:"wx-fw,wy",nw:"wx-fw,wy-fh",nnw:"wx,wy-fh"}};N.eqn.c=N.eqn.n;N.eqn.nwv=N.eqn.vnw=N.eqn.nnw;N.eqn.nwh=N.eqn.hnw=N.eqn.wnw;N.eqn.nev=N.eqn.vne=N.eqn.nne;N.eqn.neh=N.eqn.hne=N.eqn.ene;N.eqn.sev=N.eqn.vse=N.eqn.sse;N.eqn.seh=N.eqn.hse=N.eqn.ese;N.eqn.swv=N.eqn.vsw=N.eqn.ssw;N.eqn.swh=N.eqn.hsw=N.eqn.wsw;var n={derive:function(){var m=W.css("visibility");if(Z.use=="position"||Z.position=="relative"){M=W[B+"_position"]()}else{M=W[B+"_offset"]()}I={width:W.outerWidth(),height:W.outerHeight()};var d={to:Z.to,from:Z.from};var z=n.getPosition(d);var p=S(z,d);var o=j(z,d);if(Z.keepInWindow){var a=n.glueInsideWindow(z,d);if(a){d=a;z=n.getPosition(d);p=S(z,d);o=j(z,d)}}e(L,d.from,Z.classGlueFromPrefix);e(W,d.to,Z.classGlueToPrefix);return{left:z.left,top:z.top,from:d.from,to:d.to,offset:p,insetOffset:o}},getPosition:function(a){return u(n.eqn,a.from+"_"+a.to,n.tokenValue)},glueInsideWindow:function(AB,p){var m=p.to.search("n")!=-1;var a=p.to.search("s")!=-1;var AA=p.to.search("e")!=-1;var AD=p.to.search("w")!=-1;var AC=AB.top<P.top;var o=AB.left<P.left;var d=AB.left+v.width>P.left+K.width;var z=AB.top+v.height>P.top+K.height;var AE=[p.from,p.to];if(!AC&&!z&&!d&&!o){return false}if((AC&&m)||(z&&a)){AE[0]=n.swapNS(AE[0]);AE[1]=n.swapNS(AE[1])}if((d&&AA)||(o&&AD)){AE[0]=n.swapEW(AE[0]);AE[1]=n.swapEW(AE[1])}return{from:AE[0],to:AE[1]}},swapNS:function(a){return a.replace(/n/g,"T").replace(/s/g,"n").replace(/T/g,"s")},swapEW:function(a){return a.replace(/e/g,"T").replace(/w/g,"e").replace(/T/g,"w")},tokenValue:function(a){switch(a){case"tpw":case"tpe":case"tps":case"tpn":return g(n.eqnm[a.substr(2,1)],n.tokenValue);case"h:tw":case"h:th":return Math.round(n.tokenValue(a.substr(2,2))/2);case"tw":return I.width;case"th":return I.height;case"tpx":return M.left;case"tpy":return M.top;default:return b(a)}return false},eqn:{n_n:"tpx+h:tw-h:fw,tpn",n_ne:"tpe-h:fw,tpn",n_e:"tpe-h:fw,tpn+h:th",n_se:"tpe-h:fw,tps",n_s:"tpw+h:tw-h:fw,tps",n_sw:"tpw-h:fw,tps",n_w:"tpw-h:fw,tpn+h:th",n_nw:"tpw-h:fw,tpn",n_c:"tpw+h:tw-h:fw,tpn+h:th",ne_n:"tpx+h:tw-fw,tpn",ne_ne:"tpe-fw,tpn",ne_e:"tpe-fw,tpn+h:th",ne_se:"tpe-fw,tps",ne_sw:"tpw-fw,tps",ne_s:"tpw+h:tw-fw,tps",ne_w:"tpw-fw,tpn+h:th",ne_nw:"tpw-fw,tpn",ne_c:"tpw+h:tw-fw,tpn+h:th",e_n:"tpx+h:tw-fw,tpn-h:fh",e_ne:"tpe-fw,tpn-h:fh",e_e:"tpe-fw,tpn+h:th-h:fh",e_se:"tpe-fw,tps-h:fh",e_s:"tpw+h:tw-fw,tps-h:fh",e_sw:"tpw-fw,tps-h:fh",e_w:"tpw-fw,tpn+h:th-h:fh",e_nw:"tpw-fw,tpn-h:fh",e_c:"tpw+h:tw-fw,tpn+h:th-h:fh",se_n:"tpx+h:tw-fw,tpn-fh",se_ne:"tpe-fw,tpn-fh",se_e:"tpe-fw,tpn+h:th-fh",se_se:"tpe-fw,tps-fh",se_s:"tpw+h:tw-fw,tps-fh",se_sw:"tpw-fw,tps-fh",se_w:"tpw-fw,tpn+h:th-fh",se_nw:"tpw-fw,tpn-fh",se_c:"tpw+h:tw-fw,tpn+h:th-fh",s_n:"tpx+h:tw-h:fw,tpn-fh",s_ne:"tpe-h:fw,tpn-fh",s_e:"tpe-h:fw,tpn+h:th-fh",s_se:"tpe-h:fw,tps-fh",s_s:"tpw+h:tw-h:fw,tps-fh",s_sw:"tpw-h:fw,tps-fh",s_w:"tpw-h:fw,tpn+h:th-fh",s_nw:"tpw-h:fw,tpn-fh",s_c:"tpw+h:tw-h:fw,tpn+h:th-fh",sw_n:"tpx+h:tw,tpn-fh",sw_ne:"tpe,tpn-fh",sw_e:"tpe,tpn+h:th-fh",sw_se:"tpe,tps-fh",sw_s:"tpw+h:tw,tps-fh",sw_sw:"tpw,tps-fh",sw_w:"tpw,tpn+h:th-fh",sw_nw:"tpw,tpn-fh",sw_c:"tpw+h:tw,tpn+h:th-fh",w_n:"tpx+h:tw,tpn-h:fh",w_ne:"tpe,tpn-h:fh",w_e:"tpe,tpn+h:th-h:fh",w_se:"tpe,tps-h:fh",w_s:"tpw+h:tw,tps-h:fh",w_sw:"tpw,tps-h:fh",w_w:"tpw,tpn+h:th-h:fh",w_nw:"tpw,tpn-h:fh",w_c:"tpw+h:tw,tpn+h:th-h:fh",nw_n:"tpx+h:tw,tpn",nw_ne:"tpe,tpn",nw_e:"tpe,tpn+h:th",nw_se:"tpe,tps",nw_s:"tpw+h:tw,tps",nw_sw:"tpw,tps",nw_w:"tpw,tpn+h:th",nw_nw:"tpw,tpn",nw_c:"tpw+h:tw,tpn+h:th",c_n:"tpx+h:tw-h:fw,tpn-h:fh",c_ne:"tpe-h:fw,tpn-h:fh",c_e:"tpe-h:fw,tpn+h:th-h:fh",c_se:"tpe-h:fw,tps-h:fh",c_s:"tpw+h:tw-h:fw,tps-h:fh",c_sw:"tpw-h:fw,tps-h:fh",c_w:"tpw-h:fw,tpn+h:th-h:fh",c_nw:"tpw-h:fw,tpn-h:fh",c_c:"tpw+h:tw-h:fw,tpn+h:th-h:fh"},eqnm:{n:"tpy",ne:"",e:"tpx+tw",s:"tpy+th",w:"tpx"}};var u=function(o,a,d){var m=o[a].split(",");return{left:Math.round(g(m[0],d||b)),top:Math.round(g(m[1],d||b))}};var e=function(d,m,a){d.attr("class",d.attr("class").replace(new RegExp("s?"+a+"[newsvhc]{1,3}s?","gi"),""));d.addClass(a+m)};var b=function(a){switch(a){case"h:fw":case"h:fh":case"h:wh":case"h:ww":return Math.round(b(a.substr(2,2))/2);case"ww":return K.width;case"wh":return K.height;case"wx":return(Z.fixed&&!A)?0:P.left;case"wy":return(Z.fixed&&!A)?0:P.top;case"fw":return v.width;case"fh":return v.height}return false};var Q=function(a){var d;if(!Z.offset.length&&Z.offset[a.from+"_"+a.to]){d=Z.offset[a.from+"_"+a.to]}else{if(Z.offset.length&&Z.offset.length==2){d=Z.offset}else{if(Z.offset[a.from]){d=Z.offset[a.from]}else{if(Z.offset["*"]){d=Z.offset["*"]}}}}return d};var S=function(p,d){if(Z.offset){var m=Q(d)||[0,0];var a=parseInt(m[0],0);var o=parseInt(m[1],0);if(!isNaN(a)){p.left+=a}if(!isNaN(o)){p.top+=o}}return m};var j=function(m,a){var d=U(m,a);m.left+=d[0];m.top+=d[1];return d};var U=function(z,m){var d=Z.inset;if(d){if(typeof (d)=="number"){d=[d,d]}var a={c:"0,0",n:"0,y",nne:"-x,y",ne:"-x,y",ene:"-x,y",e:"-x,0",ese:"-x,-y",se:"-x,-y",sse:"-x,-y",s:"0,-y",ssw:"x,-y",sw:"x,-y",wsw:"x,-y",w:"x,0",wnw:"x,y",nw:"x,y",nnw:"x,y"};if(Z.smartOffscreenInset){a.nne="-x,0";a.ene="0,y";a.ese="0,-y";a.sse="-x,0";a.ssw="x,0";a.wsw="0,-y";a.wnw="0,y";a.nnw="x,0"}a.nwv=a.vnw=a.nnw;a.nwh=a.hnw=a.wnw;a.nev=a.vne=a.nne;a.neh=a.hne=a.ene;a.sev=a.vse=a.sse;a.seh=a.hse=a.ese;a.swv=a.vsw=a.ssw;a.swh=a.hsw=a.wsw;var o=(a[m.to]||a.c).split(",");return[V(o[0],d),V(o[1],d)]}return[0,0]};var V=function(d,o){var a=d.match(/([\-]?)([xy0])/);if(a){if(a[2]=="x"){if(a[1]=="-"){return -o[0]}else{return o[0]}}else{if(a[2]=="y"){if(a[1]=="-"){return -o[1]}else{return o[1]}}}}return 0};var g=function(o,z){var a=o.match(/([a-z:]+)|([\+\-])/g);var p=0;var AB;for(var AA=0;AA<a.length;AA++){AB=(z||b)(a[AA]);if(AB!==false){if(AA==0){p+=AB}else{if(AA%2==0){if(a[AA-1]=="+"){p+=AB}else{p-=AB}}}}}return p};if(Z.window||Z.offscreen){var J=Z.window||Z.offscreen;var c=J.match(/^(?:([nweschv]*))?(?:(\+|-)([0-9]+))?(?:,([0-9]+))?/);if(c){if(c[1]){Z.from=Z.to=c[1]}if(c[2]&&c[3]){var h=parseInt(c[2],0);var O=c[3]?parseInt(c[3],0):0;if(c[2]=="-"){Z.inset=[-O,-O];if(c[4]){Z.inset[1]=-m4v}}else{Z.inset=[O,O];if(c[4]){Z.inset[1]=m4v}}}if(Z.from&&(!Z.to||Z.to=="")){Z.to=Z.from}else{if(Z.to&&(!Z.from||Z.from=="")){Z.from=Z.to}}if(Z.window){l=T.derive();l.target="window"}else{if(Z.offscreen){l=N.derive();l.target="offscreen"}}}}else{var W=G(Z.element).eq(0);if(W.length==0){throw ("affix target element does not exist")}if(W){if(!Z.to){var X={sw:"ne",w:"e",nw:"se",n:"s",ne:"sw",e:"w",se:"nw",s:"n",c:"c"};Z.to=X[Z.from]||"c"}if(!Z.from){var k={ne:"sw",e:"w",se:"nw",s:"n",sw:"ne",w:"e",nw:"se",n:"s",c:"c"};Z.from=k[Z.to]||"c"}l=n.derive();l.target="element";l.t=W}}return l};G.fn.affix=function(){var K,J={},L={},I=arguments;if(I.length>=1){if(typeof (I[0])=="string"){K=I[0]}else{J=I[0]}if(I.length>=2){L=I[1]}}return this.each(function(){var T,Q=L,S={},N={},M=G(this);if(G.fn.metadata){N=M.metadata({type:"class"})}if(!K){T=M.data("affix");if(!T){T={};M.data("affix",T)}G.extend(true,S,H,J,N.affix||N||{});T.options=S}else{T=M.data("affix");if(T){S=T.options}else{return }}if(!K){var P=M.affixPosition.apply(this,I);T.fReaffix=function(U){if(M&&M.is(":visible")){M.affix("again")}};if(P.target=="window"||P.target=="offscreen"){if(S.fixed&&!A){var O=M.css("position");if(O!="fixed"){M.css("position","fixed")}}if(!T.windowOnResize){if(S.autoEvents&&S.autoEvents.resize){T.windowOnResize=T.fReaffix;G(window).resize(T.windowOnResize)}}if(!T.windowOnScroll){if(S.autoEvents&&S.autoEvents.scroll&&(A||!S.fixed)){T.windowOnScroll=T.fReaffix;G(window).scroll(T.windowOnScroll)}}}var R=function(){if(S.layerfix&&M.layerfix){M.layerfix(S.layerfix)}if(S.animateOptions.complete){S.animateOptions.complete()}};if(S.animate){M.animate(G.extend(true,{},S.animateParams||{},{left:P.left,top:P.top}),G.extend(true,{},S.animateOptions,{complete:R}))}else{M.css({left:P.left,top:P.top});R()}}else{if(K=="unaffix"){if(S.layerfix&&M.layerfix){M.layerfix("destroy")}M.affix("destroy")}else{if(K=="again"||K=="reaffix"){if(S.element||S.window||S.offscreen){M.affix(G.extend(true,{},S,{reaffixing:true}))}}else{if(K=="destroy"){if(T.windowOnResize){G(window).unbind("resize",T.windowOnResize);T.windowOnResize=null}if(T.windowOnScroll){G(window).unbind("scroll",T.windowOnScroll);T.windowOnScroll=null}if(T.ifs){T.ifs.remove()}T.options=null;M.removeData("affix")}}}}})};G.fn.unaffix=function(){return this.affix("unaffix")};G.fn.affixAnimate=G.fn.affixa=function(I){return this.affix(G.extend(true,{},I,{animate:true}))};G.fn.affixAnimateNQ=G.fn.affixanq=function(I){return this.affix(G.extend(true,{},I,{animateOptions:{queue:false}}))};G.fn.affixAnimateFadeIn=G.fn.affixafi=function(J,I){var K=J||{};return this.css({opacity:0}).show().affix(G.extend(true,{},J,{animate:true,animateParams:{opacity:I||1}}))};G.fn.affixAnimateFadeOut=G.fn.affixafo=function(J,I){return this.css({opacity:I||1}).affix(G.extend(true,{},J,{animateParams:{opacity:"hide"},animate:true,animateOptions:{complete:function(){G(this).hide()}}}))};G.fn.affix.defaults=H})(jQuery);
/*
  reveal plug-in for jQuery, License - MIT, Copyright: 2009 Traversal - http://traversal.com.au
*/
(function(B){var C={triggerEvent:"click",hoverIntent:{sensitivity:3,interval:200,timeout:0},selectorText:".text",classShown:"reveal-shown",affix:null,hideOnMouseLeave:false,hideOnTargetMouseLeave:false,hideOnDocumentClick:false,hideDelay:300,showDelay:300,selectorHide:".close",show:"show",hide:"hide",showOptions:{duration:0,effect:"fade",easing:"swing"},hideOptions:{duration:0,effect:"fade",easing:"swing"}};var A="reveal";B.fn[A]=function(){var F=this,G=this,H,E={},I={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){H=D[0]}else{E=D[0]}if(D.length>=2){I=D[1]||{}}}if(this.length){this.each(function(){var X,O,S,K=I,M={},U={},N=B(this);if(B.fn.metadata){U=N.metadata({type:"class"})}if(!H){S=N.data(A);if(!S){S={};N.data(A,S)}B.extend(true,M,C,E,U[A]||U||{});S.options=M}else{S=N.data(A);if(S){M=S.options}else{return }}X=function(){N[A].apply(N,arguments)};O=function(Z,Y){return N.trigger(jQuery.Event(Z+"."+A),B.isArray(Y)?Y:[Y])!==false};S.trigger=N;var T=M.target||M.e||M.el||M.element;if(M.hideSelector){M.selectorHide=M.hideSelector}S.cancelHide=function(){clearTimeout(S.toHide)};S.cancelShow=function(){clearTimeout(S.toShow)};S.enter=function(Y){if(!S.disabled){S.cancelHide();S.toShow=setTimeout(function(){X("show",{eventTarget:Y.target})},M.showDelay)}};S.leave=function(Y){if(!S.disabled){S.cancelShow();S.toHide=setTimeout(function(){X("hide",{eventTarget:Y.target})},M.hideDelay)}};S.click=function(Y){if(!S.disabled){if(S.target.is(":visible")){X("hide",{eventTarget:Y.target})}else{X("show",{eventTarget:Y.target})}}Y.preventDefault()};S.documentClick=function(Y){if(!(B(Y.target).closest(S.target).length||B(Y.target).closest(S.trigger).length)){X("hide")}else{B(document).one("click",S.documentClick)}};if(!H){S.elText=N.find(M.selectorText);if(!S.elText.length){S.elText=S.trigger}if(M.textShown){S.textShown=M.textShown;S.textHidden=S.elText.html()}else{if(M.textHidden){S.textHidden=M.textHidden;S.textShown=S.elText.html()}}if(!T){var J=N.attr("href");if(J&&J!=""){var Q=J.match(/#[a-zA-Z\-\_0-9]+/);if(Q&&Q.length){T=Q[0]}}}if(T){S.target=B(T).eq(0);if(S.target.length){S.target.data("reveal",{});var W=S.target.data("reveal");W.trigger=N;W.target=S.target;W.options=M;if(M.triggerEvent=="click"){N.click(S.click);if(M.hideOnMouseLeave){N.mouseenter(S.cancelHide);N.mouseleave(S.leave)}if(M.hideOnTargetMouseLeave){S.target.mouseenter(S.cancelHide);S.target.mouseleave(S.leave)}}else{if(M.triggerEvent=="hoverIntent"&&B.fn.hoverIntent){var V=B.extend({},M.hoverIntent,{over:S.enter,out:S.leave});N.hoverIntent(V);S.target.mouseenter(function(Z){S.cancelHide();var Y=N.get(0);clearTimeout(Y.hoverIntent_t);Y.hoverIntent_s=0});if(M.hideOnTargetMouseLeave){S.target.mouseleave(S.leave)}}else{N.mouseenter(S.enter);N.mouseleave(S.leave);S.target.mouseenter(S.cancelHide);if(M.hideOnTargetMouseLeave){S.target.mouseleave(S.leave)}}}B(M.selectorHide,S.target).click(function(Y){X("hide",{eventTarget:Y.target});Y.preventDefault()})}}}else{if(H=="hide"){S.edata=[{element:S.target,target:S.target,eventTarget:K.eventTarget}];if(S&&S.target&&S.trigger){var L=function(){if(!K.silent){S.trigger.trigger("afterhide.reveal",S.edata)}if(M.fUnposition){M.fUnposition(S.trigger,S.target)}else{if(S.target.unaffix&&M.affix){S.target.unaffix()}}if(S.textShown&&S.textHidden){S.elText.html(S.textHidden)}if(M.hideOnDocumentClick){B(document).unbind("click",S.documentClick)}if(M.hideOptions.complete){M.hideOptions.complete()}};if(!K.silent){var R=jQuery.Event("beforehide.reveal");S.trigger.trigger(R,S.edata)}if(K.silent||R.result!==false){S.trigger.removeClass(M.classShown);S.target.stop(true,true);if(K.instant){S.target.hide();L()}else{if(B.ui&&M.hide=="hide"){S.target.hide(M.hideOptions.effect,M.hideOptions,M.hideOptions.speed||M.hideOptions.duration,L)}else{S.target[M.hide](B.extend(true,{complete:L},M.hideOptions))}}var R=jQuery.Event("beforehideanimate.reveal");S.trigger.trigger(R,S.edata)}}}else{if(H=="toggle"){if(S.target.is(":visible")){X("hide")}else{X("show")}}else{if(H=="show"){if(S&&S.target&&S.trigger){S.edata=[{element:S.target,target:S.target,eventTarget:K.eventTarget}];var P=function(){if(!K.silent){S.trigger.trigger("aftershow.reveal",S.edata)}if(S.textShown&&S.textHidden){S.elText.html(S.textShown)}if(M.showOptions.complete){M.showOptions.complete()}if(M.hideOnDocumentClick){B(document).one("click",S.documentClick)}};if(!K.silent){var R=jQuery.Event("beforeshow.reveal");S.trigger.trigger(R,S.edata)}if(K.silent||R.result!==false){S.trigger.addClass(M.classShown);if(M.fPosition){M.fPosition(t,r)}else{if(S.target.affix&&M.affix){if(M.affix.el||M.affix.elem||M.affix.element){S.target.affix(M.affix)}else{S.target.affix(B.extend(true,{},M.affix,{target:S.trigger}))}}}if(!K.silent){var R=jQuery.Event("afterposition.reveal");S.trigger.trigger(R,S.edata)}S.target.stop(true,true);if(K.instant){S.target.show();P()}else{if(B.ui&&M.show=="show"){S.target.show(M.showOptions.effect,M.showOptions,M.showOptions.speed||M.showOptions.duration,P)}else{S.target[M.show](B.extend(true,{complete:P},M.showOptions))}}var R=jQuery.Event("beforeshowanimate.reveal");S.trigger.trigger(R,S.edata)}}}else{if(H=="hold"){S.cancelLeave()}else{if(H=="disable"){S.disabled=true;if(K.show){X("show",({instant:true}))}else{X("hide",({instant:true}))}}else{if(H=="enable"){S.disabled=false}else{if(H=="destroy"){if(M.triggerEvent=="click"){N.unbind("click",S.click);if(M.hideOnMouseLeave){N.unbind("mouseenter",cancelLeave);N.unbind("mouseleave",S.leave)}if(M.hideOnTargetMouseLeave){S.target.unbind("mouseenter",S.cancelLeave);S.target.unbind("mouseleave",S.leave)}}else{N.unbind("mouseenter",S.enter);N.unbind("mouseleave",S.leave);S.target.unbind("mouseenter",S.enter);if(M.hideOnTargetMouseLeave){S.target.unbind("mouseleave",S.leave)}}N.removeData("reveal")}}}}}}}}})}return F};B.fn.revealClick=function(D){return this.reveal(B.extend(true,{},D,{triggerEvent:"click"}))};B.fn.revealHover=function(D){return this.reveal(B.extend(true,{},D,{triggerEvent:"hover",hideOnTargetMouseLeave:true}))};B.fn.revealMenuHover=function(D){return this.reveal(B.extend(true,{},B.fn.reveal.presets.menuHover,D))};B.fn.revealMenuClick=function(D){return this.reveal(B.extend(true,{},B.fn.reveal.presets.menuClick,D))};B.fn.revealTooltip=function(D){return this.reveal(B.extend(true,{},B.fn.reveal.presets.tooltip,D))};B.fn[A].defaults=C;B.fn.reveal.presets={menuHover:{classShown:"menu-shown",show:"slideDown",showDelay:200,showOptions:{duration:200},hide:"slideUp",hideOptions:{duration:100},triggerEvent:"hoverIntent",hoverIntent:{interval:30},hideOnTargetMouseLeave:true,affix:{layerfix:{method:"hideSelects"},to:"sw",from:"nw",keepInWindow:false}},menuClick:{classShown:"menu-shown",show:"slideDown",showOptions:{duration:"fast"},hide:"slideUp",hideOptions:{duration:"fast"},triggerEvent:"click",hideOnTargetMouseLeave:true,affix:{layerfix:{method:"hideSelects"},to:"sw",from:"nw",keepInWindow:false}},tooltip:{classShown:"tooltip-shown",show:"fadeIn",showOptions:{duration:"fast"},hide:"fadeOut",hideOptions:{duration:"fast"},triggerEvent:"hover",hideOnTargetMouseLeave:true,affix:{layerfix:{method:"hideSelects"},to:"ne",from:"sw",keepInWindow:true}}}})(jQuery);
/*
  inputmask plug-in for jQuery, License - MIT, Copyright: 2010 Traversal - <http://traversal.com.au>
*/
(function(C){var D={reAllow:/[A-Za-z0-9\_\-\s]/,convert:{"-":"_"," ":"_","&":"","%":""},lowercase:true,uppercase:false,allowMetaKey:true};var A="inputmask";C.fn[A]=function(){var H,G=this,F={},I={},E=arguments;if(E.length>=1){if(typeof (E[0])=="string"){H=E[0]}else{F=E[0]}if(E.length>=2){I=E[1]}}this.each(function(){var N,L=I,M={},K={},J=C(this);if(C.fn.metadata){K=J.metadata({type:"class"})}if(!H){N=J.data(A);if(!N){N={};J.data(A,N)}C.extend(true,M,D,F,K[A]||K||{});N.options=M}else{N=J.data(A);if(N){M=N.options}else{return }}if(J.is("input[type=text],input[type=number],input[type=date],textarea")){J.keypress(function(Q){var O=true;if(!(Q.metaKey&&M.allowMetaKey)){if(C.inArray(Q.keyCode,M.allowKeys)==-1){var P=String.fromCharCode(Q.which);if(!P.match(M.reAllow)){O=false}}}if(!O){Q.preventDefault()}return true});J.keyup(function(O){if(C.inArray(O.keyCode,M.allowKeys)==-1){C.each(M.convert,function(P,Q){J.val(J.val().replace(P,Q))});if(M.lowercase){J.val(J.val().toLowerCase())}else{if(M.uppercase){J.val(J.val().toUpperCase())}}}return true});J.focus(function(O){N.focusval=J.val()});J.blur(function(O){if(J.val()!=N.focusval){J.trigger("change")}})}});return G};var B=C.fn[A];B.KEY_DEL=8;B.KEY_ALT=18;B.KEY_CMD=224;B.KEY_ENTER=13;B.KEY_SHIFT=16;B.KEY_TAB=9;B.KEY_RIGHT=39;B.KEY_UP=38;B.KEY_DOWN=40;B.KEY_LEFT=37;B.defaults=D;B.defaults.allowKeys=[B.KEY_DEL,B.KEY_SHIFT,B.KEY_ENTER,B.KEY_ALT,B.KEY_TAB,B.KEY_RIGHT,B.KEY_LEFT,B.KEY_UP,B.KEY_DOWN]})(jQuery);var sprintf=(function(){function A(D){return Object.prototype.toString.call(D).slice(8,-1).toLowerCase()}function B(E,F){for(var D=[];F>0;D[--F]=E){}return D.join("")}var C=function(){if(!C.cache.hasOwnProperty(arguments[0])){C.cache[arguments[0]]=C.parse(arguments[0])}return C.format.call(null,C.cache[arguments[0]],arguments)};C.format=function(K,J){var O=1,M=K.length,G="",P,D=[],H,F,I,E,L,N;for(H=0;H<M;H++){G=A(K[H]);if(G==="string"){D.push(K[H])}else{if(G==="array"){I=K[H];if(I[2]){P=J[O];for(F=0;F<I[2].length;F++){if(!P.hasOwnProperty(I[2][F])){throw (sprintf('[sprintf] property "%s" does not exist',I[2][F]))}P=P[I[2][F]]}}else{if(I[1]){P=J[I[1]]}else{P=J[O++]}}if(/[^s]/.test(I[8])&&(A(P)!="number")){throw (sprintf("[sprintf] expecting number but found %s",A(P)))}switch(I[8]){case"b":P=P.toString(2);break;case"c":P=String.fromCharCode(P);break;case"d":P=parseInt(P,10);break;case"e":P=I[7]?P.toExponential(I[7]):P.toExponential();break;case"f":P=I[7]?parseFloat(P).toFixed(I[7]):parseFloat(P);break;case"o":P=P.toString(8);break;case"s":P=((P=String(P))&&I[7]?P.substring(0,I[7]):P);break;case"u":P=Math.abs(P);break;case"x":P=P.toString(16);break;case"X":P=P.toString(16).toUpperCase();break}P=(/[def]/.test(I[8])&&I[3]&&P>=0?"+"+P:P);L=I[4]?I[4]=="0"?"0":I[4].charAt(1):" ";N=I[6]-String(P).length;E=I[6]?B(L,N):"";D.push(I[5]?P+E:E+P)}}}return D.join("")};C.cache={};C.parse=function(D){var G=D,H=[],J=[],I=0;while(G){if((H=/^[^\x25]+/.exec(G))!==null){J.push(H[0])}else{if((H=/^\x25{2}/.exec(G))!==null){J.push("%")}else{if((H=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(G))!==null){if(H[2]){I|=1;var K=[],F=H[2],E=[];if((E=/^([a-z_][a-z_\d]*)/i.exec(F))!==null){K.push(E[1]);while((F=F.substring(E[0].length))!==""){if((E=/^\.([a-z_][a-z_\d]*)/i.exec(F))!==null){K.push(E[1])}else{if((E=/^\[(\d+)\]/.exec(F))!==null){K.push(E[1])}else{throw ("[sprintf] huh?")}}}}else{throw ("[sprintf] huh?")}H[2]=K}else{I|=2}if(I===3){throw ("[sprintf] mixing positional and named placeholders is not (yet) supported")}J.push(H)}else{throw ("[sprintf] huh?")}}}G=G.substring(H[0].length)}return J};return C})();var vsprintf=function(B,A){A.unshift(B);return sprintf.apply(null,A)};
/*
  tabs plug-in for jQuery, License - MIT, Copyright: 2009 Traversal - http://traversal.com.au
*/
(function(B){var C={selector:"a",classNameCurrent:"current",classNameAfterCurrent:"after-current",classNameBeforeCurrent:"before-current",classNamePanelCurrent:"current",index:"derive",allowUnselect:false,event:"click",show:"show",showOptions:{effect:"fade",duration:0},hide:"hide",hideOptions:{effect:"fade",duration:0}};var A="mp_tabs";B.fn.mp_tabs=function(){var F,E={},G={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){F=D[0]}else{E=D[0]}if(D.length>=2){G=D[1]}}return this.each(function(){var R,I=G,J={},S={},L=B(this);if(B.fn.metadata){S=L.metadata({type:"class"})}if(!F){R=L.data(A);if(!R){R={};L.data(A,R)}B.extend(true,J,C,E,S[A]||S||{});R.options=J}else{R=L.data(A);if(R){J=R.options}else{return }}if(F){R.edata={tab:R.tab,panel:R.panel,panelOld:R.panelOld,tabOld:R.tabOld}}if(!F){R.tabs=L.find(J.selector);R.panels=R.tabs.tabPanels();R.index=-1;R.animating=false;R.tabOld=R.panelOld=R.tab=R.panel=B([]);if(J.index=="derive"){R.index=R.tabs.index(R.tabs.filter("."+J.classNameCurrent).eq(0))}else{if(J.index!=null&&J.index<R.tabs.length&&J.index>=0){R.index=J.index}}R.panels.hide();R.handleEvent=function(V){if(!R.animating){var U=R.tabs.index(B(this));if(J.event=="click"&&R.index!=-1&&R.index==U&&J.allowUnselect){L.mp_tabs("unselect")}else{R.indexPrevious=R.index;R.index=U;L.mp_tabs("update")}}if(J.event=="click"&&!J.allowDefault){V.preventDefault()}};if(J.event=="click"){R.tabs.click(R.handleEvent)}else{if(J.event=="mouseenter"){R.tabs.mouseenter(R.handleEvent)}}if(R.index!=-1){L.mp_tabs("update")}}else{if(F=="update"){var P=function(){R.animating=false;O();R.panel.addClass(J.classNamePanelCurrent);if(J.showOptions.complete){J.showOptions.complete()}};var O=function(){L.trigger("afterchange.mp_tabs",[R.edata]);if(I.unselect){L.trigger("afterunselect.mp_tabs",[R.edata])}};var K=function(){if(R.panelOld){R.panelOld.removeClass(J.classNamePanelCurrent)}if(J.hideOptions.complete){J.hideOptions.complete()}if(R.index==-1){R.animating=false;O()}else{T()}if(I.unselect){R.tab=B();R.index=-1}};var T=function(){if(R.index!=-1){R.tab.addClass(J.classNameCurrent);if(R.index>0){R.tabs.eq(R.index-1).addClass(J.classNameBeforeCurrent)}if(R.index<R.tabs.length-1){R.tabs.eq(R.index+1).addClass(J.classNameAfterCurrent)}R.panel[J.show](B.extend(true,{complete:P},J.showOptions))}else{R.animating=false}};R.edata.tabOld=R.tab;R.edata.panelOld=R.panelOld=R.panel;var H=true;if(R.index!=-1){R.st=R.tabs.eq(R.index);if(R.st.length){R.sp=R.st.tabPanels()}}if(true){R.animating=true;R.edata.panel=R.sp;R.edata.tab=R.st;R.tabs.removeClass(J.classNameCurrent).removeClass(J.classNameAfterCurrent).removeClass(J.classNameBeforeCurrent);if(I.unselect){var Q=jQuery.Event("beforeunselect.mp_tabs");L.trigger(Q,[R.edata]);H=H&&(Q.result!==false)}else{var Q=jQuery.Event("beforechange.mp_tabs");L.trigger(Q,[R.edata])}H=H&&(Q.result!==false);if(H!==false){R.tab=R.st;R.panel=R.sp;if(R.panelOld.length){R.panelOld[J.hide](B.extend(true,{complete:K},J.hideOptions))}else{if(R.panel&&R.panel.length){T()}}}}}else{if(F=="select"||F=="to"){if(!R.animating){R.indexPrevious=R.index;if(I.el){var M=B(I.el);if(M.length){var N=R.tabs.index(M);if(N!=-1){R.index=N;L.mp_tabs("update",I)}else{var N=R.panels.index(M);if(N!=-1){R.index=N;L.mp_tabs("update",I)}}}}else{if(I.index!==null){if(I.index=="first"){I.index=0}else{if(I.index=="last"){I.index=R.tabs.length-1}}if(I.index>=0){R.index=I.index;L.mp_tabs("update",I)}}}}}else{if(F=="unselect"){if(!R.animating){R.indexPrevious=R.index;R.index=-1;L.mp_tabs("update",B.extend(true,{},I,{unselect:true}))}}else{if(F=="destroy"){if(J.event=="click"){R.tabs.unbind("click",R.handleEvent)}else{if(J.event=="hover"){R.tabs.unbind("mouseenter",R.handleEvent)}}L.removeData("tabs")}}}}}})};B.fn.tabPanels=function(){return this.map(function(F,E){var G=this;var D;var H;if(B.fn.metadata){H=B(this).metadata({type:"class"}).target}if(H){D=B(H)}else{D=B(B(this).attr("href"))}if(D.length){return D.get(0)}})};B.fn.mp_tabs.defaults=C})(jQuery);(function(B){var C={maxWidth:1000,minWidth:20,comfortZone:20};var A="autoGrowInput";B.fn[A]=function(){var F=this,G=this,H,E={},I={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){H=D[0]}else{E=D[0]}if(D.length>=2){I=D[1]}}if(this.length){this.filter("input:text").each(function(){var S,P,Q,K=I,M={},R={},N=B(this);if(B.fn.metadata){R=N.metadata({type:"class"})}if(!H){Q=N.data(A);if(!Q){Q={};N.data(A,Q)}B.extend(true,M,C,E,R[A]||R||{});Q.options=M}else{Q=N.data(A);if(Q){M=Q.options}else{return }}S=function(){N[A].apply(N,arguments)};P=function(U,T){return N.trigger(jQuery.Event(U+"."+A),B.isArray(T)?T:[T])!==false};if(!H){var J=M.minWidth||N.width(),O="",L=B("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:N.css("fontSize"),fontFamily:N.css("fontFamily"),fontWeight:N.css("fontWeight"),letterSpacing:N.css("letterSpacing"),whiteSpace:"nowrap"});Q.check=function(){if(O===(O=N.val())){return }var X=O.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");L.html(X);var V=L.width(),W=(V+M.comfortZone)>=J?V+M.comfortZone:J,U=N.width(),T=(W<U&&W>=J)||(W>J&&W<M.maxWidth);if(T){N.width(W)}};L.insertAfter(N);B(this).bind("keyup keydown blur update",Q.check)}else{if(H=="update"){Q.check()}else{if(H=="destroy"){N.data(A,null)}}}})}return F};B.fn[A].defaults=C})(jQuery);
/*
  linkify plug-in for jQuery, License - MIT, Copyright: 2010 Traversal - <http://traversal.com.au>
*/
(function(B){var C={target:"_self",cursor:"pointer",selectorLink:"a:first",selectorNoClosest:"a",cn:{hover:"hover",active:"active"}};var A="linkify";B.fn[A]=function(){var F,E={},G={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){F=D[0]}else{E=D[0]}if(D.length>=2){G=D[1]}}return this.each(function(){var L,J=G,K={},I={},H=B(this);if(B.fn.metadata){I=H.metadata({type:"class"})}if(!F){L=H.data(A);if(!L){L={};H.data(A,L)}B.extend(true,K,C,E,I[A]||I||{});L.options=K}else{L=H.data(A);if(L){K=L.options}else{return }}if(!F){L.href=K.href;if(!L.href){if(K.selectorLink){L.href=H.find(K.selectorLink).attr("href")}}if(L.href){L.click=function(M){var N=B(M.target).closest(K.selectorNoClosest);if(N.length==0){if(K.target=="_blank"){window.open(K.href)}else{if(K.target=="_top"){top.location.href=L.href}else{location.href=L.href}}M.stopPropagation()}};L.mouseenter=function(M){H.addClass(K.cn.hover);H.trigger("linkify.mouseenter")};L.mouseleave=function(M){H.removeClass(K.cn.hover);H.trigger("linkify.mouseleave")};L.mousedown=function(M){H.addClass(K.cn.active);H.trigger("linkify.mousedown")};L.mouseup=function(M){H.removeClass(K.cn.active);H.trigger("linkify.mouseup")};if(K.cursor){H.css({cursor:K.cursor})}H.click(L.click);if(K.cn.hover){H.mouseenter(L.mouseenter);H.mouseleave(L.mouseleave)}if(K.cn.active){H.mousedown(L.mousedown);H.mouseup(L.mouseup)}}}else{if(F=="destroy"){H.data(A,null);H.unbind("click",L.click);if(K.cn.hover){H.unbind("mouseenter",L.mouseenter);H.unbind("mouseleave",L.mouseleave)}if(K.cn.active){H.unbind("mousedown",L.mousedown);H.unbind("mouseup",L.mouseup)}}}})};B.fn[A].defaults=C})(jQuery);
/*
  inputmask plug-in for jQuery, License - MIT, Copyright: 2010 Traversal - <http://traversal.com.au>
*/
(function(C){var D={reAllow:/[A-Za-z0-9\_\-\s]/,convert:{"-":"_"," ":"_","&":"","%":""},lowercase:true,uppercase:false,allowMetaKey:true};var A="inputmask";C.fn[A]=function(){var H,G=this,F={},I={},E=arguments;if(E.length>=1){if(typeof (E[0])=="string"){H=E[0]}else{F=E[0]}if(E.length>=2){I=E[1]}}this.each(function(){var N,L=I,M={},K={},J=C(this);if(C.fn.metadata){K=J.metadata({type:"class"})}if(!H){N=J.data(A);if(!N){N={};J.data(A,N)}C.extend(true,M,D,F,K[A]||K||{});N.options=M}else{N=J.data(A);if(N){M=N.options}else{return }}if(J.is("input[type=text],input[type=number],input[type=date],textarea")){J.keypress(function(Q){var O=true;if(!(Q.metaKey&&M.allowMetaKey)){if(C.inArray(Q.keyCode,M.allowKeys)==-1){var P=String.fromCharCode(Q.which);if(!P.match(M.reAllow)){O=false}}}if(!O){Q.preventDefault()}return true});J.keyup(function(O){if(C.inArray(O.keyCode,M.allowKeys)==-1){C.each(M.convert,function(P,Q){J.val(J.val().replace(P,Q))});if(M.lowercase){J.val(J.val().toLowerCase())}else{if(M.uppercase){J.val(J.val().toUpperCase())}}}return true});J.focus(function(O){N.focusval=J.val()});J.blur(function(O){if(J.val()!=N.focusval){J.trigger("change")}})}});return G};var B=C.fn[A];B.KEY_DEL=8;B.KEY_ALT=18;B.KEY_CMD=224;B.KEY_ENTER=13;B.KEY_SHIFT=16;B.KEY_TAB=9;B.KEY_RIGHT=39;B.KEY_UP=38;B.KEY_DOWN=40;B.KEY_LEFT=37;B.defaults=D;B.defaults.allowKeys=[B.KEY_DEL,B.KEY_SHIFT,B.KEY_ENTER,B.KEY_ALT,B.KEY_TAB,B.KEY_RIGHT,B.KEY_LEFT,B.KEY_UP,B.KEY_DOWN]})(jQuery);(function(B){var A={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(F){for(var C=0;C<F.length;C++){var D=F[C].string;var E=F[C].prop;this.versionSearchString=F[C].versionSearch||F[C].identity;if(D){if(D.indexOf(F[C].subString)!=-1){return F[C].identity}}else{if(E){return F[C].identity}}}},searchVersion:function(D){var C=D.indexOf(this.versionSearchString);if(C==-1){return }return parseFloat(D.substring(C+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"opera"},{string:navigator.vendor,subString:"iCab",identity:"icab"},{string:navigator.vendor,subString:"KDE",identity:"konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"firefox"},{string:navigator.vendor,subString:"Camino",identity:"camino"},{string:navigator.userAgent,subString:"Netscape",identity:"netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"windows"},{string:navigator.platform,subString:"Mac",identity:"mac"},{string:navigator.userAgent,subString:"iPhone",identity:"ios"},{string:navigator.platform,subString:"Linux",identity:"linux"}]};A.init();B.client={os:A.OS,browser:A.browser}})(jQuery);(function(A){A.fn.limitMaxlength=function(C){var F=A.extend({maxlength:100,onLimit:function(){},onEdit:function(){}},C);var B=A(this);var E=parseInt(C.maxlength);var G;var D=function(){G=B.val();if(G.length>E){B.val(G.substr(0,E));A.proxy(F.onLimit,this)()}A.proxy(F.onEdit,this)(Math.max(0,E-G.length))};this.each(D);return this.keydown(D).focus(D).live("input paste",D)}})(jQuery);(function(E){var F={min:0,max:null,step:1,format:"0",valEmpty:"",cnUpDisabled:"disabled",cnDownDisabled:"disabled",cnUpActive:"active",cnDownActive:"active",cnNegative:"negative",arrowKeys:true,arrowFlashButton:true,arrowFlashTimeout:100,repeatOnMouseDown:true,repeatDelay:400,repeatInterval:100,restrictInput:true,reAllow:/[\$\.\,0-9]/,reAllowNegative:/[\$\.\,0-9\-]/};var B="inputspinner";var A=38;var C=40;var D=function(J,I){var H=J.attr(I);if(H&&H!=""){return parseFloat(H)}return NaN};var G=function(H){return H!=""&&H!==false&&H!==null&&!isNaN(H)};E.fn[B]=function(){var J=this,K=this,L,I={},M={},H=arguments;if(H.length>=1){if(typeof (H[0])=="string"){L=H[0]}else{I=H[0]}if(H.length>=2){M=H[1]}}if(this.length){this.each(function(){var a,Z,m,b=M,c={},u={},O=E(this);if(E.fn.metadata){u=O.metadata({type:"class"})}if(!L){m=O.data(B);if(!m){m={};O.data(B,m)}E.extend(true,c,F,I,u[B]||u||{});m.options=c}else{m=O.data(B);if(m){c=m.options}else{return }}a=function(){O[B].apply(O,arguments)};Z=function(o,e){if(!b.silent){var d=jQuery.Event(o+"."+B);O.trigger(d,E.isArray(e)?e:[e]);return d.result!==false}return true};var g=function(d,e){if(d&&d.length){d.addClass(e);if(m.ft){clearTimeout(m.ft)}m.ft=setTimeout(function(){d.removeClass(e)},c.arrowFlashTimeout)}};var W=function(){if(m.readonly||m.disabled){m.up.addClass(c.cnUpDisabled);m.down.addClass(c.cnDownDisabled)}else{m.up.removeClass(c.cnUpDisabled);m.down.removeClass(c.cnDownDisabled);if(m.down&&c.cnDownDisabled){if(P(m.val)){m.down.addClass(c.cnDownDisabled)}else{m.down.removeClass(c.cnDownDisabled)}}if(m.up&&c.cnUpDisabled){if(Q(m.val)){m.up.addClass(c.cnUpDisabled)}else{m.up.removeClass(c.cnUpDisabled)}}if(c.cnUpDisabled&&Q(m.val)){m.up.addClass(c.cnUpDisabled)}}};var Q=function(d){if(c.atMax){return c.atMax(O,d,m.max)}else{return G(m.max)&&d>=m.max}};var P=function(d){if(c.atMin){return c.atMin(O,d,m.min)}else{return G(m.min)&&d<=m.min}};var V=function(){if(c.getVal){return c.getVal(O)}else{return E[B].parse(O.val())}};var N=function(d){if(c.setVal){c.setVal(O,d)}else{if(c.format){O.val(E[B].format(d,c.format))}else{O.val(d)}if(d<0&&c.cnNegative){O.addClass(c.cnNegative)}else{if(d>=0&&c.cnNegative){O.removeClass(c.cnNegative)}}}};var q=function(d){if(c.setVal){c.clearVal(O,d)}else{O.val(c.valEmpty)}m.val=O.val()};var X=function(d){if(c.decrement){return c.decrement(d)}else{return d-m.step}};var s=function(d){if(c.increment){return c.increment(d)}else{return d+m.step}};if(!L){m.count=0;var h=D(O,"min");if(G(h)){m.min=h}else{m.min=c.min}var j=D(O,"max");if(G(j)){m.max=j}else{m.max=c.max}var S=D(O,"step");if(G(S)){m.step=E[B].parse(S)}else{m.step=E[B].parse(c.step)}if(!G(m.step)){m.step=1}var n=function(){clearTimeout(m.to);m.to=null;m.count=0};var U=function(){a("down");if(m.to){clearTimeout(m.to)}if(!P(m.val)){m.count++;m.to=setTimeout(U,Math.max(c.repeatInterval-(m.count*5),2))}};var Y=function(){a("up");if(m.to){clearTimeout(m.to)}if(!Q(m.val)){m.count++;m.to=setTimeout(Y,Math.max(c.repeatInterval-(m.count*5),2))}};try{if(c.up){m.up=E(c.up);m.up.click(function(){a("up");n()});if(c.repeatOnMouseDown){m.up.mouseleave(n);m.up.mouseup(n);m.up.mousedown(function(){m.to=setTimeout(Y,c.repeatDelay)})}}if(c.down){m.down=E(c.down);m.down.click(function(){a("down");n()});if(c.repeatOnMouseDown){m.down.mouseleave(n);m.down.mouseup(n);m.down.mousedown(function(){m.to=setTimeout(U,c.repeatDelay)})}}if(c.arrowKeys){O.keydown(function(d){if(d.which==A){if(c.arrowFlashButton){g(m.up,c.cnUpActive)}a("up");return false}else{if(d.which==C){if(c.arrowFlashButton){g(m.down,c.cnDownActive)}a("down");return false}}return true})}if(O.attr("readonly")=="readonly"){a("readonly",true)}if(O.attr("disabled")=="disabled"){a("disabled",true)}}catch(l){alert(l)}if(c.restrictInput&&E.fn.inputmask){var f=c.reAllow;if(m.min<0){f=c.reAllowNegative}O.inputmask({reAllow:f,convert:null})}O.change(function(){m.val=V();if(c.min!=null&&P(m.val)){N(c.min)}if(c.max!=null&&Q(m.val)){N(c.max)}W()});m.val=V();if(m.val!=null&&m.val!=""&&c.format){O.val(E[B].format(m.val,c.format))}W()}else{if(L=="up"){if(!m.disabled&&!m.readonly){if(!Q(m.val)){var T=V();var k=s(T);if(c.max!=null&&Q(k)){k=c.max}var R={oldVal:T,newVal:k,val:k};if(Z("beforeup",R)&&Z("beforechange",R)){N(k);m.val=k;Z("afterup",R);Z("afterchange",R);W()}}}}else{if(L=="down"){if(!m.disabled&&!m.readonly){if(!P(m.val)){var T=V();var k=X(T);if(c.min!=null&&P(k)){k=c.min}var R={oldVal:T,newVal:k,val:k};if(Z("beforedown",R)&&Z("beforechange",R)){N(k);m.val=k;Z("afterdown",R);Z("afterchange",R);W()}}}}else{if(L=="readonly"){m.readonly=b;W()}else{if(L=="disabld"){m.disabled=b;W()}else{if(L=="update"){m.val=V();W()}else{if(L=="clear"){q(c.emptyVal);W()}else{if(L=="destroy"){O.data(B,null)}}}}}}}}})}return J};E.fn[B].defaults=F;E[B]={};E[B].repeat=function(K,J){var H="";for(var I=0;I<J;I++){H+=K}return H};E[B].leadingZero=function(I,H){return E[B].repeat("0",(H||2)-I.toString().length)+I.toString()};E[B].parse=function(J,K){var H;K=K||0;if(J.toString()){J=J.toString()}if(J){var I=J.replace(/[^0-9\.\+\-]/ig,"");var H=parseFloat(I)}if(isNaN(H)){return K}return H};E[B].stringOfChar=function(J,I){var H="";for(i=0;i<I;i++){H+=J}return H};E[B].format=function(K,X){var H;var M="";var Q="";var L;var S=Math.abs(K);var Y=Math.floor(S);var V=X;var T=false;var J=V.match(/\((.*?)\)/,"ig");if(J&&J.length>0){T=true;V=J[1]}var P=V;var R=V.split(".");if(R.length>1){S=S.toFixed(R[1].length);P=R[0]}else{Y=Math.round(S)}H=S.toString();if(R.length>1){M="."+H.split(".")[1]}L=Math.abs(Y).toString();var O=0;E.each(P.split(""),function(a,b){if(b=="#"||b=="0"){O++}});J=P.match(/[^#0,]*?([#0,]+)[^#0,]*?/);if(J.length>1){P=P.replace(J[1],E[B].stringOfChar("#",L.length-O)+J[1])}var I=P.split("");var Z=L.length-1;for(var W=I.length-1;W>=0;W--){var U=I[W];var N=Math.pow(10,L.length-1-Z);if(U=="#"){if(Y>=N){Q=L.substr(Z,1)+Q}Z=Z-1}else{if(U=="0"){if(Y>=N){Q=L.substr(Z,1)+Q}else{Q="0"+Q}Z=Z-1}else{if(U==","){if(Y>=N){Q=U+Q}}else{Q=U+Q}}}}if(K<0){if(T){return"("+Q+M+")"}else{return"-"+Q+M}}return(Q+M)}})(jQuery);var qq=qq||{};qq.extend=function(B,A){for(var C in A){B[C]=A[C]}};qq.indexOf=function(B,C,D){if(B.indexOf){return B.indexOf(C,D)}D=D||0;var A=B.length;if(D<0){D+=A}for(;D<A;D++){if(D in B&&B[D]===C){return D}}return -1};qq.getUniqueId=(function(){var A=0;return function(){return A++}})();qq.attach=function(A,C,B){if(A.addEventListener){A.addEventListener(C,B,false)}else{if(A.attachEvent){A.attachEvent("on"+C,B)}}};qq.detach=function(A,C,B){if(A.removeEventListener){A.removeEventListener(C,B,false)}else{if(A.attachEvent){A.detachEvent("on"+C,B)}}};qq.preventDefault=function(A){if(A.preventDefault){A.preventDefault()}else{A.returnValue=false}};qq.insertBefore=function(B,A){A.parentNode.insertBefore(B,A)};qq.remove=function(A){A.parentNode.removeChild(A)};qq.contains=function(B,A){if(B==A){return true}if(B.contains){return B.contains(A)}else{return !!(A.compareDocumentPosition(B)&8)}};qq.toElement=(function(){var A=document.createElement("div");return function(C){A.innerHTML=C;var B=A.firstChild;A.removeChild(B);return B}})();qq.css=function(A,B){if(B.opacity!=null){if(typeof A.style.opacity!="string"&&typeof (A.filters)!="undefined"){B.filter="alpha(opacity="+Math.round(100*B.opacity)+")"}}qq.extend(A.style,B)};qq.hasClass=function(B,A){var C=new RegExp("(^| )"+A+"( |$)");return C.test(B.className)};qq.addClass=function(B,A){if(!qq.hasClass(B,A)){B.className+=" "+A}};qq.removeClass=function(B,A){var C=new RegExp("(^| )"+A+"( |$)");B.className=B.className.replace(C," ").replace(/^\s+|\s+$/g,"")};qq.setText=function(A,B){A.innerText=B;A.textContent=B};qq.children=function(B){var A=[],C=B.firstChild;while(C){if(C.nodeType==1){A.push(C)}C=C.nextSibling}return A};qq.getByClass=function(D,E){if(D.querySelectorAll){return D.querySelectorAll("."+E)}var B=[];var F=D.getElementsByTagName("*");var A=F.length;for(var C=0;C<A;C++){if(qq.hasClass(F[C],E)){B.push(F[C])}}return B};qq.obj2url=function(F,B,H){var G=[],D="&",E=function(J,I){var K=B?(/\[\]$/.test(B))?B:B+"["+I+"]":I;if((K!="undefined")&&(I!="undefined")){G.push((typeof J==="object")?qq.obj2url(J,K,true):(Object.prototype.toString.call(J)==="[object Function]")?encodeURIComponent(K)+"="+encodeURIComponent(J()):encodeURIComponent(K)+"="+encodeURIComponent(J))}};if(!H&&B){D=(/\?/.test(B))?(/\?$/.test(B))?"":"&":"?";G.push(B);G.push(qq.obj2url(F))}else{if((Object.prototype.toString.call(F)==="[object Array]")&&(typeof F!="undefined")){for(var C=0,A=F.length;C<A;++C){E(F[C],C)}}else{if((typeof F!="undefined")&&(F!==null)&&(typeof F==="object")){for(var C in F){E(F[C],C)}}else{G.push(encodeURIComponent(B)+"="+encodeURIComponent(F))}}}return G.join(D).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(A){this._options={debug:false,action:"/server/upload",params:{},button:null,multiple:true,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(C,B){},onProgress:function(E,D,B,C){},onComplete:function(D,C,B){},onCancel:function(C,B){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(B){alert(B)}};qq.extend(this._options,A);this._filesInProgress=0;this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FileUploaderBasic.prototype={setParams:function(A){this._options.params=A},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(B){var A=this;return new qq.UploadButton({element:B,name:this._options.inputName||"file",multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(C){A._onInputChange(C)}})},_createUploadHandler:function(){var A=this,C;if(qq.UploadHandlerXhr.isSupported()){C="UploadHandlerXhr"}else{C="UploadHandlerForm"}var B=new qq[C]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(G,F,D,E){A._onProgress(G,F,D,E);A._options.onProgress(G,F,D,E)},onComplete:function(F,E,D){A._onComplete(F,E,D);A._options.onComplete(F,E,D)},onCancel:function(E,D){A._onCancel(E,D);A._options.onCancel(E,D)}});return B},_preventLeaveInProgress:function(){var A=this;qq.attach(window,"beforeunload",function(B){if(!A._filesInProgress){return }var B=B||window.event;B.returnValue=A._options.messages.onLeave;return A._options.messages.onLeave})},_onSubmit:function(B,A){this._filesInProgress++},_onProgress:function(D,C,A,B){},_onComplete:function(C,B,A){this._filesInProgress--;if(A.error){this._options.showMessage(A.error)}},_onCancel:function(B,A){this._filesInProgress--},_onInputChange:function(A){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(A.files)}else{if(this._validateFile(A)){this._uploadFile(A)}}this._button.reset()},_uploadFileList:function(B){for(var A=0;A<B.length;A++){if(!this._validateFile(B[A])){return }}for(var A=0;A<B.length;A++){this._uploadFile(B[A])}},_uploadFile:function(A){var C=this._handler.add(A);var B=this._handler.getName(C);if(this._options.onSubmit(C,B)!==false){this._onSubmit(C,B);this._handler.upload(C,this._options.params)}},_validateFile:function(C){var A,B;if(C.value){A=C.value.replace(/.*(\/|\\)/,"")}else{A=C.fileName!=null?C.fileName:C.name;B=C.fileSize!=null?C.fileSize:C.size}if(!this._isAllowedExtension(A)){this._error("typeError",A);return false}else{if(B===0){this._error("emptyError",A);return false}else{if(B&&this._options.sizeLimit&&B>this._options.sizeLimit){this._error("sizeError",A);return false}else{if(B&&B<this._options.minSizeLimit){this._error("minSizeError",A);return false}}}}return true},_error:function(C,D){var B=this._options.messages[C];function A(E,F){B=B.replace(E,F)}A("{file}",this._formatFileName(D));A("{extensions}",this._options.allowedExtensions.join(", "));A("{sizeLimit}",this._formatSize(this._options.sizeLimit));A("{minSizeLimit}",this._formatSize(this._options.minSizeLimit));this._options.showMessage(B)},_formatFileName:function(A){if(A.length>33){A=A.slice(0,19)+"..."+A.slice(-13)}return A},_isAllowedExtension:function(D){var B=(-1!==D.indexOf("."))?D.replace(/.*[.]/,"").toLowerCase():"";var C=this._options.allowedExtensions;if(!C.length){return true}for(var A=0;A<C.length;A++){if(C[A].toLowerCase()==B){return true}}return false},_formatSize:function(A){var B=-1;do{A=A/1024;B++}while(A>99);return Math.max(A,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][B]}};qq.FileUploader=function(A){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',ids:{},classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}});qq.extend(this._options,A);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,"button"));this._bindCancelEvent();this._setupDragDrop()};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype);qq.extend(qq.FileUploader.prototype,{_find:function(C,B){if(this._options.ids[B]){var A=document.getElementById(this._options.ids[B])}else{var A=qq.getByClass(C,this._options.classes[B])[0]}return A},_setupDragDrop:function(){var B=this,C=this._find(this._element,"drop");if(C){var A=new qq.UploadDropZone({element:C,onEnter:function(D){qq.addClass(C,B._classes.dropActive);D.stopPropagation()},onLeave:function(D){D.stopPropagation()},onLeaveNotDescendants:function(D){qq.removeClass(C,B._classes.dropActive)},onDrop:function(D){C.style.display="none";qq.removeClass(C,B._classes.dropActive);B._uploadFileList(D.dataTransfer.files)}});C.style.display="none";qq.attach(document,"dragenter",function(D){if(!A._isValidFileDrag(D)){return }C.style.display="block"});window.qq_doc_click_handler=function(){C.style.display="none"};qq.attach(document,"click",window.qq_doc_click_handler);qq.attach(document,"dragleave",function(E){if(!A._isValidFileDrag(E)){return }var D=document.elementFromPoint(E.clientX,E.clientY);if(!D||D.nodeName=="HTML"||D.id=="wpadminbar"||D.id=="wpwrap"){C.style.display="none"}})}},_onSubmit:function(B,A){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(B,A)},_onProgress:function(G,F,A,D){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var C=this._getItemByFileId(G);var B=this._find(C,"size");B.style.display="inline";var E;if(A!=D){E=Math.round(A/D*100)+"% from "+this._formatSize(D)}else{E=this._formatSize(D)}qq.setText(B,E)},_onComplete:function(D,C,A){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var B=this._getItemByFileId(D);qq.remove(this._find(B,"cancel"));qq.remove(this._find(B,"spinner"));if(A.success){qq.addClass(B,this._classes.success)}else{qq.addClass(B,this._classes.fail)}},_addToList:function(D,C){var A=qq.toElement(this._options.fileTemplate);A.qqFileId=D;var B=this._find(A,"file");qq.setText(B,this._formatFileName(C));this._find(A,"size").style.display="none";this._listElement.appendChild(A)},_getItemByFileId:function(B){var A=this._listElement.firstChild;while(A){if(A.qqFileId==B){return A}A=A.nextSibling}},_bindCancelEvent:function(){var A=this,B=this._listElement;qq.attach(B,"click",function(E){E=E||window.event;var D=E.target||E.srcElement;if(qq.hasClass(D,A._classes.cancel)){qq.preventDefault(E);var C=D.parentNode;A._handler.cancel(C.qqFileId);qq.remove(C)}})}});qq.UploadDropZone=function(A){this._options={element:null,onEnter:function(B){},onLeave:function(B){},onLeaveNotDescendants:function(B){},onDrop:function(B){}};qq.extend(this._options,A);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};qq.UploadDropZone.prototype={_disableDropOutside:function(A){if(!qq.UploadDropZone.dropOutsideDisabled){qq.attach(document,"dragover",function(B){if(B.dataTransfer){B.dataTransfer.dropEffect="none";B.preventDefault()}});qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var A=this;qq.attach(A._element,"dragover",function(C){if(!A._isValidFileDrag(C)){return }var B=C.dataTransfer.effectAllowed;if(B=="move"||B=="linkMove"){C.dataTransfer.dropEffect="move"}else{C.dataTransfer.dropEffect="copy"}C.stopPropagation();C.preventDefault()});qq.attach(A._element,"dragenter",function(B){if(!A._isValidFileDrag(B)){return }A._options.onEnter(B)});qq.attach(A._element,"dragleave",function(C){if(!A._isValidFileDrag(C)){return }A._options.onLeave(C);var B=document.elementFromPoint(C.clientX,C.clientY);if(qq.contains(this,B)){return }A._options.onLeaveNotDescendants(C)});qq.attach(A._element,"dragend",function(B){A._element.style.display="none"});qq.attach(A._element,"drop",function(B){if(!A._isValidFileDrag(B)){return }jQuery(A._element).trigger("dragend");B.preventDefault();A._options.onDrop(B)})},_isValidFileDrag:function(C){var B=C.dataTransfer,A=navigator.userAgent.indexOf("AppleWebKit")>-1;return B&&B.effectAllowed!="none"&&(B.files||(!A&&B.types.contains&&B.types.contains("Files")))}};qq.UploadButton=function(A){this._options={element:null,multiple:false,name:"file",onChange:function(B){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,A);this._element=this._options.element;qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq.remove(this._input)}qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput()},_createInput:function(){var B=document.createElement("input");if(this._options.multiple){B.setAttribute("multiple","multiple")}B.setAttribute("type","file");B.setAttribute("name",this._options.name);qq.css(B,{position:"absolute",right:0,top:0,fontFamily:"sans-serif",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(B);var A=this;qq.attach(B,"change",function(){A._options.onChange(B)});qq.attach(B,"mouseover",function(){qq.addClass(A._element,A._options.hoverClass)});qq.attach(B,"mouseout",function(){qq.removeClass(A._element,A._options.hoverClass)});qq.attach(B,"focus",function(){qq.addClass(A._element,A._options.focusClass)});qq.attach(B,"blur",function(){qq.removeClass(A._element,A._options.focusClass)});if(window.attachEvent){B.setAttribute("tabIndex","-1")}return B}};qq.UploadHandlerAbstract=function(A){this._options={debug:false,action:"/upload.php",maxConnections:999,onProgress:function(E,D,B,C){},onComplete:function(D,C,B){},onCancel:function(C,B){}};qq.extend(this._options,A);this._queue=[];this._params=[]};qq.UploadHandlerAbstract.prototype={log:function(A){if(this._options.debug&&window.console){console.log("[uploader] "+A)}},add:function(A){},upload:function(D,B){var A=this._queue.push(D);var C={};qq.extend(C,B);this._params[D]=C;if(A<=this._options.maxConnections){this._upload(D,this._params[D])}},cancel:function(A){this._cancel(A);this._dequeue(A)},cancelAll:function(){for(var A=0;A<this._queue.length;A++){this._cancel(this._queue[A])}this._queue=[]},getName:function(A){},getSize:function(A){},getQueue:function(){return this._queue},_upload:function(A){},_cancel:function(A){},_dequeue:function(D){var B=qq.indexOf(this._queue,D);this._queue.splice(B,1);var A=this._options.maxConnections;if(this._queue.length>=A){var C=this._queue[A-1];this._upload(C,this._params[C])}}};qq.UploadHandlerForm=function(A){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(A){A.setAttribute("name","qqfile");var B="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[B]=A;if(A.parentNode){qq.remove(A)}return B},getName:function(A){return this._inputs[A].value.replace(/.*(\/|\\)/,"")},_cancel:function(B){this._options.onCancel(B,this.getName(B));delete this._inputs[B];var A=document.getElementById(B);if(A){A.setAttribute("src","javascript:false;");qq.remove(A)}},_upload:function(G,E){var B=this._inputs[G];if(!B){throw new Error("file with passed id was not added, or already uploaded or cancelled")}var F=this.getName(G);var C=this._createIframe(G);var D=this._createForm(C,E);D.appendChild(B);var A=this;this._attachLoadEvent(C,function(){A.log("iframe loaded");var H=A._getIframeContentJSON(C);A._options.onComplete(G,F,H);A._dequeue(G);delete A._inputs[G];setTimeout(function(){qq.remove(C)},1)});D.submit();qq.remove(D);return G},_attachLoadEvent:function(A,B){qq.attach(A,"load",function(){if(!A.parentNode){return }if(A.contentDocument&&A.contentDocument.body&&A.contentDocument.body.innerHTML=="false"){return }B()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(B){var A=qq.toElement('<iframe src="javascript:false;" name="'+B+'" />');A.setAttribute("id",B);A.style.display="none";document.body.appendChild(A);return A},_createForm:function(A,C){var B=qq.toElement('<form method="post" enctype="multipart/form-data"></form>');var D=qq.obj2url(C,this._options.action);B.setAttribute("action",D);B.setAttribute("target",A.name);B.style.display="none";document.body.appendChild(B);return B}});qq.UploadHandlerXhr=function(A){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var A=document.createElement("input");A.type="file";return("multiple" in A&&typeof File!="undefined"&&typeof (new XMLHttpRequest()).upload!="undefined")};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(A){if(!(A instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}return this._files.push(A)-1},getName:function(B){var A=this._files[B];return A.fileName!=null?A.fileName:A.name},getSize:function(B){var A=this._files[B];return A.fileSize!=null?A.fileSize:A.size},getLoaded:function(A){return this._loaded[A]||0},_upload:function(H,F){var D=this._files[H],B=this.getName(H),C=this.getSize(H);this._loaded[H]=0;var E=this._xhrs[H]=new XMLHttpRequest();var A=this;E.upload.onprogress=function(I){if(I.lengthComputable){A._loaded[H]=I.loaded;A._options.onProgress(H,B,I.loaded,I.total)}};E.onreadystatechange=function(){if(E.readyState==4){A._onComplete(H,E)}};F=F||{};F.qqfile=B;var G=qq.obj2url(F,this._options.action);E.open("POST",G,true);E.setRequestHeader("X-Requested-With","XMLHttpRequest");E.setRequestHeader("X-File-Name",encodeURIComponent(B));E.setRequestHeader("Content-Type","application/octet-stream");E.send(D)},_onComplete:function(id,xhr){if(!this._files[id]){return }var name=this.getName(id);var size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received");this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._options.onComplete(id,name,response)}else{this._options.onComplete(id,name,{})}this._files[id]=null;this._xhrs[id]=null;this._dequeue(id)},_cancel:function(A){this._options.onCancel(A,this.getName(A));this._files[A]=null;if(this._xhrs[A]){this._xhrs[A].abort();this._xhrs[A]=null}}});(function(C){function B(F,H){var I,G,E;if(F===null||F.length<1){return[]}I=F.split(H);for(G=0,E=I.length;G<E;G=G+1){I[G]=C.trim(I[G])}return I}var D={allowClear:true,sortable:true,layout:"float",resultsMinHeight:46,alwaysBelow:true,resultsBuffer:5,dropGap:20,width:"resolve",allowPositionAbove:false};var A="mp_select2";C.fn[A]=function(){var G=this,H=this,I,F={},J={},E=arguments;if(E.length>=1){if(typeof (E[0])=="string"){I=E[0]}else{F=E[0]}if(E.length>=2){J=E[1]}}if(this.length){this.each(function(){var S,R,Z,U=J,V={},a={},K=C(this);if(C.fn.metadata){a=K.metadata({type:"class"})}if(!I){Z=K.data(A);if(!Z){Z={};K.data(A,Z)}C.extend(true,V,D,F,a[A]||a||{});Z.options=V}else{Z=K.data(A);if(Z){V=Z.options}else{return }}S=function(){K[A].apply(K,arguments)};R=function(e,d){return K.trigger(jQuery.Event(e+"."+A),C.isArray(d)?d:[d])!==false};if(I){K=Z.el}if(!I){var N=C.extend({},true,V);delete N.layout;Z.multiple=K.attr("multiple");Z.data=V.data;var L=null;if(K.hasClass("select2-source")){L=[];Z.data=[];Z.data_by_id={};var M=K.find("> option, > optgroup");M.each(function(){var d=C(this);if(d.is("optgroup")){var f={text:d.attr("label"),children:[],cls:d.attr("class")||""};f.selection_prefix=d.data("selection-prefix");d.find("option").each(function(){var k=C(this);var l=k.html();var j={text:l.mp_entity_decode(),id:k.attr("value")||l,parent:f,cls:k.attr("class")||""};if(k.attr("selected")){L.push(j.id)}j=C.extend(j,k.data());f.children.push(j);Z.data_by_id[j.id]=j});Z.data.push(f)}else{var h=d.attr("value");if(h!=""){var g=d.html();var e={text:g.mp_entity_decode(),id:d.attr("value")||g,cls:d.attr("class")||""};e=C.extend(e,d.data());if(d.attr("selected")){L.push(e.id)}Z.data.push(e);Z.data_by_id[e.id]=e}}});var b=K.val();var T=K.data("value-input");var c=C();try{c=C("#"+T)}catch(X){}if(c.length){Z.el=c;L=[];C.each(c.val().split(","),function(d,f){var e=Z.data_by_id[f];if(e!=undefined&&e!=null){L.push(e.id)}})}else{Z.el=C("<input>").attr({type:"hidden",name:K.attr("name").replace(/\[\]$/,"")});Z.el.val(K.val())}Z.el.attr({id:K.attr("id"),"data-placeholder":K.data("placeholder"),style:K.attr("style")});Z.input=Z.el;Z.el.css("width","99%");Z.el.bind("change",function(){K.trigger("change")});if(K.attr("multiple")){N.multiple=true;V.multiple=true}K.attr("id","source-"+K.attr("id"));K.attr("name","source-"+K.attr("name"));Z.el.insertAfter(K);K.hide();var Q=function(d){if(!d.cls){return true}return d.cls.split(" ").indexOf(Z.filter)>0};N.query=function(l){var e=C.trim(l.term);var m=Z.data;var k=[];for(var h=0;h<m.length;h++){var n=m[h];if(e==""&&!Z.filter){k.push(n)}else{if(!n.children&&(e==""||l.matcher(l.term,n.text))){if(Z.filter){if(Q(n)){k.push(n)}}else{k.push(n)}}else{if(n.children){var f=[];for(var g=0;g<n.children.length;g++){var d=n.children[g];if(e==""||l.matcher(l.term,d.text)){if(Z.filter){if(Q(d)){f.push(d)}}else{f.push(d)}}}if(f.length){k.push({text:n.text,children:f})}}}}}l.callback({results:k})};N.initSelection=function(e,g){var f=[];var d=B(e.val(),",");C(d).each(function(h,l){var j=K.find('option[value="'+l+'"]');var k={id:l,text:l,icon:j.data("icon")};f.push(k)});if(!Z.multiple&&f.length){f=f[0]}g(f)}}else{Z.el=K}N.formatResult=function(n,j,h){var l=[];l.push('<div class="result ');if(!n.image){l.push(n.cls)}l.push('">');var k=n.text,d=h.term;var f=k.toUpperCase().indexOf(d.toUpperCase()),m=d.length;if(n.children){l.push(k);l.push("</div>");return l.join("")}if(n.no_image){l.push('<span class="no-image');if(!n.excerpt){l.push(" small")}l.push('">');l.push(n.image);l.push("</span>")}else{if(n.image){l.push("<img ");if(n.image_width){l.push(' width="'+n.image_width+'" ')}if(n.image_height){l.push(' height="'+n.image_height+'" ')}l.push('src="'+n.image+'">')}}if(n.image){l.push('<div class="info">');if(n.excerpt){l.push("<h5>")}else{l.push("<h4>")}}if(n.icon&&!n.image){l.push('<i class="'+n.icon+'"></i>')}if(f<0){l.push('<span class="select2-match">');l.push(k);l.push("</span>")}else{var e=k.substring(f,f+m);l.push(k.substring(0,f));l.push('<span class="select2-match">');var g=C.trim(e).length;if(g){l.push("<b>")}l.push(e);if(g){l.push("</b>")}l.push("</span>");l.push(k.substring(f+m,k.length))}if(n.image){if(n.excerpt){l.push("</h5>")}else{l.push("</h4>")}}if(n.no_excerpt){l.push('<p class="no-excerpt">')}else{if(n.excerpt){l.push("<p>")}}if(n.excerpt){l.push(n.excerpt);l.push("</p>")}if(n.image){l.push("</div>")}l.push("</div>");return l.join("")};N.formatSelection=function(e){if(e){var f=Z.data_by_id?Z.data_by_id[e.id]:e;if(f){var d=[];if(e.icon){d.push('<i class="'+e.icon+'"></i>')}d.push('<span class="text ');d.push(f.cls);d.push('">');if(f.parent&&f.parent.selection_prefix){d.push("<b>");d.push(f.parent.selection_prefix);d.push("</b>")}d.push(f.text);d.push("</span>");return d.join("")}}};Z.el.select2(N);if(N.disabled){Z.el.select2("disable")}if(L){if(V.multiple){Z.el.select2("val",L)}else{if(L.length){Z.el.select2("val",L[0])}}}Z.s2=Z.el.select2("container");var W=Z.el.css("max-width");if(W.match(/\d+px/)){Z.s2.css("max-width",parseInt(W)+"px")}else{Z.s2.css("max-width","580px")}Z.s2.addClass("mp-select2");Z.s2_results=Z.s2.find(".select2-results");Z.s2_search=Z.s2.find(".select2-search");Z.s2_drop=Z.s2.find(".select2-drop");Z.s2_input=Z.s2.find(".select2-input");Z.drop_resize=function(f){Z.last=Z.last||{};var k=true;if(f.which==9||f.which==13||f.which==27||(f.which>=33&&f.which<=40)){k=false}if(k){var n=Z.multiple?Z.s2_drop.is(":visible"):Z.s2_drop.hasClass("select2-drop-active");if(n){var u=C(window).scrollTop();var o=Z.s2.offset().top;var g=C(window).height();var p=(o-u);var q=Z.s2_results.find(".select2-result-selectable");Z.last.top=p;Z.last.wh=g;Z.s2_results.css("max-height","none");var m=Z.s2_search.outerHeight();var s=Z.s2_results.outerHeight();var e=Z.s2.outerHeight();var j=Math.max(m+V.resultsMinHeight,Math.min(g-p-e-V.dropGap,s+m+V.resultsBuffer));Z.s2_drop.css("height",j);Z.s2_results.css("max-height",j-m-3);var h=Z.s2_results.find(".select2-highlighted");var l=h.prev(".select2-result");if(!l.length){var d=h.closest("ul.select2-result-sub");if(d.length){h=d.prev(".select2-result-label")}}}}};Z.el.bind("aftershow",Z.drop_resize);Z.s2_input.bind("keyup",Z.drop_resize);if(V.sortable&&!V.disabled&&!Z.el.is("select")){Z.s2.addClass("select2-sortable").find("ul.select2-choices").sortable({tolerance:"pointer",containment:"parent",start:function(){Z.el.select2("close")},update:function(){Z.s2.select2("onSortEnd")}})}if(V.layout=="block"){Z.s2.addClass("select2-block")}}else{if(I=="filter"){Z.filter=U}else{if(I=="unfilter"){Z.filter=null}else{if(I=="labels"){var b=Z.el.select2("val");G=[];if(C.isArray(b)){for(i=0;i<b.length;i++){var Y=Z.data_by_id[b[i]];if(Y!=undefined&&Y!=null){G.push(Y.text)}}}else{var Y=Z.data_by_id[b];if(Y!=undefined&&Y!=null&&Y.text){G=[Y.text]}}}else{if(I=="label"){var b=Z.el.select2("val");G="";var Y=Z.data_by_id[b];if(Y!=undefined&&Y!=null&&Y.text){G=Y.text}}else{if(I=="selections"){var b=Z.el.select2("val");if(C.isArray(b)){G=[];for(i=0;i<b.length;i++){var Y=Z.data_by_id[b[i]];if(Y){G.push(Y)}}}else{G=[Z.data_by_id[b]]}}else{if(I=="selection"){var b=Z.el.select2("val");G=false;if(C.isArray(b)){if(b.length){G=Z.data_by_id[b[0]]}}else{G=Z.data_by_id[b]}}else{if(I=="val"){if(C.isEmptyObject(U)){G=Z.el.select2("val")}else{var P=[];var b=U;if(typeof b=="string"){b=b.split(",")}if(!C.isArray(b)){b=[b]}C.each(b,function(d,e){var f=e.id||e;var e=Z.data_by_id[f];if(e!=undefined&&e!=null&&e.text){P.push(e.id)}});if(Z.multiple){Z.el.select2("val",P)}else{Z.el.val(P[0]);Z.el.select2("val",P[0])}}}else{if(I=="focus"){Z.s2_input.focus()}else{if(I=="destroy"){K.data(A,null)}else{var O;if(C.isEmptyObject(U)){G=Z.el.select2(I)}else{G=Z.el.select2(I,U)}}}}}}}}}}}})}return G};C.fn[A].defaults=D})(jQuery);(function($){$.extend($.ui,{timepicker:{version:"0.9.6"}});function Timepicker(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",ampm:false,timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",timezoneText:"Time Zone"};this._defaults={showButtonPanel:false,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showTimezone:false,showTime:true,stepHour:0.05,stepMinute:0.05,stepSecond:0.05,hour:0,minute:0,second:0,timezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,hourMax:23,minuteMax:59,secondMax:59,minDateTime:null,maxDateTime:null,hourGrid:0,minuteGrid:0,secondGrid:0,alwaysSetTime:true,separator:" ",altFieldTimeOnly:true,showTimepicker:true,timezoneList:["-1100","-1000","-0900","-0800","-0700","-0600","-0500","-0400","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0400","+0500","+0600","+0700","+0800","+0900","+1000","+1100","+1200"]};$.extend(this._defaults,this.regional[""])}$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,timezone_select:null,hour:0,minute:0,second:0,timezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:["-1100","-1000","-0900","-0800","-0700","-0600","-0500","-0400","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0400","+0500","+0600","+0700","+0800","+0900","+1000","+1100","+1200"],setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_newInst:function($input,o){var tp_inst=new Timepicker(),inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(input,dp_inst){if($.isFunction(o.beforeShow)){o.beforeShow(input,dp_inst,tp_inst)}},onChangeMonthYear:function(year,month,dp_inst){tp_inst._updateDateTime(dp_inst);if($.isFunction(o.onChangeMonthYear)){o.onChangeMonthYear.call($input[0],year,month,dp_inst,tp_inst)}},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===true&&$input.val()!=""){tp_inst._updateDateTime(dp_inst)}if($.isFunction(o.onClose)){o.onClose.call($input[0],dateText,dp_inst,tp_inst)}},timepicker:tp_inst});tp_inst.hour=tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second;tp_inst.ampm="";tp_inst.$input=$input;if(o.altField){tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})}if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())}if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())}if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())}if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())}return tp_inst},_addTimePicker:function(dp_inst){var currDT=(this.$altInput&&this._defaults.altFieldTimeOnly)?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker()},_parseTime:function(timeString,withDate){var regstr=this._defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/t{1,2}/ig,"(am|pm|a|p)?").replace(/z{1}/ig,"((\\+|-)\\d\\d\\d\\d)?").replace(/\s/g,"\\s?")+this._defaults.timeSuffix+"$",order=this._getFormatPositions(),treg;if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0])}if(withDate||!this._defaults.timeOnly){var dp_dateFormat=$.datepicker._get(this.inst,"dateFormat");var specials=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");regstr=".{"+dp_dateFormat.length+",}"+this._defaults.separator.replace(specials,"\\$&")+regstr}treg=timeString.match(new RegExp(regstr,"i"));if(treg){if(order.t!==-1){this.ampm=((treg[order.t]===undefined||treg[order.t].length===0)?"":(treg[order.t].charAt(0).toUpperCase()=="A")?"AM":"PM").toUpperCase()}if(order.h!==-1){if(this.ampm=="AM"&&treg[order.h]=="12"){this.hour=0}else{if(this.ampm=="PM"&&treg[order.h]!="12"){this.hour=(parseFloat(treg[order.h])+12).toFixed(0)}else{this.hour=Number(treg[order.h])}}}if(order.m!==-1){this.minute=Number(treg[order.m])}if(order.s!==-1){this.second=Number(treg[order.s])}if(order.z!==-1){this.timezone=treg[order.z]}return true}return false},_getFormatPositions:function(){var finds=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|t{1,2}|z)/g),orders={h:-1,m:-1,s:-1,t:-1,z:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]==-1){orders[finds[i].toString().charAt(0)]=i+1}}}return orders},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this._defaults,tp_inst=this,hourMax=(o.hourMax-(o.hourMax%o.stepHour)).toFixed(0),minMax=(o.minuteMax-(o.minuteMax%o.stepMinute)).toFixed(0),secMax=(o.secondMax-(o.secondMax%o.stepSecond)).toFixed(0),dp_id=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if($dp.find("div#ui-timepicker-div-"+dp_id).length===0&&o.showTimepicker){var noDisplay=' style="display:none;"',html='<div class="ui-timepicker-div" id="ui-timepicker-div-'+dp_id+'"><dl><dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+dp_id+'"'+((o.showTime)?"":noDisplay)+">"+o.timeText+'</dt><dd class="ui_tpicker_time" id="ui_tpicker_time_'+dp_id+'"'+((o.showTime)?"":noDisplay)+'></dd><dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+dp_id+'"'+((o.showHour)?"":noDisplay)+">"+o.hourText+"</dt>",hourGridSize=0,minuteGridSize=0,secondGridSize=0,size;if(o.showHour&&o.hourGrid>0){html+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+dp_id+'"'+((o.showHour)?"":noDisplay)+'></div><div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var h=o.hourMin;h<=hourMax;h+=o.hourGrid){hourGridSize++;var tmph=(o.ampm&&h>12)?h-12:h;if(tmph<10){tmph="0"+tmph}if(o.ampm){if(h==0){tmph=12+"a"}else{if(h<12){tmph+="a"}else{tmph+="p"}}}html+="<td>"+tmph+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+dp_id+'"'+((o.showHour)?"":noDisplay)+"></dd>"}html+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+">"+o.minuteText+"</dt>";if(o.showMinute&&o.minuteGrid>0){html+='<dd class="ui_tpicker_minute ui_tpicker_minute_'+o.minuteGrid+'"><div id="ui_tpicker_minute_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+'></div><div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var m=o.minuteMin;m<=minMax;m+=o.minuteGrid){minuteGridSize++;html+="<td>"+((m<10)?"0":"")+m+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+"></dd>"}html+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+">"+o.secondText+"</dt>";if(o.showSecond&&o.secondGrid>0){html+='<dd class="ui_tpicker_second ui_tpicker_second_'+o.secondGrid+'"><div id="ui_tpicker_second_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+'></div><div style="padding-left: 1px"><table><tr>';for(var s=o.secondMin;s<=secMax;s+=o.secondGrid){secondGridSize++;html+="<td>"+((s<10)?"0":"")+s+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_second" id="ui_tpicker_second_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+"></dd>"}html+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+dp_id+'"'+((o.showTimezone)?"":noDisplay)+">"+o.timezoneText+"</dt>";html+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+dp_id+'"'+((o.showTimezone)?"":noDisplay)+"></dd>";html+="</dl></div>";$tp=$(html);if(o.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+o.timeOnlyTitle+"</div></div>");$dp.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}this.hour_slider=$tp.find("#ui_tpicker_hour_"+dp_id).slider({orientation:"horizontal",value:this.hour,min:o.hourMin,max:hourMax,step:o.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.minute_slider=$tp.find("#ui_tpicker_minute_"+dp_id).slider({orientation:"horizontal",value:this.minute,min:o.minuteMin,max:minMax,step:o.stepMinute,slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.second_slider=$tp.find("#ui_tpicker_second_"+dp_id).slider({orientation:"horizontal",value:this.second,min:o.secondMin,max:secMax,step:o.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.timezone_select=$tp.find("#ui_tpicker_timezone_"+dp_id).append("<select></select>").find("select");$.fn.append.apply(this.timezone_select,$.map(o.timezoneList,function(val,idx){return $("<option />").val(typeof val=="object"?val.value:val).text(typeof val=="object"?val.label:val)}));this.timezone_select.val((typeof this.timezone!="undefined"&&this.timezone!=null&&this.timezone!="")?this.timezone:o.timezone);this.timezone_select.change(function(){tp_inst._onTimeChange()});if(o.showHour&&o.hourGrid>0){size=100*hourGridSize*o.hourGrid/(hourMax-o.hourMin);$tp.find(".ui_tpicker_hour table").css({width:size+"%",marginLeft:(size/(-2*hourGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){var h=$(this).html();if(o.ampm){var ap=h.substring(2).toLowerCase(),aph=parseInt(h.substring(0,2),10);if(ap=="a"){if(aph==12){h=0}else{h=aph}}else{if(aph==12){h=12}else{h=aph+12}}}tp_inst.hour_slider.slider("option","value",h);tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:(100/hourGridSize)+"%",textAlign:"center",overflow:"hidden"})})}if(o.showMinute&&o.minuteGrid>0){size=100*minuteGridSize*o.minuteGrid/(minMax-o.minuteMin);$tp.find(".ui_tpicker_minute table").css({width:size+"%",marginLeft:(size/(-2*minuteGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.minute_slider.slider("option","value",$(this).html());tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:(100/minuteGridSize)+"%",textAlign:"center",overflow:"hidden"})})}if(o.showSecond&&o.secondGrid>0){$tp.find(".ui_tpicker_second table").css({width:size+"%",marginLeft:(size/(-2*secondGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.second_slider.slider("option","value",$(this).html());tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:(100/secondGridSize)+"%",textAlign:"center",overflow:"hidden"})})}var $buttonPanel=$dp.find(".ui-datepicker-buttonpane");if($buttonPanel.length){$buttonPanel.before($tp)}else{$dp.append($tp)}this.$timeObj=$tp.find("#ui_tpicker_time_"+dp_id);if(this.inst!==null){var timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined}var onSelectDelegate=function(){tp_inst._onSelectHandler()};this.hour_slider.bind("slidestop",onSelectDelegate);this.minute_slider.bind("slidestop",onSelectDelegate);this.second_slider.bind("slidestop",onSelectDelegate)}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);if(!this._defaults.showTimepicker){return }if($.datepicker._get(dp_inst,"minDateTime")!==null&&dp_date){var minDateTime=$.datepicker._get(dp_inst,"minDateTime"),minDateTimeDate=new Date(minDateTime.getFullYear(),minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin}if(dp_inst.settings.timeOnly||minDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=minDateTime.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=minDateTime.getSeconds()}else{if(this.second<this._defaults.secondMin){this.second=this._defaults.secondMin}this._defaults.secondMin=this.secondMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal}}if($.datepicker._get(dp_inst,"maxDateTime")!==null&&dp_date){var maxDateTime=$.datepicker._get(dp_inst,"maxDateTime"),maxDateTimeDate=new Date(maxDateTime.getFullYear(),maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax}if(dp_inst.settings.timeOnly||maxDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=maxDateTime.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=maxDateTime.getSeconds()}else{if(this.second>this._defaults.secondMax){this.second=this._defaults.secondMax}this._defaults.secondMax=this.secondMaxOriginal}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal}}if(adjustSliders!==undefined&&adjustSliders===true){var hourMax=(this._defaults.hourMax-(this._defaults.hourMax%this._defaults.stepHour)).toFixed(0),minMax=(this._defaults.minuteMax-(this._defaults.minuteMax%this._defaults.stepMinute)).toFixed(0),secMax=(this._defaults.secondMax-(this._defaults.secondMax%this._defaults.stepSecond)).toFixed(0);if(this.hour_slider){this.hour_slider.slider("option",{min:this._defaults.hourMin,max:hourMax}).slider("value",this.hour)}if(this.minute_slider){this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:minMax}).slider("value",this.minute)}if(this.second_slider){this.second_slider.slider("option",{min:this._defaults.secondMin,max:secMax}).slider("value",this.second)}}},_onTimeChange:function(){var hour=(this.hour_slider)?this.hour_slider.slider("value"):false,minute=(this.minute_slider)?this.minute_slider.slider("value"):false,second=(this.second_slider)?this.second_slider.slider("value"):false,timezone=(this.timezone_select)?this.timezone_select.val():false;if(typeof (hour)=="object"){hour=false}if(typeof (minute)=="object"){minute=false}if(typeof (second)=="object"){second=false}if(typeof (timezone)=="object"){timezone=false}if(hour!==false){hour=parseInt(hour,10)}if(minute!==false){minute=parseInt(minute,10)}if(second!==false){second=parseInt(second,10)}var ampm=(hour<12)?"AM":"PM";var hasChanged=(hour!=this.hour||minute!=this.minute||second!=this.second||(this.ampm.length>0&&this.ampm!=ampm)||timezone!=this.timezone);if(hasChanged){if(hour!==false){this.hour=hour}if(minute!==false){this.minute=minute}if(second!==false){this.second=second}if(timezone!==false){this.timezone=timezone}if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0])}this._limitMinMaxDateTime(this.inst,true)}if(this._defaults.ampm){this.ampm=ampm}this._formatTime();if(this.$timeObj){this.$timeObj.text(this.formattedTime+this._defaults.timeSuffix)}this.timeDefined=true;if(hasChanged){this._updateDateTime()}},_onSelectHandler:function(){var onSelect=this._defaults.onSelect;var inputEl=this.$input?this.$input[0]:null;if(onSelect&&inputEl){onSelect.apply(inputEl,[this.formattedDateTime,this])}},_formatTime:function(time,format,ampm){if(ampm==undefined){ampm=this._defaults.ampm}time=time||{hour:this.hour,minute:this.minute,second:this.second,ampm:this.ampm,timezone:this.timezone};var tmptime=format||this._defaults.timeFormat.toString();if(ampm){var hour12=((time.ampm=="AM")?(time.hour):(time.hour%12));hour12=(Number(hour12)===0)?12:hour12;tmptime=tmptime.toString().replace(/hh/g,((hour12<10)?"0":"")+hour12).replace(/h/g,hour12).replace(/mm/g,((time.minute<10)?"0":"")+time.minute).replace(/m/g,time.minute).replace(/ss/g,((time.second<10)?"0":"")+time.second).replace(/s/g,time.second).replace(/TT/g,time.ampm.toUpperCase()).replace(/Tt/g,time.ampm.toUpperCase()).replace(/tT/g,time.ampm.toLowerCase()).replace(/tt/g,time.ampm.toLowerCase()).replace(/T/g,time.ampm.charAt(0).toUpperCase()).replace(/t/g,time.ampm.charAt(0).toLowerCase()).replace(/z/g,time.timezone)}else{tmptime=tmptime.toString().replace(/hh/g,((time.hour<10)?"0":"")+time.hour).replace(/h/g,time.hour).replace(/mm/g,((time.minute<10)?"0":"")+time.minute).replace(/m/g,time.minute).replace(/ss/g,((time.second<10)?"0":"")+time.second).replace(/s/g,time.second).replace(/z/g,time.timezone);tmptime=$.trim(tmptime.replace(/t/gi,""))}if(arguments.length){return tmptime}else{this.formattedTime=tmptime}},_updateDateTime:function(dp_inst){dp_inst=this.inst||dp_inst,dt=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay),dateFmt=$.datepicker._get(dp_inst,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(dp_inst),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;if(dp_inst.lastVal!==undefined&&(dp_inst.lastVal.length>0&&this.$input.val().length===0)){return }if(this._defaults.timeOnly===true){formattedDateTime=this.formattedTime}else{if(this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||timeAvailable)){formattedDateTime+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix}}this.formattedDateTime=formattedDateTime;if(!this._defaults.showTimepicker){this.$input.val(this.formattedDate)}else{if(this.$altInput&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else{if(this.$altInput){this.$altInput.val(formattedDateTime);this.$input.val(formattedDateTime)}else{this.$input.val(formattedDateTime)}}}this.$input.trigger("change")}});$.fn.extend({timepicker:function(o){o=o||{};var tmp_args=arguments;if(typeof o=="object"){tmp_args[0]=$.extend(o,{timeOnly:true})}return $(this).each(function(){$.fn.datetimepicker.apply($(this),tmp_args)})},datetimepicker:function(o){o=o||{};var $input=this,tmp_args=arguments;if(typeof (o)=="string"){if(o=="getDate"){return $.fn.datepicker.apply($(this[0]),tmp_args)}else{return this.each(function(){var $t=$(this);$t.datepicker.apply($t,tmp_args)})}}else{return this.each(function(){var $t=$(this);$t.datepicker($.timepicker._newInst($t,o)._defaults)})}}});$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._limitMinMaxDateTime(inst,true);inst.inline=inst.stay_open=true;this._base_selectDate(id,dateStr+tp_inst._defaults.separator+tp_inst.formattedTime+tp_inst._defaults.timeSuffix);inst.inline=inst.stay_open=false;this._notifyChange(inst);this._updateDatepicker(inst)}else{this._base_selectDate(id,dateStr)}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){var input=inst.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=inst&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=input){return }if(typeof (inst.stay_open)!=="boolean"||inst.stay_open===false){this._base_updateDatepicker(inst);var tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._addTimePicker(inst)}}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if($.datepicker._get(inst,"constrainInput")){var ampm=tp_inst._defaults.ampm,dateChars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,ampm?"APM":"").replace(/Tt/g,ampm?"AaPpMm":"").replace(/tT/g,ampm?"AaPpMm":"").replace(/T/g,ampm?"AP":"").replace(/tt/g,ampm?"apm":"").replace(/t/g,ampm?"ap":"")+" "+tp_inst._defaults.separator+tp_inst._defaults.timeSuffix+(tp_inst._defaults.showTimezone?tp_inst._defaults.timezoneList.join(""):"")+dateChars,chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||(chr<" "||!dateChars||datetimeChars.indexOf(chr)>-1)}}return $.datepicker._base_doKeyPress(event)};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!=inst.lastVal)){try{$.datepicker._updateDatepicker(inst)}catch(err){$.datepicker.log(err)}}}return $.datepicker._base_doKeyUp(event)};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){this._base_gotoToday(id);this._setTime(this._getInst($(id)[0]),new Date())};$.datepicker._disableTimepickerDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=false;tp_inst._updateDateTime(inst)}};$.datepicker._enableTimepickerDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=true;tp_inst._addTimePicker(inst);tp_inst._updateDateTime(inst)}};$.datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,"timepicker");if(tp_inst){var defaults=tp_inst._defaults,hour=date?date.getHours():defaults.hour,minute=date?date.getMinutes():defaults.minute,second=date?date.getSeconds():defaults.second;if((hour<defaults.hourMin||hour>defaults.hourMax)||(minute<defaults.minuteMin||minute>defaults.minuteMax)||(second<defaults.secondMin||second>defaults.secondMax)){hour=defaults.hourMin;minute=defaults.minuteMin;second=defaults.secondMin}tp_inst.hour=hour;tp_inst.minute=minute;tp_inst.second=second;if(tp_inst.hour_slider){tp_inst.hour_slider.slider("value",hour)}if(tp_inst.minute_slider){tp_inst.minute_slider.slider("value",minute)}if(tp_inst.second_slider){tp_inst.second_slider.slider("value",second)}tp_inst._onTimeChange();tp_inst._updateDateTime(inst)}};$.datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst);var tp_date;if(date){if(typeof date=="string"){tp_inst._parseTime(date,withDate);tp_date=new Date();tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second)}else{tp_date=new Date(date.getTime())}if(tp_date.toString()=="Invalid Date"){tp_date=undefined}this._setTime(inst,tp_date)}}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(target,date){var inst=this._getInst(target),tp_date=(date instanceof Date)?new Date(date.getTime()):date;this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,true)};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst,noDefault);var date=this._getDate(inst);if(date&&tp_inst._parseTime($(target).val(),tp_inst.timeOnly)){date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second)}return date}return this._base_getDateDatepicker(target,noDefault)};$.datepicker._base_parseDate=$.datepicker.parseDate;$.datepicker.parseDate=function(format,value,settings){var date;try{date=this._base_parseDate(format,value,settings)}catch(err){date=this._base_parseDate(format,value.substring(0,value.length-(err.length-err.indexOf(":")-2)),settings)}return date};$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker;$.datepicker._optionDatepicker=function(target,name,value){this._base_optionDatepicker(target,name,value);var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){if(name==="minDate"){if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(value)}if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())}tp_inst._limitMinMaxDateTime(inst,true)}if(name==="maxDate"){if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(value)}if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())}tp_inst._limitMinMaxDateTime(inst,true)}}};function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]===null||props[name]===undefined){target[name]=props[name]}}return target}$.timepicker=new Timepicker();$.timepicker.version="0.9.6"})(jQuery);(function(A){A.fn.autoResize=function(C){var B=A.extend({onResize:function(){},animate:true,animateDuration:150,animateCallback:function(){},extraSpace:20,limit:1000},C);this.filter("textarea").each(function(){var H=A(this).css({resize:"none","overflow-y":"hidden"}),D=H.height(),G=(function(){var I=["height","width","lineHeight","textDecoration","letterSpacing"],J={};A.each(I,function(L,K){J[K]=H.css(K)});return H.clone().removeAttr("id").removeAttr("name").css({position:"absolute",top:0,left:-9999}).css(J).attr("tabIndex","-1").insertBefore(H)})(),E=null,F=function(){G.height(0).val(A(this).val()).scrollTop(10000);var J=Math.max(G.scrollTop(),D)+B.extraSpace,I=A(this).add(G);if(E===J){return }E=J;if(J>=B.limit){A(this).css("overflow-y","");return }B.onResize.call(this);B.animate&&H.css("display")==="block"?I.stop().animate({height:J},B.animateDuration,B.animateCallback):I.height(J)};H.unbind(".dynSiz").bind("keyup.dynSiz",F).bind("keydown.dynSiz",F).bind("change.dynSiz",F)});return this}})(jQuery);(function(A){String.prototype.mp_entity_decode=function(){return this.replace("&amp;","&")};String.prototype.mp_decode_html=function(){var C,B=document.createElement("p");B.innerHTML=this;C=B.textContent||B.innerText;B=null;return C};String.prototype.mp_repeat=function(B){return new Array(B+1).join(this)};A.mp={errors:{duplicate_widget:"The jQuery UI widget of type '%s' has already been defined. You must change the 'type' variable at the top of your field type's main javascript file to match the unique ID for that type.",incomplete_widget:"One of your field types has an incomplete widget class. You must change the 'type' variable at the top of your field type's main javascript file to match the unique ID for that type."},lang:{},is2x:matchMedia("screen and (min-device-pixel-ratio: 2.0)").matches||matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").matches||matchMedia("screen and (min--moz-device-pixel-ratio: 1.5)").matches,parseColor:function(B){if(matches=B.match(/^\#?([a-f0-9]{1})$/i)){B="#"+matches[1].mp_repeat(6)}else{if(matches=B.match(/^\#?([a-f0-9]{2})$/i)){B="#"+matches[1].mp_repeat(3)}else{if(matches=B.match(/^\#?([a-f0-9]{3})$/i)){B="#"+matches[1].mp_repeat(2)}else{if(matches=B.match(/^\#?([a-f0-9]{4,5})$/i)){B="#"+matches[1].mp_repeat(2)}else{if(matches=B.match(/^\#?([a-f0-9]{1,6})$/i)){B="#"+matches[1]}else{B=""}}}}}return B},smartTrim:function(E,B,D){if(!D){D=" &hellip; "}if(!E){return E}if(B<1){return E}if(E.length<=B){return E}if(B==1){return E.substring(0,1)+D}var F=Math.ceil(E.length/2);var G=E.length-B;var H=Math.ceil(G/2);var C=G-H;return E.substring(0,F-H)+D+E.substring(F+C)},get:function(B,C){A.getJSON(mp_ajax_url,A.extend(true,{nonce:mp_nonce,controller:mp_controller,source_action:mp_action},B,A.mp.context()),C)},context:function(){var B={action:"masterpress_dispatch"};if(A("#mp-id").length){B.id=A("#mp-id").val()}if(A("#mp-parent").length){B.parent=A("#mp-parent").val()}return B},action:function(B,D,E){var C=B.split(".");if(C.length==2){A.getJSON(mp_ajax_url,A.extend(true,{nonce:mp_nonce,source_action:mp_action,controller:C[0],method:C[1]},D,A.mp.context()),E)}},postToAction:function(B,D,E){var C=B.split(".");if(C.length==2){A.post(mp_ajax_url,A.extend(true,{nonce:mp_nonce,source_action:mp_action,controller:C[0],method:C[1]},D,A.mp.context()),E,"json")}},post:function(B,C){A.postJSON(mp_ajax_url,A.extend(true,{nonce:mp_nonce,source_action:mp_action,controller:mp_controller},B,A.mp.context()),C,"json")},clearMessages:function(){A(".mpv .messages").html("")},error:function(C,B){if(!B){A(".mpv .messages").html('<li class="error"><i class="error-circle"></i>'+C+"</li>")}else{A(".mpv .messages").append(A('<li class="error"><i class="error-circle"></i>'+C+"</li>"))}},message:function(C,B){if(B){A(".mpv .messages").html('<li class="warning"><i class="warning-octagon"></i>'+C+"</li>")}else{A(".mpv .messages").append(A('<li class="warning"><i class="warning-octagon"></i>'+C+"</li>"))}},itemCount:function(E,D,B,C){if(E==0&&C){return sprintf(C,E)}if(E==1){return sprintf(D,E)}return sprintf(B,E)}}})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(A){A.widget("ui.mp_thumb",{options:{},_create:function(B){this.thumb=this.element.find("img");this.link=this.element.find("a");this.setup_2x();this.setup_fancybox()},setup_2x:function(F){if(A.mp.is2x){var B=parseInt(this.element.css("width"));var D=parseInt(this.element.css("height"));var C=this.thumb.data("width");var E=this.thumb.data("height");if(B==0){var B=this.thumb.data("thumb_width");var D=this.thumb.data("thumb_height")}this.element.css("width",this.thumb.data("thumb_width"));if(C<B*2){this.element.css("width","");this.thumb.data("thumb_width",parseInt(this.thumb.data("thumb_width"))/2);this.thumb.data("thumb_height",parseInt(this.thumb.data("thumb_height"))/2);if(this.link.length){this.link.css("width",C/2);this.link.css("height","auto")}else{this.element.css("width",C/2);this.element.css("height","auto")}this.thumb.css("width",C/2);this.thumb.css("height","auto");this.thumb.addClass("small-2x")}else{if(F){if(this.link.length){this.link.css("width",B);this.link.css("height","auto")}else{this.element.css("width",B);this.element.css("height","auto")}this.thumb.css("width",B);this.thumb.css("height","auto");this.thumb.removeClass("small-2x")}}}},set_info:function(D){var C=this;var B=!this.thumb.length;var E=D.href&&!this.link.length;if(B){C.thumb=A("<img />")}C.thumb.attr({src:D.thumb,width:D.thumb_width,height:D.thumb_height}).data({width:D.width,height:D.height,thumb_width:D.thumb_width,thumb_height:D.thumb_height});if(E){C.link=A("<a />")}C.link.attr(A.extend({},true,{href:D.href},D.link_attr||{}));C.element.removeClass("empty");if(D.title){C.element.attr("title",D.title)}if(D.href){C.link.append(C.thumb);C.link.css({width:D.thumb_width,height:"auto"});C.element.append(C.link)}else{if(C.link.length){C.link.remove();C.fancybox=false}C.element.append(C.thumb);C.element.css({width:D.thumb_width,height:"auto"})}if(E){C.setup_fancybox()}C.setup_2x(true)},clear:function(){if(this.thumb.length){this.thumb.remove()}if(this.link.length){this.link.remove();this.fancybox=false}this.element.addClass("empty");this.element.css({height:"auto",width:"auto"})},setup_fancybox:function(){var B=this;if(!B.fancybox&&B.link.length){var C={overlayShow:false,transitionIn:"elastic",speedIn:200,speedOut:200,is2x:A.mp.is2x,overlayShow:true,overlayOpacity:0.4,overlayColor:"#000",transitionOut:"elastic",hideOnContentClick:true,padding:8,onStart:function(){window.mp_fancy_box_element=B.link;if(!B.link.attr("href")){return false}}};if(B.link.data("type")){C.type=B.link.data("type")}B.fancybox=true;B.link.fancybox(C);B.link.bind("focus",function(){B.element.addClass("focus")}).bind("blur",function(){B.element.removeClass("focus")}).bind("fancybox-cleanup",function(){if(window.mp_fancy_box_element==B.link){B.link.focus()}})}}})})(jQuery);(function(A){A(document).ready(function(){window.mptt_template=Handlebars.compile(A("#mp-field-label-tooltip-template").html());A.fn.serializeDeep=function(){var AF=A(this).serializeArray();var AG={};A.each(AF,function(AK,AN){var AJ=AN.name.match(/([a-z0-9\_]+$)/i);if(AJ&&AJ.length==2){AG[AN.name]=AN.value}else{var AJ=AN.name.match(/([a-z0-9\_]+)(\[.*\])/i);if(AJ&&AJ.length==3){var AH=AJ[1];var AP=AJ[2];if(!AG[AH]){AG[AH]={}}var AM=AP.match(/\[[^\]]*\]+/ig);var AI=AG[AH];var AL="";var AO="";A.each(AM,function(AR,AQ){var AS=AQ.replace(/\[/,"").replace(/\]/,"");if(AS==""){if(!A.isArray(AI)){AI=[]}if(AR==AM.length-1){AI.push(AN.value)}else{AI.push({});AI=AI[AS]}}else{AL+=AQ;if(!AI[AS]){AI[AS]={}}if(AR==AM.length-1){AI[AS]=AN.value}else{prev=AI;AI=AI[AS]}}})}}});return AG};A.fn.mp_tooltip_setup=function(){return this.each(function(){var AI=A(this);var AH=A();if(AI.data("tooltip")){AH=A(window.mptt_template({text:AI.data("tooltip")}));AH.hide().appendTo("body")}else{if(matches=AI.attr("href").match(/(#.*?$)/)){var AF=matches[1];var AH=A(AF);if(AH.length&&!AH.data("mptt")){AH.data("mptt",true);var AG=window.mptt_template({text:AH.html()});AH.hide().empty().append(AG).appendTo("body")}}}if(AH.length){AI.reveal({el:AH,triggerEvent:"hover",show:"fadeIn",hide:"fadeOut",hideOnTargetMouseLeave:true,showDelay:100,hideDelay:0,showOptions:{duration:200},hideOptions:{duration:100},affix:{from:"sw",to:"nw",offset:[-10,6]}});AI.data("revealInitTimeout",setTimeout(function(){AI.reveal("show")},100));AI.bind("mouseleave",function(){clearTimeout(AI.data("revealInitTimeout"))});AI.bind("blur",function(){A(this).reveal("hide")})}})};A.fn.mp_tooltip=function(AF){return this.each(function(){A(this).bind({mouseenter:function(){var AG=A(this);if(!AG.data("reveal")){AG.mp_tooltip_setup()}}});if(!A(this).hasClass("mp-go")){A(this).bind({click:function(){var AG=A(this);if(!AG.data("reveal")){AG.mp_tooltip_setup()}A(this).reveal("show");return false}})}})};A(".mp-tooltip-icon,.with-mptt").mp_tooltip();if(window.mpft_script){A.getScript(window.mpft_script)}A.fn.checkboxAltLabel=function(){return this.each(function(){var AF=A(this);if(!AF.data("checkboxAltLabel")){AF.data("checkboxAltLabel",true);AF.click(function(){var AG=A(this).metadata({type:"class"}).for_el;$chk=A();if(AG){try{$chk=A(AG)}catch(AH){$chk=A()}}if(!$chk.length){$chk=AF.prev("input[type=checkbox]")}if($chk.length){$chk.focus();if($chk.is(":checked")){$chk.removeAttr("checked")}else{$chk.attr("checked","checked")}$chk.change()}})}})};if(A("#mp-attributes").length){A("#mp-attributes select").mp_select2()}A(".picture").picturefill();A(".mp-thumb:not(.managed)").mp_thumb();A("select.custom-taxonomy-filter").find("option").each(function(){A(this).data("html",A(this).html())}).end().change(function(){var AH=A(this).metadata({type:"class"});var AF=A(this).find("option");AF.each(function(){A(this).html(A(this).data("html"))});if(AH.taxonomy&&A(this).val()!=""){var AG=AF.filter(":selected");AG.html(AH.taxonomy+": "+AG.html().replace(/\&nbsp\;/gi,"")+"&nbsp;")}}).change();var Y=A(".mpv");var T=A(".mpv-admin");A(".auto-spinner").each(function(){var AF=A(this);AF.find("input").inputspinner({up:AF.find(".up"),down:AF.find(".down"),step:1,min:0})});if(T.length){var I=function(){};var M=A(".mpv").metadata({type:"class"}).lang_short||"en";$grids=A("table.grid");$updated=$grids.find("tr.updated");if($updated.length){A.scrollTo($updated.closest("table"))}setTimeout(function(){$updated.removeClass("updated")},2000);$grids.find("a[disabled=disabled]").click(function(){return false});A(".mpv form").find("input[type=text],input[type=checkbox],input[type=radio],textarea").not(".readonly").eq(0).focus();var u=function(){$grids.each(function(){var AF=A(this).find("tbody");var AH=A(this).find(">tr");AH.each(function(){A(this).appendTo(AF)});var AG=A(this).find("tbody tr.sub");AG.removeClass("first even").filter(":odd").addClass("even").end().eq(0).addClass("first")})};var S=A("table.grid tbody tr.editable,table.grid tbody td.manage");S.linkify({selectorNoClosest:"a,td.sort,th.sort,td.actions,th.actions,tr.panel"});var g=A(".fs-column-builder");if(g.length){var C=g.find("ul.column-items");g.find(".columns").sortable({items:"li:not(.nosort)",tolerance:"pointer",stop:function(){g.find(".column").each(function(AF,AH){var AG=A(AH);AG.find("input.text,input[type=hidden],textarea").each(function(AI,AL){var AJ=A(AL);var AK=AJ.attr("name");var AM=AK.replace(/\[\d+\]/i,"["+(AF)+"]");AJ.attr("name",AM)})})}});var AB=function(){var AG=A(this);var AH=AG.closest(".column");if(AH.hasClass("core")){var AF=AH.data("core");A("#core-column-"+AF).removeAttr("checked");AH.addClass("disabled").find("input.disabled").val("yes")}else{AH.remove()}};g.find(".column .remove").click(AB);g.find(".core-columns input").change(function(){var AF=g.find(".column."+A(this).val());if(A(this).is(":checked")){AF.removeClass("disabled").find("input.disabled").val("")}else{AF.addClass("disabled").find("input.disabled").val("yes")}});if(A("#custom-column-template").length){var AA=Handlebars.compile(A("#custom-column-template").html())}if(A("#tax-add-button-template").length){var s=Handlebars.compile(A("#tax-add-button-template").html())}var E=function(AH,AG){var AI=AG||"";var AF=A(AA({index:g.find(".column").length}));AF.appendTo(g.find(".columns"));AF.find(".remove").click(AB);AF.find(".head input").focus().select();if(AH){AF.find(".head input").val(AH).focus().select()}AF.find(".body textarea").val("{{"+AI+"}}").css("z-index",200-g.find(".column").length);return false};A("#add-custom-column").click(function(){E()});A("button.add.taxonomy").live("click",function(){var AF=A(AA({index:g.find(".column").length}));AF.appendTo(g.find(".columns"));AF.find(".remove").click(AB);AF.find(".head input").val(A(this).data("title")).focus().select();AF.find(".body textarea").val("{{col.terms("+A(this).data("taxonomy")+")}}").css("z-index",200-g.find(".column").length)});A(".fs-taxonomies input.checkbox").change(function(){var AG=A(this);var AI=AG.val();var AJ=AG.data("title");var AH=AG.data("builtin")==1;var AF=A(".taxonomy-control."+AI);if(AG.is(":checked")){if(!AF.length&&!AH){A(".custom-columns").append(A(s({taxonomy:AI,title:AJ})))}}else{AF.remove()}});var j=A("#dialog-fields");var K=A("#add-field-column-field-sets");var w=false;A("#add-field-column").click(function(){var AF={closeOnEscape:true,width:500,height:145,resizable:false,modal:true,dialogClass:"wp-dialog aristo dialog-fields",autoOpen:true,title:j.data("title"),buttons:{OK:function(){var AG=K.mp_select2("val");var AH=K.mp_select2("label");E(AH,AG);A(this).dialog("close")},Cancel:function(){A(this).dialog("close")}}};if(!w){j.dialog(AF);K.mp_select2();w=true}else{j.dialog("open")}K.mp_select2("focus")})}A(".fs-capability-keys .f-capabilities button.suggest").click(function(){var AH=A(this).closest(".f-capabilities").find("input.text");var AF=AH.data("suggest");if(AF&&AF!=""){var AG=Handlebars.compile(AF);AH.val(AG({name:A("#name").val()}))}});function G(){var AK=g.find(".columns");var AM=g.find(".column.comments");var AN=g.find(".column.author");var AF=g.find(".column.title");var AL=g.find(".column.categories");var AP=g.find(".column.tags");var AJ=true;var AG=true;var AO=true;var AH=true;var AI=true;if(A(".fs-supports").length){AO=A("#supports_title").is(":checked")}AJ=A("#supports_comments").is(":checked")&&A("#core-column-comments").is(":checked");AG=A("#supports_author").is(":checked")&&A("#core-column-author").is(":checked");AH=A("#taxonomies_category").is(":checked")&&A("#core-column-categories").is(":checked");AI=A("#taxonomies_post_tag").is(":checked")&&A("#core-column-tags").is(":checked");if(AJ){AM.removeClass("disabled").find("input.disabled").val("")}else{AM.addClass("disabled").find("input.disabled").val("yes")}if(AG){AN.removeClass("disabled").find("input.disabled").val("")}else{AN.addClass("disabled").find("input.disabled").val("yes")}if(AO){AF.removeClass("disabled").find("input.disabled").val("")}else{AF.addClass("disabled").find("input.disabled").val("yes")}if(AH){AL.removeClass("disabled").find("input.disabled").val("")}else{AL.addClass("disabled").find("input.disabled").val("yes")}if(AI){AP.removeClass("disabled").find("input.disabled").val("")}else{AP.addClass("disabled").find("input.disabled").val("yes")}}A("#supports_comments,#supports_author,#supports_title,#taxonomies_category,#taxonomies_post_tag").change(G);G();A("#taxonomies_category").change(function(){A("#fw-core-column-categories").css("display",A(this).is(":checked")?"block":"none");G()});A("#taxonomies_post_tag").change(function(){A("#fw-core-column-tags").css("display",A(this).is(":checked")?"block":"none");G()});A("#supports_author").change(function(){A("#fw-core-column-author").css("display",A(this).is(":checked")?"block":"none")});A("#supports_comments").change(function(){A("#fw-core-column-comments").css("display",A(this).is(":checked")?"block":"none")});$grids.find("tbody td,tbody th").hover(function(AG){var AF=A(AG.target).closest("tr");var AH=A(this);if(!AH.hasClass("actions")){if(AH.hasClass("manage")){AF.find(".button-manage").addClass("hover")}else{AF.find(".button-edit").addClass("hover")}}},function(AG){var AF=A(AG.target).closest("tr");AF.find(".button").removeClass("hover")});A(".checkbox-alt-label").checkboxAltLabel();var o=function(AG){var AF=1;var AH=A([]);A(this).find("li:not(.divide,.holder)").each(function(AJ,AL){var AM=A(this);var AK=AM.prevAll("li.bi");if(AK.length){var AI=AK.metadata({type:"class"}).base_pos;if(AI){AM.find("input.pos").val(AI);if(AH.get(0)==AK.get(0)){AF++}else{AF=1}AH=AK;AM.find("input.sub_pos").val(AF)}}});A(this).sortableListUpdateArrow()};var c=function(AF){A(this).find("li").each(function(AH,AG){var AI=A(this);AI.find("input").val(AH+1)});A(this).sortableListUpdateArrow()};A.fn.sortableListUpdateArrow=function(){return this.each(function(){var AG=A(this);var AF=AG.find(".arrow");var AH=AG.find("li.current");if(AH.length){AF.css("top",AH.position().top+7)}})};var F=A(".sortable-list-menu");if(F.length){F.sortable({items:"li:not(.first)",cancel:".nomove",axis:"y",revert:200,stop:o,sort:function(){A(this).sortableListUpdateArrow()}}).sortableListUpdateArrow()}var P=A(".sortable-list-fields");if(P.length){P.sortable({items:"li",axis:"y",revert:200,stop:c,sort:function(){A(this).sortableListUpdateArrow()}}).sortableListUpdateArrow()}var y=function(){A(this).hide();var AF=A(this).closest(".icon-uploader");AF.mp_file_uploader("clear");AF.find(".preview").css("backgroundImage","").addClass("preview-none");var AH=AF.find(".name");AH.addClass("name-none");var AG=AH.data("none");AF.find(".clear").hide();if(!AG){AG="( None )"}AH.html(AG);A(".sortable-list-menu .current .icon").css({backgroundImage:""})};A(".icon-uploader").mp_file_uploader({method:"upload_menu_icon"}).find("button.clear").click(y).end().bind("submit.mp_file_uploader",function(AF,AG){A(this).find(".file").addClass("progress")}).bind("complete.mp_file_uploader",function(AF,AG){var AI=A(this);var AH=AI.find("button.clear").appendTo("body");AI.find(".file").remove();$preview=A('<span class="preview"></span>').css({backgroundImage:"url("+AG.url+")"});$file=A('<div class="file"><span class="name">'+AG.destinationFileName+"</span></div>");$file.prepend($preview);AH.show().appendTo($file);AI.prepend($file);A(".sortable-list-menu .current .icon").css({backgroundImage:"url("+AG.url+")"})});A(".icon-select").mp_select2();A.fn.iconSelectUploader=function(){var AH=A(this).data("uploader");if(AH&&AH.length){try{var AF=A("#"+AH);return AF}catch(AG){}}return A()};A(".icon-select").bind("change",function(){var AJ=A(this).data("base");var AK=A(this).mp_select2("val");var AF="url("+AJ+AK+")";var AH=A(this).iconSelectUploader();if(AK!=""){A("#menu_icon").val("");AH.hide();AH.find(".preview").css("backgroundImage","").addClass("preview-none");var AL=AH.find(".name");AL.addClass("name-none");var AG=AL.data("none");AH.find(".clear").hide();if(!AG){AG="( None )"}AL.html(AG)}else{var AI=AH.find(".preview").css("backgroundImage");if(AI){AF=AI}else{AF="url("+A(this).data("no_icon")+")"}A(this).iconSelectUploader().show()}A(".sortable-list-menu .current .icon").css({backgroundImage:AF})}).change();A.fn.fill=function(){return this.each(function(){var AG=A(this);var AI=AG.metadata({type:"class"});try{var AF=AI.src;if(AF){srcItems=AI.src.split(",")}var AK=A();if(srcItems.length>1){A.each(srcItems,function(AL,AM){$item=A(AM);if($item.is(":visible")&&!AK.length){AK=$item}})}else{AK=A(AF)}var AJ=A(AK).val();if(AJ==""){AJ="?"}else{if(AI.format){if(AI.format=="pluralize"){AJ=AJ.pluralize()}else{if(AI.format=="titleize"){AJ=AJ.titleize()}else{if(AI.format=="dasherize"){AJ=AJ.dasherize()}}}}}if(AI.func=="val"){AG.val(AJ)}else{AG.html(AJ)}}catch(AH){}})};A.fn.updateLabels=function(AG,AF){update=true;if(update){this.find("input").each(function(){var AI=A(this);var AK=AI.metadata({type:"class"});var AH=AK.tmpl;if(name==""){name="?"}if(AF==""){AF="?"}if(AH){var AJ=Handlebars.compile(AH);var AL=AJ({plural_name:AF,singular_name:AG,name:AG});AL=AL.replace(/[\_\-]/gi," ");if(!AK.lowercase){AL=AL.titleize()}AI.val(AL)}})}};var f=function(){if(A("#name").length){var AF="";if(A("#plural_name").length){AF=A("#plural_name").val()}if(A("#name").val()!=A("#name_last").val()){A("#name_last").val(A("#name").val());A(".fs-labels").updateLabels(A("#name").val(),AF);A(".fill").fill();I()}}};var v=function(){if(A("#name").length&&A("#singular_name").length){if(A("#name").val()!=A("#name_last").val()){A("#name_last").val(A("#name").val());A(".fs-labels").updateLabels(A("#singular_name").val(),A("#name").val());A(".fill").fill()}}};var k=function(){A("#name_warning").hide();var AF=true;if(A("#allow_multiple").length&&!A("#allow_multiple").is(":checked")){AF=false}if(M=="en"&&AF){if(A("#name").val()!=""&&A("#plural_name").val()!=""){var AG=A("#plural_name").val().singularize();if(AG!=A("#name").val()){A("#name_warning").show()}}}};var R=function(){A("#name_warning").hide();var AG=true;if(A("#allow_multiple").length&&!A("#allow_multiple").is(":checked")){AG=false}if(M=="en"&&AG){if(A("#name").val()!=""&&A("#singular_name").val()!=""){var AF=A("#singular_name").val().pluralize();if(AF!=A("#name").val()){A("#name_warning").show()}}}};var X=function(){if(M=="en"){var AF=A("#name").val();if(AF!=""){A("#plural_name").val(AF.pluralize())}k()}};var J=function(){if(M=="en"){var AF=A("#name").val();if(AF!=""){A("#singular_name").val(AF.singularize())}R()}};A(".fs .button-select-all").click(function(){A(this).closest(".fss,.fs").find("input.checkbox").attr("checked","checked").change();return false});A(".fs .button-select-none").click(function(){A(this).closest(".fss,.fs").find("input.checkbox").removeAttr("checked").change();return false});A(".fs .button-auto-fill").click(function(){A(this).closest(".fs").find("input.checkbox").attr("checked","checked").change();return false});A(".list .list-select-all").click(function(){A(this).closest(".list").find("input.checkbox").attr("checked","checked").change();return false});A(".list .list-select-none").click(function(){A(this).closest(".list").find("input.checkbox").removeAttr("checked").change();return false});if(A("#mpv-roles").length){A("#mpv-roles").find(".fs-tabs").mp_tabs();A("#name").change(function(){A("#display_name").fill()})}if(A(".mpv-templates-edit").length){var Q=function(){var AF=A("#supports_type_inherit").is(":checked");if(AF){A("#fs-supports-custom").hide()}else{A("#fs-supports-custom").show()}};A("#supports_type_inherit,#supports_type_custom").change(Q);Q()}if(A("#mpv-masterplan").length){A("#mpv-masterplan .fs-tabs").mp_tabs();function z(AG,AF){if(AF){A("."+AG+"-link-"+AF).show()}}function V(AG,AF){if(AF){A("."+AG+"-link-"+AF).hide()}}$ov=A(".mpv .fs-masterplan");$ov.find("li.editable.linkify").linkify();$ov.find(".taxonomies li").hover(function(){z("tax",A(this).data("name"))},function(){V("tax",A(this).data("name"))});$ov.find(".post-types li").hover(function(){z("post-type",A(this).data("name"))},function(){V("post-type",A(this).data("name"))});$ov.find(".roles li").hover(function(){z("role",A(this).data("name"))},function(){V("role",A(this).data("name"))});$ov.find(".shared-field-sets li").hover(function(){z("shared-field-set",A(this).data("name"))},function(){V("shared-field-set",A(this).data("name"))});A(".fsit input.checkbox").click(function(){var AG=A(this);var AH=AG.is(":checked");var AF=AG.closest(".fsi");var AI=AF.find(".fsic input.checkbox");if(AH){AI.attr("checked","checked")}else{AI.removeAttr("checked")}});A("#export_filename").autoGrowInput();var h=false;var x=false;A(".fs-masterplan .fs-tabs").bind("afterchange.mp_tabs",function(AF,AG){if(AG.panel.length&&AG.panel.attr("id")=="masterplan-export"){setTimeout(function(){A("#export_filename").autoGrowInput("update");if(!h){h=CodeMirror.fromTextArea(A("#export_readme").get(0),{theme:"sunburst",lineWrapping:true,mode:"markdown",lineNumbers:true})}},100)}if(AG.panel.length&&AG.panel.attr("id")=="masterplan-backup"){setTimeout(function(){A("#backup_filename").autoGrowInput("update");if(!x){x=CodeMirror.fromTextArea(A("#backup_readme").get(0),{theme:"sunburst",lineWrapping:true,mode:"markdown",lineNumbers:true})}},100)}});A("#export-select-all").click(function(){A(".fsic input.checkbox").attr("checked","checked");A(".fsit input.checkbox").attr("checked","checked")});A("#export-select-none").click(function(){A(".fsic input.checkbox").removeAttr("checked");A(".fsit input.checkbox").removeAttr("checked")});A(".fsic input.checkbox").click(function(){var AH=A(this);var AI=AH.is(":checked");var AG=AH.closest("li");var AK=AG.find("ul input.checkbox");if(AI){AK.attr("checked","checked")}else{AK.removeAttr("checked")}if(AI){var AJ=AH.closest("ul").closest("li");AJ.find(">input.checkbox").attr("checked","checked");var AF=AJ.closest("ul").closest("li");AF.find(">input.checkbox").attr("checked","checked")}});A("#masterplan-export form").bind("submit",function(AF){AF.preventDefault();var AG=A(this).serializeDeep();A("#export-ui").hide();A("#export-progress").show();A.mp.postToAction("masterplan.export",AG,function(AI){A("#export-progress").hide();if(AI.error){alert(AI.error);A("#export-ui").show()}else{var AH=A("#export-file-download");var AJ='<i class="zip"></i>'+sprintf(AH.data("message"),AI.filename);AH.attr("href",AI.url).html(AJ);if(AI["package"].icon_list.length||AI["package"].type_list.length){if(AI["package"].icon_list.length){A.each(AI["package"].icon_list,function(AK,AL){A("#extras-icons ul").append(A('<li style="background-image: url('+AL.url+')">'+AL.name+"</li>"))});A("#extras-icons").show()}if(AI["package"].type_list.length){A.each(AI["package"].type_list,function(AK,AL){A("#extras-types ul").append(A('<li style="background-image: url('+AL.icon+')">'+AL.key+"</li>"))});A("#extras-types").show()}else{A("#extras-types").hide()}A("#extras-summary").show()}A("#export-summary").show()}});return false});A("#masterplan-backup form").bind("submit",function(AF){AF.preventDefault();var AG=A(this).serializeDeep();var AH=A("#masterplan-export form").serializeDeep();AG.ref=AH.ref;A("#backup-ui").hide();A("#backup-progress").show();A.mp.postToAction("masterplan.backup",AG,function(AI){A("#backup-progress").hide();if(AI.error){alert(AI.error);A("#backup-ui").show()}else{if(AI["package"].icon_list.length||AI["package"].type_list.length){if(AI["package"].icon_list.length){A.each(AI["package"].icon_list,function(AJ,AK){A("#backup-extras-icons ul").append(A('<li style="background-image: url('+AK.url+')">'+AK.name+"</li>"))});A("#backup-extras-icons").show()}else{A("#backup-extras-icons").hide()}if(AI["package"].type_list.length){A.each(AI["package"].type_list,function(AJ,AK){A("#backup-extras-types ul").append(A('<li style="background-image: url('+AK.icon+')">'+AK.key+"</li>"))});A("#backup-extras-types").show()}else{A("#backup-extras-types").hide()}A("#backup-extras-summary").show()}A("#backup-summary").show()}});return false});A("#masterplan-import").find(".file-uploader").mp_file_uploader({method:"import_masterplan"}).bind("complete.mp_file_uploader",function(AG,AI){var AJ=A(this);AJ.find(".name").removeClass("name-none").html(AI.destinationFileName);A("#import-summary").hide();A("#label-import_file").hide();var AH=A("#masterplan-import").find(".file .name");AH.removeClass("error");A("#import-fetching-summary").show();var AF={filename:AI.destinationFileName};A.mp.action("masterplan.fetch_masterplan_summary",AF,function(AN){A("#import-fetching-summary").hide();if(AN.success){A("#import-masterplan").val(AI.destinationFileName);var AO=A("#import-rep");var AQ=AO.find(".fsi.post-types").hide();var AM=AO.find(".fsi.taxonomies").hide();var AK=AO.find(".fsi.shared-field-sets").hide();var AV=AO.find(".fsi.site-field-sets").hide();var AS=AO.find(".fsi.templates").hide();var AP=AO.find(".fsi.roles").hide();var AL=AN.base_url;var AT=AN.rep;var AR=function(AW){var AX=A();if(AW&&AW.length){AX=A("<ul>").addClass("field-sets");A.each(AW,function(AZ,Ad){var AY=A("<li>").addClass("field-set");var Ac=A("<span>").html(Ad.labels.name||Ad.name).addClass("label field-set").appendTo(AY);var Ab=A("<i></i>");if(Ad.allow_multiple=="1"){Ab.addClass("metabox-add-remove-large")}else{Ab.addClass("metabox-large")}Ac.prepend(Ab);AX.append(AY);if(Ad.fields&&Ad.fields.length){var Aa=A("<ul>").addClass("fields");A.each(Ad.fields,function(Af,Ah){if(!Ah.missing){var Ae=A("<li>").addClass("field");var Ag=A("<span>").html(Ah.labels.name||Ah.name).addClass("label field").appendTo(Ae);Ag.css("background-image","url("+Ah.icon_url+")");Aa.append(Ae)}});AY.append(Aa)}})}return AX};if(AT.post_types&&AT.post_types.length){AQ.show();var AU=AQ.find(".object-tree").empty();A.each(AT.post_types,function(AW,AX){var AY=A("<li></li>");$label=A("<span>").html(AX.labels.name||AX.name).addClass("label").appendTo(AY);$label.css("background-image","url("+AX.icon_url+")");AU.append(AY);AY.append(AR(AX.field_sets))})}if(AT.taxonomies&&AT.taxonomies.length){AM.show();var AU=AM.find(".object-tree").empty();A.each(AT.taxonomies,function(AW,AX){var AY=A("<li></li>");$label=A("<span>").html(AX.labels.name||AX.name).addClass("label").appendTo(AY);$label.css("background-image","url("+AX.icon_url+")");AU.append(AY);AY.append(AR(AX.field_sets))})}if(AT.shared_field_sets&&AT.shared_field_sets.length){AK.show();var AU=AK.find(".object-tree").empty();$field_sets=AR(AT.shared_field_sets);AU.append($field_sets.find(">li"))}if(AT.site_field_sets&&AT.site_field_sets.length){AV.show();var AU=AV.find(".object-tree").empty();$field_sets=AR(AT.site_field_sets);AU.append($field_sets.find(">li"))}if(AT.templates&&AT.templates.length){AS.show();var AU=AS.find(".object-tree").empty();A.each(AT.templates,function(AW,AX){var AY=A("<li></li>");$label=A('<label class="template"></label>').html('<i class="template"></i>'+AX.id);AY.append($label);AU.append(AY);AY.append(AR(AX.field_sets))})}if(AT.roles&&AT.roles.length){AP.show();var AU=AP.find(".object-tree").empty();A.each(AT.roles,function(AW,AY){var AX=A("<li></li>");$label=A('<label class="role"></label>').html('<i class="user-role"></i>'+AY.name);AX.append($label);AU.append(AX);AX.append(AR(AY.field_sets))})}if(AN.field_types&&AN.field_types.length){A("#f-types-overwrite").show()}A("#import-confirmation").show();A("#import-preview").show()}else{A("#label-import_file").show();alert(AN.error);AH.addClass("error")}})});A("#masterplan-restore form").submit(function(){if(A("#restore-masterplan").val()==""){alert(A("#restore-masterplan").data("empty"));return false}return true})}A("input.key").inputmask();if(A(".mpv-field-sets-form").length){A("#plural_name").change(v);A("#name").change(function(){J();v()});if(A("#name").length){R()}}if(A(".mpv-fields-form:not(.mpv-fields-delete)").length){A("#name").change(function(){f()})}if(A(".mpv-post-types-form,.mpv-taxonomies-form").length){A("#capability_type_custom_value").change(function(){A("#fw_capability_type_custom").find(".custom-fill").fill()});if(A("#capability_type_custom").is(":checked")){A("#fw_capability_type_custom").find(".custom-fill").fill()}var I=function(){A("#rewrite_slug").val(A("#plural_name").val().dasherize());A("#query_var").val(A("#name").val().dasherize())};A("#plural_name").change(function(){f()});A("#name").change(function(){X();f()})}A("#autofill-labels").click(function(){if(A("#plural_name").length){A(".fs-labels").updateLabels(A("#name").val(),A("#plural_name").val())}else{A(".fs-labels").updateLabels(A("#singular_name").val(),A("#name").val())}A(".fill").fill();return false});if(A(".mpv-post-types-edit").length){A("span.fill").fill();A("#plural_name_suggest").click(function(){X()})}if(A(".mpv-post-types-form").length){var q=A(".fs-capability-keys .fw");var e=function(){q.each(function(){var AF=A(this).find(".eg");AF.hide();if(A(this).find("input.radio").is(":checked")){AF.show()}})};q.find("input.radio").click(e);e()}if(A(".mpv-post-types-delete").length){var p=function(){if(A("#posts_reassign").is(":checked")||A("#posts_keep").is(":checked")||A("#posts_keep").length==0){A("#label_field_sets_keep").removeClass("disabled");A("#label_field_data_keep").removeClass("disabled");A("#field_sets_keep").removeAttr("disabled").attr("checked","checked");A("#field_data_keep").removeAttr("disabled").attr("checked","checked");A("#label_field_sets_delete").removeClass("disabled");A("#label_field_data_delete").removeClass("disabled");A("#field_data_delete").removeAttr("disabled");A("#field_sets_delete").removeAttr("disabled")}if(A("#posts_keep").length==0){A("#field_sets_delete").attr("checked","checked")}if(A("#posts_trash").is(":checked")){A("#label_field_sets_delete").addClass("disabled");A("#label_field_data_delete").addClass("disabled");A("#label_field_sets_keep").removeClass("disabled");A("#label_field_data_keep").removeClass("disabled");A("#field_data_delete").attr("disabled","disabled");A("#field_sets_delete").attr("disabled","disabled");A("#field_data_keep").removeAttr("disabled").attr("checked","checked");A("#field_sets_keep").removeAttr("disabled").attr("checked","checked")}if(A("#posts_delete").is(":checked")){A("#label_field_sets_keep").addClass("disabled");A("#label_field_data_keep").addClass("disabled");A("#label_field_sets_delete").removeClass("disabled");A("#label_field_data_delete").removeClass("disabled");A("#field_data_delete").removeAttr("disabled").attr("checked","checked");A("#field_sets_delete").removeAttr("disabled").attr("checked","checked");A("#field_data_keep").attr("disabled","disabled");A("#field_sets_keep").attr("disabled","disabled")}};A("#posts_reassign,#posts_keep,#posts_reassign_type,#posts_trash,#posts_delete").click(function(){p()});p()}if(A(".fs-visibility").length){if(A(".fsg-multisite").length){var U=function(){A("#visibility-sites-list").hide();var AF=A("#visibility-sites");if(A("#visibility-type-sites-allow").is(":checked")||A("#visibility-type-sites-deny").is(":checked")){A("#visibility-sites-list").show();if(!AF.data("has-select2")){AF.mp_select2({layout:"block"});AF=A("#visibility-sites");AF.data("has-select2",true)}}};A("#visibility-type-sites-allow,#visibility-type-sites-deny,#visibility-type-sites-all").click(U);U()}if(A(".fsg-templates").length){var l=function(){A("#visibility-templates-list").hide();if(A("#visibility-type-templates-allow").is(":checked")||A("#visibility-type-templates-deny").is(":checked")){A("#visibility-templates-list").show()}};A("#visibility-type-templates-allow,#visibility-type-templates-deny,#visibility-type-templates-all,#visibility-type-templates-none").click(l);l();var b=function(){if((A("#visibility-type-post-types-allow").is(":checked"))||(A("#visibility-type-post-types-deny").is(":checked"))||A("#visibility-type-post-types-all").is(":checked")){A(".fsg-templates").show()}else{}};A("#visibility-post-types-page,#visibility-type-post-types-all,#visibility-type-post-types-allow,#visibility-type-post-types-deny").click(b);b()}if(A(".fsg-fields").length){$vis_fields=A("#visibility-fields");$vis_fields.mp_select2();var D=function(){A("#visibility-fields-options").hide();if(A("#visibility-type-fields-allow").is(":checked")||A("#visibility-type-fields-deny").is(":checked")){A("#visibility-fields-options").show()}};A("#visibility-type-fields-allow,#visibility-type-fields-deny,#visibility-type-fields-none").click(D);D()}if(A(".fsg-roles").length){var n=function(){A("#visibility-roles-list").hide();if(A("#visibility-type-roles-allow").is(":checked")||A("#visibility-type-roles-deny").is(":checked")){A("#visibility-roles-list").show()}};A("#visibility-type-roles-allow,#visibility-type-roles-deny,#visibility-type-roles-all,#visibility-type-roles-none").click(n);n()}if(A(".fsg-taxonomies").length){var d=function(){A("#visibility-taxonomies-list").hide();if(A("#visibility-type-taxonomies-allow").is(":checked")||A("#visibility-type-taxonomies-deny").is(":checked")){A("#visibility-taxonomies-list").show()}};A("#visibility-type-taxonomies-allow,#visibility-type-taxonomies-deny,#visibility-type-taxonomies-all,#visibility-type-taxonomies-none").click(d);d()}if(A(".fsg-post-types").length){var m=function(){A("#visibility-post-types-list").hide();if(A("#visibility-type-post-types-allow").is(":checked")||A("#visibility-type-post-types-deny").is(":checked")){A("#visibility-post-types-list").show()}};A("#visibility-type-post-types-allow,#visibility-type-post-types-deny,#visibility-type-post-types-all").click(m);m()}}if(A(".mpv-taxonomies-form,.mpv-post-types-form").length){var B=A("#hierarchical");if(B.length){$hels=A(".hierarchical-only");var a=function(){if(B.is(":checked")){$hels.show()}else{$hels.hide()}};a();B.change(a)}}if(A(".mpv-taxonomies-create").length){var I=function(){A("#rewrite_slug").val(A("#name").val().dasherize());A("#query_var").val(A("#name").val().dasherize())};A("#plural_name").change(function(){f();I()});A("#name").change(function(){X();f();I()});X();f();I()}if(A(".mpv-taxonomies-delete").length){var p=function(){if(A("#existing_terms_reassign").is(":checked")||A("#existing_terms_keep").is(":checked")||A("#existing_terms_keep").length==0){A("#label_field_sets_keep").removeClass("disabled");A("#label_field_data_keep").removeClass("disabled");A("#field_sets_keep").removeAttr("disabled").attr("checked","checked");A("#field_data_keep").removeAttr("disabled").attr("checked","checked");A("#label_field_sets_delete").removeClass("disabled");A("#label_field_data_delete").removeClass("disabled");A("#field_data_delete").removeAttr("disabled");A("#field_sets_delete").removeAttr("disabled")}if(A("#existing_terms_keep").length==0){A("#field_sets_delete").attr("checked","checked")}if(A("#existing_terms_delete").is(":checked")){A("#label_field_sets_keep").addClass("disabled");A("#label_field_data_keep").addClass("disabled");A("#label_field_sets_delete").removeClass("disabled");A("#label_field_data_delete").removeClass("disabled");A("#field_data_delete").removeAttr("disabled").attr("checked","checked");A("#field_sets_delete").removeAttr("disabled").attr("checked","checked");A("#field_data_keep").attr("disabled","disabled");A("#field_sets_keep").attr("disabled","disabled")}};A("#existing_terms_reassign,#existing_terms_keep,#existing_terms_reassign_taxonomy,#existing_terms_delete").click(function(){p()});p()}A("select.check").bind("click change",function(){try{A(A(this).metadata({type:"class"}).el).attr("checked",true)}catch(AF){}});if(A(".mpv-fields-form").length){var AC=A(".fs-field-type-options");var W=A("#field-type-options-content");var AD=A("#field-type-loading");var O=A("#type");O.mp_select2();var N=function(AJ,AK){var AG=O;var AL=AG.mp_select2("val");var AH=AG.mp_select2("selection");if(AH){if(AH.icon){A("#f-position").find("li.current .icon").attr("class","icon "+AH.icon)}if(AH.description){A("#field-type-description").html(AH.description)}}var AI="mpft-"+AL+"-options";var AF=A("#"+AI);A(".mpft-options").hide().appendTo("body");if(!AF.length){clearTimeout(AD.data("lto"));AD.data("lto",setTimeout(function(){AD.show();W.hide()},100));A.mp.action("field.options",{type:AL},function(AO){clearTimeout(AD.data("lto"));var AN=true;AD.hide();if(AO.css_file){var AP="mpft-"+AO.type+"-options-css";var AM=A("#"+AP);if(!AM.length){AM=A("<link />").attr({id:AP,type:"text/css",href:AO.css_file,rel:"stylesheet"});A("html head").append(AM)}}AF=A("<div />").attr({"class":"mpft-options",id:AI}).append(AO.form);if(AO.form!=""){AF.data("hasOptions",true)}AF.show().appendTo(W);if(AO.js_file){AN=false;A.getScript(AO.js_file,function(){if(AF.html()!=""){AC.show()}else{AC.hide()}})}W.show();if(AN){if(AF.html()!=""){AC.show()}else{AC.hide()}}})}else{AF.show().appendTo(W);W.show();if(A.trim(AF.html())!=""){AC.show()}else{AC.hide()}}};O.bind("change.select2",N);N()}if(A(".mpv-post-types-form").length){var Z=function(){var AF=A(".fs-menu-options .sortable-list li.current");if(A("#disabled").is(":checked")){AF.addClass("disabled")}else{AF.removeClass("disabled")}};var AE=function(){var AF=A(".fs-menu-options");if(A("#show_in_menu").is(":checked")||!A("#show_in_menu").length){AF.show()}else{AF.hide()}};A("#show_in_menu").change(AE);A("#disabled").change(Z);Z();AE()}if(A(".mpv-field-sets-form").length){var Z=function(){var AF=A("#f-position .sortable-list li.current");if(A("#disabled").is(":checked")){AF.addClass("disabled")}else{AF.removeClass("disabled")}};A("#disabled").change(Z);var H=false;if(A(".mpv-edit-field-set").length){H=true}var L=function(){if(A("#allow_multiple").is(":checked")){if(!H){A("#expanded").removeAttr("checked")}J();v();A("#f-singular_name").show();A(".f-allow-multiple").show()}else{if(!H){A("#expanded").attr("checked","checked")}A("#f-singular_name").hide();A("#name_warning").hide();A(".f-allow-multiple").hide()}};A("#expanded").click(function(){H=true});A("#allow_multiple").change(function(){L();A(".sortable-list .fill").fill();R()});L()}A("#mpv-settings").each(function(){var AI=function(){if(A("#mp_cap_specific").is(":checked")){A("#specific-keys").show();A("#mp-grant").show()}else{A("#specific-keys").hide();A("#mp-grant").hide()}};A("#mp_cap_specific,#mp_cap_standard").click(AI);AI();A("#select-all-server-info").click(function(){A("#server-info").select()});var AF=A("#licence-progress");var AK=A("#licence_key");var AG=A("#licence-valid");var AJ=A("#licence-invalid");var AH=A("#licence-empty");function AL(){AK.val(A.trim(AK.val()));AF.show();A.mp.action("settings.validate_licence_key",{key:AK.val()},function(AM){AF.hide();if(AM&&AM.success){if(AM.valid){AJ.hide();AH.hide();AG.show()}else{AH.hide();AG.hide();AJ.find(".reason").html(" - "+AM.reason).end().show()}}})}A("#licence_key").change(AL)});if(A(".mpv-fields-form").length){var Z=function(){var AF=A("#f-position .sortable-list li.current");if(A("#disabled").is(":checked")){AF.addClass("disabled")}else{AF.removeClass("disabled")}};A("#disabled").change(Z);Z();A("#position").hide()}if(A(".mpv-post-types-manage-field-sets,.mpv-shared-field-sets-manage,.mpv-templates-manage-field-sets").length){$grids.find("tr.updated").nextAll("tr.summary").eq(0).find("a.create-field").focus()}}});A(window).load(function(){var B=A("table.grid tbody tr");var C=B.find(".update-text");if(C.length){C.effect("pulsate",{times:2})}var D=A("table.grid");$updated=D.find("tr.updated");if($updated.length){$gap=$updated.prev("tr.gap");if($gap.length){var E=$gap.position().top-10;A.scrollTo(E)}}})})(jQuery);(function(B){var C={sizeLimit:0,minSizeLimit:0,allowedExtensions:[],multiple:false,ids:{},classes:{},inputName:"file",selInput:"input",selUploader:".uploader-ui",lang:{buttonChoose:"Choose From Computer&hellip;",buttonReplace:"Replace From Computer&hellip;"}};var A="mp_file_uploader";B.fn[A]=function(){var F=this,G=this,H,E={},I={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){H=D[0]}else{E=D[0]}if(D.length>=2){I=D[1]}}if(this.length){this.each(function(){var T,O,Q,L=P,M={},S={},N=B(this);if(B.fn.metadata){S=N.metadata({type:"class"})}if(!H){Q=N.data(A);if(!Q){Q={};N.data(A,Q)}B.extend(true,M,C,E,S[A]||S||{});Q.options=M}else{Q=N.data(A);if(Q){M=Q.options}else{return }}T=function(){N[A].apply(N,arguments)};O=function(V,U){return N.trigger(jQuery.Event(V+"."+A),B.isArray(U)?U:[U])!==false};var R=function(U){var V=-1;do{U=U/1024;V++}while(U>99);return Math.max(U,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][V]};if(!H){Q.input=N.find(M.selInput);if(Q.input.length){Q.inputName=M.inputName;Q.dir=M.params.dir||M.dir||"";Q.baseURL=M.base_url;Q.uploader=N.find(M.selUploader);Q.file=M.file;if(!M.params&&M.dir){M.params={dir:M.dir}}if(Q.uploader.length){var P=B.extend(true,{},M.params,{nonce:mp_nonce,source_action:mp_action,controller:"files",method:"upload_field"},B.mp.context());if(M.method){P.method=M.method}var K=[];if(M.allowedExtensions){if(!B.isArray(M.allowedExtensions)){K=M.allowedExtensions.split(",")}else{K=M.allowedExtensions}}P.object_id=B.mp.object_id;P.object_type=B.mp.object_type;P.object_type_name=B.mp.object_type_name;P.model_id=M.model_id;var J={sizeLimit:M.sizeLimit,allowedExtensions:K,inputName:Q.inputName,element:Q.uploader.get(0),action:mp_ajax_url,ids:M.ids,params:P,onSubmit:function(V,U){O("submit",{id:V,fileName:U})},onProgress:function(Y,X,U,V){var W={fileName:X,loadedBytes:U,totalBytes:V,total:R(V),loaded:R(U),percent:Math.round((U/V)*100)};O("progress",W)},onComplete:function(X,W,V){$fi=Q.button.find("input");Q.buttonLabel.html(M.lang.buttonReplace);var U={input:Q.input,baseURL:Q.baseURL,dir:V.dir,sourceFileName:W,response:V};if(V.filename){U.destinationFileName=V.filename;if(!M.manualSet){Q.input.val(V.filename)}}if(V.success){U.url=U.baseURL+U.dir.replace(/\\/g,"/")+U.destinationFileName}O("complete",U)}};J.template='<div class="qq-uploader"><div class="qq-upload-button"><span>'+M.lang.buttonChoose+'</span></div><ul class="qq-upload-list"></ul></div>';Q.uploader=new qq.FileUploader(J);Q.button=N.find(".qq-upload-button");Q.buttonLabel=Q.button.find("span")}}}else{if(H=="clear"){Q.input.val("");Q.buttonLabel.html(M.lang.buttonChoose)}else{if(H=="destroy"){N.data(A,null)}}}})}return F};B.fn[A].defaults=C})(jQuery);(function(A){A.widget("ui.mpft",{options:{autoSummary:true},_create:function(){this.properties={};this.dialogs={};var B=this;var C=this.options.field.metadata({type:"class"});this.name=C.name;this.ui_options=C.ui;this.model_id=C.model_id;if(this.onfirstexpand){if(this.expanded()){this.onfirstexpand();B.bind_change()}else{this.options.set_item.one("mp_set_itemexpand",function(){B.onfirstexpand.apply(B);B.bind_change.apply(B)})}}if(this.ontoggleexpand){this.options.set.bind("mp_set_toggleexpand",function(){B.ontoggleexpand.apply(B)})}if(this.onexpand){if(this.expanded()){this.onexpand()}this.options.set_item.bind("mp_set_itemexpand",function(){B.onexpand.apply(B)})}},setup_dialog:function(D,E,C){var B=this;var G=E.data("title");var F=A.extend(true,{closeOnEnter:true,closeOnEscape:true,width:560,resizable:false,modal:true},C,{dialogClass:"aristo wp-dialog",autoOpen:false,title:G});F.close=function(){B.element.find(".dialogs").append(E);if(C.close){C.close}};if(F.closeOnEnter){E.find("input.text").bind("keypress",function(H){if(H.which==A.ui.keyCode.ENTER){E.dialog("close");return false}})}B.dialogs[D]=E.dialog(F);B.element.find(".dialogs").append(B.dialogs[D])},clear:function(){},hasAutoSummary:function(){return this.options.autoSummary},show_dialog:function(B){var C=this.dialogs[B];if(C){C.dialog("widget").find(".ui-dialog-titlebar").after(C);C.dialog("open")}},focus:function(){return false},can_focus:function(){return true},set_value:function(B){},bind_change:function(){var B=this;this.element.find("input[type=text],textarea").live("keydown",function(C){if(!A(this).attr("readonly")){B.set_change()}});this.element.find("select").bind("change",function(C){B.set_change()});this.element.find("input[type=checkbox],input[type=radio]").bind("click",function(C){B.set_change()})},cache:function(B){if(B){A.extend(true,this.ui,B)}},focus_field:function(){var B=this;if(B.options.field){B.options.field.mp_field("focus")}},blur:function(){},label_text:function(){return this.options.field_item.find(".mp-field-label").data("label")},start_busy:function(){var B=this.summary_item();if(B&&B.length){B.addClass("busy")}},end_busy:function(){var B=this.summary_item();if(B&&B.length){B.removeClass("busy");this.update_summary()}},lang:function(B){if(!this.md_lang){this.md_lang=this.options.field.metadata({type:"class"}).lang||{}}if(!this.ui_lang){this.ui_lang=A.mpft_lang[this.options.field.metadata({type:"class"}).type]||{}}return this.ui_lang[B]||this.md_lang[B]},prop:function(B,C){if(!this.properties[B]){this.properties[B]=this.element.find("input.prop-"+B)}if(C!=null){this.properties[B].val(C)}return this.properties[B]},prop_val:function(B){var C=this.prop(B);if(C&&C.length){return this.prop(B).val()}return""},method:function(E,C,D,B){if(B){return A.mp.postToAction("mpft.dispatch",A.extend(true,{},C,{type:this.field_type,type_method:E}),D)}else{return A.mp.action("mpft.dispatch",A.extend(true,{},C,{type:this.field_type,type_method:E}),D)}},ajax:function(D,B,C){return this.method(D,B,C)},summary_item:function(){return this.options.field.mp_field("summary_item")},update_summary:function(){this.options.field.mp_field("updateSummary")},summary:function(){return""},is_multiple:function(){return this.options.set.hasClass("multiple")},change:function(){},set_change:function(){this.change();if(this.options.set){this.options.set.mp_set("change")}},expand:function(){if(this.options.set_item){return this.options.set_item.mp_set_item("expand")}},collapse:function(){if(this.options.set_item){return this.options.set_item.mp_set_item("collapse")}},expanded:function(){if(this.options.set_item){return this.options.set_item.mp_set_item("expanded")}},is_empty:function(){return true},destroy:function(){A.Widget.prototype.destroy.call(this)}});A.widget("ui.mpft_select",A.ui.mpft,{cache_ui:function(){this.ui=this.ui||{select:this.element.find("select")}},onfirstexpand:function(){var B=this;this.cache_ui();this.init_select2()},focus:function(){this.ui.select.mp_select2("focus");return true},value:function(){this.cache_ui();if(this.is_basic()){return this.ui.select.val()}else{this.init_select2();return this.ui.select.mp_select2("val")}},is_basic:function(){return this.ui_options.basic},set_value:function(B){this.cache_ui();if(this.is_basic()){this.ui.select.val(B)}else{this.init_select2();this.ui.select.mp_select2("val",B)}},init_select2:function(){var B=this;if(!this.is_basic()&&!this.select2_inited){var C={refresh:true};if(this.ui_options.multi_layout=="block"){C.layout="block"}if(parseInt(this.ui_options.results_input_length)){C.minimumInputLength=parseInt(this.ui_options.results_input_length)}this.select2_inited=true;this.ui.select.addClass("select2-source");if(this.ui.select.is(":disabled")){C.disabled=true}this.ui.select.mp_select2(C)}},is_empty:function(){var B=this.value();return A.trim(B)==""},summary:function(){var C=[];if(this.is_basic()){var B=this.ui.select.find("option:selected");B.each(function(){C.push(A(this).html())})}else{var C=this.ui.select.mp_select2("labels")}return C.join(", ")}})})(jQuery);(function(B){var A=function(){B("#ajax-loading").hide();B("#draft-ajax-loading").hide();B("#publish").removeClass("button-primary-disabled")};B(document).ready(function(){var C=B(".postbox .inside > .mp-set").mp_set();B("#major-publishing-actions").after(B("#invalid-fields-publish-message-template").html());B("#major-publishing-actions").after(B("#title-publish-message-template").html());B("#post").submit(function(){B("#title-publish-message").hide();if(!B("#title").length){return true}if(!B.trim(B("#title").val())){B("#title-publish-message").show();B("#title").addClass("error");B("#publishing-action .spinner").hide();A();return false}return true});if(B("#mp-attributes").length&&B("#pageparentdiv").length){B("#pageparentdiv").hide().find("input,select").attr("disabled","disabled");B("#adv-settings").find("label[for=pageparentdiv-hide]").hide()}B("#mp-attributes select[name=page_template]").change(function(){var G=Handlebars.compile(B("#mp-postbox-template").html());var K=B("#normal-sortables");var I=B(this).val();var F=B(this).find("option:selected").data("sets").toString();var H=[];if(B.trim(F)!=""){H=F.split(",")}var D=B(this).find("option:selected").data("supports").toString().split(",");var E=[];B.each(H,function(L,M){$set=B(".mp-set-"+M);if(!$set.length){E.push(M)}else{$set.closest(".postbox").show()}});var J=[];B(".mp-set").each(function(){var M=B(this).attr("class").match(/mp-set-([0-9]+)/);if(M.length){var L=M[1];if(!(B.inArray(L,H)!=-1)){B(this).closest(".postbox").hide()}}});if(E.length){B("#mp-templates-loading-fields").show();B.mp.action("post.get_sets",{template:I,set_ids:E,object_id:B.mp.object_id},function(L){B("#mp-templates-loading-fields").hide();if(L.success){B.each(L.sets,function(N,O){B("body").append(O.templates);var M=B(G(O));M.css("background","#FFF");M.find(".inside").css({padding:0,margin:0});K.prepend(M);M.find(".mp-set").mp_set()})}})}});B(".mp-go").click(function(){var D=true;if(C.filter(".is-dirty").length){D=confirm(jQuery.mp.lang.confirm_go)}return D});B("#addtag #submit").click(function(){setTimeout(function(){if(!B("#addtag .form-invalid").length){B("#addtag .mp-set").each(function(){var D=B(this);D.mp_set("lazyload");if(D.hasClass("multiple")){D.find(".mp-set-item").remove()}else{D.find(".mp-field").mp_field("clear")}D.mp_set("updateCount").mp_set("updateIndexes").mp_set("updateCheckedControls").mp_set("updateControls");B(".save-nag").hide()})}},100)})});B.widget("ui.mp_set",{_create:function(){var C=this;this.multiple=this.element.hasClass("multiple");if(this.multiple){this.items=this.element.find("> .mp-set-inner > .mp-set-items > .mp-set-item")}else{this.items=this.element.find("> .mp-set-inner > .mp-set-item")}this.meta=this.element.metadata({type:"class"});this.lang=this.meta.lang;this.name=this.meta.name;this.postbox=this.element.closest(".postbox");this.postbox.find("h3.hndle").click(function(){setTimeout(function(){if(!C.postbox.hasClass("closed")){C.element.trigger("mp_set_toggleexpand")}},50)});this.preview=this.options.preview;this.readonly=this.element.hasClass("readonly");this.metabox=this.element.closest(".postbox");this.save_nag=this.element.find(".save-nag");this.save_nag.appendTo(this.metabox);this.itemOptions={preview:this.preview,readonly:this.readonly,multiple:this.multiple,expand:function(E,F){C.updateControls()},collapse:function(E,F){C.updateControls()},remove:function(E,F){C.onremove()},check:function(E,F){C.updateCheckedControls()},uncheck:function(E,F){C.updateCheckedControls()},lang:this.lang,set:this.element};if(C.options.addItemTemplate){C.addItemTemplate=Handlebars.compile(C.options.addItemTemplate)}if(this.preview){this.items.mp_set_item(this.itemOptions)}else{this.items.filter(".expanded").mp_set_item(this.itemOptions);var D;if(C.multiple){D=this.element.find(".mp-set-items")}else{D=this.element.find(".mp-set-item")}D.click(function(K){var H=B(K.target);var G=H.closest(".mp-set-summary");var I=H.closest(".mp-set-item");if(!I.data("loaded")){if(G.length){I.mp_set_item(C.itemOptions).mp_set_item("summary_click",K)}else{var F=H.closest(".mp-controls");if(F.length){if(H.closest(".control-toggle").length){I.mp_set_item(C.itemOptions).mp_set_item("expand")}else{if(H.closest(".control-remove").length){var E=true;if(!K.shiftKey){E=confirm(C.lang.remove_confirm)}if(E){I.remove();C.onremove()}}else{if(H.closest(".control-check").length){var J;if(H.is("input")){J=H}else{J=H.find("input");if(J.is(":checked")){J.removeAttr("checked")}else{J.attr("checked","checked")}}if(J.is(":checked")){I.addClass("checked")}else{I.removeClass("checked")}C.updateCheckedControls()}}}}}}})}this.controls={head:this.element.find("> .mp-set-inner > .mp-set-head"),foot:this.element.find("> .mp-set-inner > .mp-set-foot")};if(this.multiple){this.controls.copyPaste=this.controls.foot.find(".copy-paste").add(this.controls.head.find(".copy-paste"));this.controls.versions=this.controls.foot.find(".versions").add(this.controls.head.find(".versions"))}else{this.controls.copyPaste=this.items.eq(0).find("> .mp-controls .copy-paste");this.controls.versions=this.items.eq(0).find("> .mp-controls .versions")}this.controls.expandAll=this.controls.head.find(".expand-all");this.controls.collapseAll=this.controls.head.find(".collapse-all");this.controls.addItem=this.controls.head.find(".add-set-item");this.controls.addItemFoot=this.controls.foot.find(".add-set-item");this.controls.removeChecked=this.controls.head.find(".remove-checked");this.controls.itemCount=this.controls.head.find(".set-item-count").add(this.controls.foot.find(".set-item-count"));this.controls.checkAllWrap=this.controls.head.find(".control-check-all");this.controls.checkAll=this.controls.head.find(".control-check-all input");this.controls.copyPaste.bind("click",function(){C.copyPaste()});this.controls.expandAll.bind("click",function(){C.expand()});this.controls.collapseAll.bind("click",function(){if(!B(this).hasClass("disabled")){C.collapse()}});this.controls.versions.bind("click",function(){C.versions()});this.controls.checkAllWrap.bind("click",function(){if(!C.controls.checkAll.is(":checked")){C.check()}else{C.uncheck()}});this.controls.checkAll.bind("click",function(E){if(C.controls.checkAll.is(":checked")){C.check()}else{C.uncheck()}E.stopPropagation()});this.controls.removeChecked.bind({click:function(E){C.items.filter(".checked").addClass("to-remove");if(confirm(B.mp.lang.confirm_remove_checked_items)){C.removingChecked=true;C.items.filter(".checked").mp_set_item(C.itemOptions).mp_set_item("remove",true);setTimeout(function(){C.removingChecked=false;C.updateIndexes();C.updateCount();C.updateCheckedControls();C.updateControls();if(!C.items.length){C.uncheck()}},10)}},mouseenter:function(E){C.items.filter(".checked").addClass("to-remove")},mouseleave:function(E){C.items.filter(".checked").removeClass("to-remove")}});this.controls.head.find(".add-set-item").bind({mouseover:function(){C.controls.head.addClass("hover")}});this.controls.addItem.bind("click",function(E){C.add(E,null,"top");E.stopPropagation()});this.controls.addItemFoot.bind("click",function(E){C.add(E);E.stopPropagation()});if(!this.preview&&!this.readonly){this.controls.foot.bind("click",function(E){if(!B(E.target).closest("a,button:not(.add-set-item),input").length){C.add(E)}});this.controls.head.bind({click:function(E){if(!B(E.target).closest(".control-check-all,a,button:not(.add-set-item),input").length){C.add(E,null,"top")}},mouseover:function(E){if(!B(E.target).closest(".control-check-all,button,input").length){C.controls.head.addClass("hover")}},mouseout:function(E){C.controls.head.removeClass("hover")}})}if(!this.preview&&!this.readonly&&this.multiple){this.element.sortable({items:".mp-set-item",axis:"y",handle:".set-index",distance:10,tolerance:"pointer",revert:40,stop:function(){C.updateIndexes()}})}},lazyload:function(){var C=this;if(!C.element.data("loaded")){C.items.mp_set_item(C.itemOptions);C.element.data("loaded",true)}},onremove:function(){var C=this;if(!C.removingChecked){C.updateIndexes();C.updateCount();C.updateCheckedControls();C.change()}},saveNag:function(){if(!this.nagVisible){var C=B("#publish").val();this.save_nag.find(".update").html(C);this.save_nag.fadeIn("fast");this.nagVisible=true}},markDirty:function(){this.element.addClass("is-dirty");this.element.find(".dirty").removeAttr("disabled")},count:function(){return this.items.length},change:function(){if(!this.preview&&!this.readonly){this.saveNag();this.markDirty()}},reinit:function(){},is_preview:function(){return this.preview},add:function(D,H,L){var M=this;if(!M.addItemTemplate){var E=M.meta.name||M.element.data("name");var F="mpft_ui_"+E;if(M.element.data("add_item_template")){F=M.element.data("add_item_template")}var J=B("#"+F);if(J.length){var I=J.html().replace(/!!(.+?)!!/gi,"{{$1}}");M.addItemTemplate=Handlebars.compile(I)}else{throw ("A template could not be found for this field set")}}if(M.addItemTemplate){var C=M.items.length;M.items.find("> .set-index").each(function(){C=Math.max(C,parseInt(B(this).val()))});var G=B(M.addItemTemplate({set_index:C+1}));var K=M.element.find("> .mp-set-inner > .mp-set-items");if(L=="top"){G.prependTo(K)}else{G.appendTo(K)}G.mp_set_item(B.extend(true,{},M.itemOptions,{data:H}));if(!M.preview){G.mp_set_item("markAdded")}G.find(".mp-tooltip-icon,.with-mptt").mp_tooltip();if(D&&D.altKey){M.items.mp_set_item("collapse")}M.items=M.items.add(G);M.updateCount();M.updateIndexes();if(D&&!D.shiftKey){G.mp_set_item("expand");G.mp_set_item("focus")}M.change()}},updateIndexes:function(){var C=this;if(this.multiple){C.items=this.element.find("> .mp-set-inner > .mp-set-items > .mp-set-item")}else{C.items=this.element.find("> .mp-set-inner > .mp-set-item")}C.items.each(function(H,I){var F=B(I);var K=F.attr("class");var E=K.replace(/mp-set-item-\d/,"mp-set-item-"+(H+1));F.attr("class",E);F.find(".set-index span").html(H+1);var D=F.find(".set-index:first").val();var G=F.find(".set-order:first").attr("name");var J=G.replace(/\[\d+\]$/i,"["+(H+1)+"]");F.find(".set-order").attr("name",J).val(D)})},updateCount:function(){if(!this.preview&&!this.readonly){if(this.items.length){this.controls.head.show();this.controls.addItem.attr("title",this.lang.add_another);this.controls.foot.attr("title",this.lang.add_another);this.controls.head.attr("title",this.lang.add_another);this.controls.foot.find(".rt").hide()}else{this.controls.addItem.attr("title",this.lang.click_to_add);this.controls.foot.attr("title",this.lang.click_to_add);this.controls.head.attr("title",this.lang.click_to_add);this.controls.head.hide();this.controls.foot.find(".rt").show()}}this.controls.itemCount.html(B.mp.itemCount(this.items.length,this.lang.item,this.lang.items,this.lang.no_items))},updateControls:function(){if(this.items.length==0){this.uncheck()}if(this.items.length==this.items.filter(".collapsed").length){this.controls.collapseAll.addClass("disabled").attr("disabled","disabled")}else{this.controls.collapseAll.removeClass("disabled").removeAttr("disabled")}if(this.items.length==this.items.filter(".expanded").length){this.controls.expandAll.addClass("disabled").attr("disabled","disabled")}else{this.controls.expandAll.removeClass("disabled").removeAttr("disabled")}},updateCheckedControls:function(){var C=this;if(!C.items.filter(".checked").length){C.disableCheckedControls()}else{C.enableCheckedControls()}},enableCheckedControls:function(){var C=this;C.controls.removeChecked.removeClass("disabled").removeAttr("disabled").attr("title",B.mp.lang.remove_checked_items)},disableCheckedControls:function(){var C=this;C.controls.removeChecked.addClass("disabled").attr("disabled","disabled").removeAttr("title")},check:function(){this.lazyload();var C=this;C.controls.checkAll.attr("checked","checked");C.items.mp_set_item("check");if(C.items.length>0){C.enableCheckedControls()}C.updateCount()},uncheck:function(){this.lazyload();var C=this;C.controls.checkAll.removeAttr("checked");C.items.mp_set_item("uncheck");C.disableCheckedControls();C.updateCount()},collapse:function(){this.lazyload();this.items.mp_set_item("collapse");this.controls.expandAll.focus();this.updateControls();this._trigger("collapse")},expand:function(){this.lazyload();this.items.mp_set_item("expand");this.controls.collapseAll.focus();this.updateControls();this._trigger("expand")},value:function(F,D,G){var C=this;if(F==null){if(this.multiple){var E=[];this.items.each(function(H,I){E.push(B(I).mp_set_item("value"))});return E}else{return this.items.eq(0).mp_set_item("value")}}else{if(B.isArray(F)){if(C.multiple){if(D){this.items.mp_set_item("remove")}B.each(F,function(H,I){C.add(false,I)})}else{this.items.eq(0).mp_set_item("value",F[0],G)}}else{if(typeof (F)=="object"){this.items.eq(0).mp_set_item("value",F,G)}}}},to_json:function(C){if(!C){C=2}var D=this.value();return JSON.stringify(D,false,C)},fetch_version:function(){var C=this;this.versions=this.versions||[];var E=this.versionsSelect.val();if(C.activeVersion!=E){if(!this.versions[E]){C.versionsLoading.show();var D={id:E};if(!C.previewTemplate){D.model_id=C.element.data("model_id");D.fetch_template=true}B.mp.action("meta.get_version",D,function(F){if(F.success){if(F.template){C.previewTemplate=F.template}C.versions[E]=F.value}C.versionsLoading.hide();C.activeVersion=E;C.show_preview(C.versions[E])})}else{C.show_preview(C.versions[E]);C.activeVersion=E}}},show_preview:function(F){var D=this;var C=D.multiple;if(D.previewTemplate){D.versionPreview.find(".mp-set").remove();if(C){var G=B(D.setMultipleTemplate)}else{var G=B(D.setTemplate);D.prevewTemplateHB=D.prevewTemplateHB||Handlebars.compile(D.previewTemplate);G.find(".mp-set-inner").append(D.prevewTemplateHB({set_index:1}));if(F.length){F=F[0]}}G.data("name",D.meta.name);D.versionRestore.hide();D.versionPreview.append(G);G.mp_set({preview:true,addItemTemplate:D.previewTemplate});G.mp_set("value",F);if(F.length||!C){D.versionContent.show();D.versionNoData.hide()}else{D.versionContent.hide();D.versionNoData.show()}$versionCheckboxes=G.find("input.checkbox");function E(){if($versionCheckboxes.filter(":checked").length){D.versionRestore.show()}else{D.versionRestore.hide()}}if(C){D.versionPreview.find(".control-check,.control-check-all,input.checkbox").bind("click",function(){E()});D.versionRestore.unbind("click").click(function(){var H=[];G.find(".mp-set-item").each(function(J,I){var K=B(I);if(K.find(".mp-controls input.checkbox").is(":checked")){H.push(K.mp_set_item("value"))}});if(H.length){D.value(H);D.change()}D.versionsPanel.dialog("close");return false})}else{D.versionRestore.show();D.versionRestore.unbind("click").click(function(){if(confirm("Restore set: are you sure? Any current changes to this set will be lost.")){D.value(G.find(".mp-set-item").mp_set_item("value"),false,true);D.versionsPanel.dialog("close")}return false})}}else{alert("The preview could not be displayed")}},versions:function(){var C=this;C.lazyload();C.setTemplate=C.setTemplate||B("#mp-set-preview-template").html();C.setMultipleTemplate=C.setMultipleTemplate||B("#mp-set-preview-multiple-template").html();C.versionsPanel=C.versionsPanel||C.element.find(".mp-set-versions:first");C.versionsPanel.show();if(!C.versionsSelect){C.versionsSelect=C.versionsSelect||C.versionsPanel.find("select");C.versionsSelect.mp_select2();C.versionsSelect.change(function(){C.fetch_version()});C.versionRestore=C.versionsPanel.find(".restore");C.versionContent=C.versionsPanel.find(".version-content");C.versionPreview=C.versionsPanel.find(".version-preview");C.versionNoData=C.versionsPanel.find(".version-no-data");C.versionsLoading=C.versionsPanel.find(".loading")}var D={closeOnEscape:false,width:"90%",height:"auto",resizable:false,modal:true,dialogClass:"aristo versions-dialog wp-dialog",autoOpen:true,title:C.versionsPanel.data("title")};function E(){var F=Math.max(B(window).height()-360,300);C.versionPreview.css("height",F);D.height=F+214}E();C.versionsPanel.dialog(D);C.versionsSelect.mp_select2("focus");C.fetch_version();C.versionsWidget=C.versionsWidget||C.versionsPanel.dialog("widget");C.versionsWidget.affix({w:"c"});return false},copyPaste:function(){this.lazyload();var C=this;C.cpPanel=C.cpPanel||C.element.find(".mp-set-copy-paste:first");C.cpPanel.show();C.copyRep=C.copyRep||C.cpPanel.find("textarea").get(0);C.copyRep.value=this.to_json();C.copyPanel=C.copyPanel||C.cpPanel.find(".copy-content");C.pastePanel=C.pastePanel||C.cpPanel.find(".paste-content");var E={closeOnEscape:true,width:"80%",height:"auto",resizable:false,modal:true,dialogClass:"aristo wp-dialog",autoOpen:true,title:C.cpPanel.data("title"),buttons:{OK:function(){if(C.pastePanel.hasClass("current")){var H=B(C.pasteRep).val();var G=B.parseJSON(H);try{if(G){C.value(G)}}catch(F){console.log(F)}}B(this).dialog("close")}}};C.cpPanel.dialog(E);C.cpPanel.dialog("widget").affix({w:"c"});var D=function(){C.copyRep.focus();C.copyRep.select()};if(!C.cpTabs){C.cpTabs=C.cpPanel.find(".fs-tabs");C.cpTabs.mp_tabs();C.cpTabs.bind("afterchange.mp_tabs",function(F,G){if(G.panel.length&&G.panel.hasClass("paste-content")){setTimeout(function(){if(!C.pasteRep){C.pasteRep=C.pasteRep||G.panel.find("textarea").get(0)}C.pasteRep.focus();C.pasteRep.select()},100)}else{D()}})}if(C.items.length){C.cpTabs.mp_tabs("select",{index:0})}else{C.cpTabs.mp_tabs("select",{index:1})}return false},destroy:function(){B.Widget.prototype.destroy.call(this)}});B.widget("ui.mp_set_item",{_create:function(E){var C=this;if(!C.element.data("loaded")){C.element.data("loaded",true);this.preview=this.options.preview;this.readonly=this.options.preview;this.fields=C.element.find("> .mp-set-fields > .mp-field");this.fieldOptions={set:this.options.set,set_item:this.element,beforefocus:function(){C.fields.mp_field("blur")}};var D=null;var E=C.options.data||{};C.fields.each(function(){var G=null;var F=B(this).metadata({type:"class"}).name;if(E[F]&&E[F].value){G=E[F].value}B(this).mp_field(B.extend(true,{},C.fieldOptions,{value:G}))});C.required_fields=C.fields.filter(".required");if(C.required_fields.length){C.element.closest("form").submit(B.proxy(C.formsubmit,this))}this.controls={toggle:this.element.find(".toggle:first"),removeItem:this.element.find(".remove-set-item:first"),checkWrap:this.element.find(".control-check:first"),check:this.element.find(".control-check:first input"),summary:this.element.find(".mp-set-summary:first"),fields:this.element.find(".mp-set-fields")};this.controls.fieldsCollapse=this.controls.fields.find(".collapse,.collapse-lower");this.lang=this.options.lang;this.controls.toggle.bind("click",function(F){if(B(this).hasClass("expand")){C.expand()}else{C.collapse()}});this.controls.fieldsCollapse.bind("click",function(F){C.collapse();C.controls.toggle.focus();if(!C.preview&&C.element.hasClass("single")){B.scrollTo(C.element.closest(".postbox"),{duration:0,offset:-50})}});if(this.options.multiple){this.controls.checkWrap.bind("click",function(F){if(!C.controls.check.is(":checked")){C.check()}else{C.uncheck()}});this.controls.check.bind("click",function(F){if(C.controls.check.is(":checked")){C.check()}else{C.uncheck()}F.stopPropagation()});this.controls.removeItem.bind({click:function(G){var F=true;if(!G.shiftKey){F=confirm(C.lang.remove_confirm)}if(F){C.remove()}G.stopPropagation()},mouseenter:function(){C.element.addClass("to-remove")},mouseleave:function(){C.element.removeClass("to-remove")}})}this.controls.summary.bind({click:function(F){C.summary_click(F)},mouseenter:function(){if(C.element.hasClass("collapsed")&&!C.element.hasClass("ui-sortable-helper")){C.controls.toggle.addClass("hover")}},mouseleave:function(){C.controls.toggle.removeClass("hover")}})}},summary_click:function(G){var D=this;D.expand();var F=B(G.target).closest(".mp-field-summary");if(F&&F.length){var C=F.metadata({type:"class"}).mp_field_id;try{var E=B("#"+C);var I=-(B(window).height()/2)+(E.innerHeight()/2);if(!D.preview){B.scrollTo(E,{duration:200,easing:"easeOutQuart",offset:I,onAfter:function(){E.mp_field("focusControl")}})}}catch(H){}}},is_preview:function(){return self.element.closest(".mp_set").mp_set("is_preview")},formsubmit:function(){var C=this;C.required_fields=C.fields.filter(".required");B("#invalid-fields-publish-message").hide();var E=B();var D=B();C.required_fields.each(function(){var G=B(this);var F=G.mp_field("summary_item");if(!C.expanded()){if(F.hasClass("empty")){D=D.add(F);E=E.add(G)}}else{if(G.mp_field("isEmpty")){D=D.add(F);E=E.add(G)}}});E.addClass("invalid");D.addClass("invalid");if(E.length){A();if(B("#invalid-fields-publish-message").length){B("#invalid-fields-publish-message").show();B.scrollTo(B("#invalid-fields-publish-message"),{offset:-50})}return false}},remove:function(E){var D=this;var C=this.element;C.hide();D.destroy();D.element.remove();D._trigger("remove")},check:function(){var C=this;C.controls.check.attr("checked","checked");this._updateCheckedDisplay();C._trigger("check",null,{checkbox:C.controls.check})},uncheck:function(){var C=this;C.controls.check.removeAttr("checked");this._updateCheckedDisplay();C._trigger("uncheck",null,{checkbox:C.controls.check})},_updateCheckedDisplay:function(){var C=this;if(C.controls.check.is(":checked")){C.element.addClass("checked")}else{C.element.removeClass("checked")}},collapse:function(){if(this.expanded()){this.element.closest(".mp-set-item").removeClass("expanded").addClass("collapsed").find(".toggle:first").removeClass("collapse").addClass("expand").end().find(".mp-set-fields:first").hide().end().find(".mp-set-summary:first").show();this._trigger("collapse");this.fields.mp_field("updateSummary");this.updateColor()}},markAdded:function(){this.element.addClass("added")},unmarkAdded:function(){this.element.removeClass("added")},focus:function(){this.fields.eq(0).mp_field("focusControl")},expand:function(){this.element.closest(".mp-set-item").addClass("expanded").removeClass("collapsed").find(".toggle:first").removeClass("expand").addClass("collapse").end().find(".mp-set-summary:first").hide().end().find(".mp-set-fields:first").show();this._trigger("expand")},expanded:function(){return this.element.hasClass("expanded")},value:function(D,E){if(D==null){var C={};this.fields.each(function(G,H){var F=B(H).data("name");if(F){C[F]=B(H).mp_field("value")}});return C}else{this.fields.each(function(){var F=B(this).metadata({type:"class"}).name;if((D[F]&&D[F].value)||E){B(this).mp_field("value",D[F].value)}})}},updateColor:function(){if(this.controls.summary.find(".mp-field-summary:last").hasClass("empty")){this.controls.summary.addClass("last-empty")}else{this.controls.summary.removeClass("last-empty")}},destroy:function(){var C=this;C.element.closest("form").unbind("submit",this.formsubmit);B.Widget.prototype.destroy.call(this)}});B.widget("ui.mp_field",{options:{value:0},_create:function(){var C=this;C.element.data("loaded",true);this.controls={ui:this.element.find(".mp-field-ui")};this.meta=this.element.metadata({type:"class"});this.lang=this.meta.lang;this.type=this.meta.type;this.type_widget=this.meta.type_widget;this.name=this.meta.name;this.set=this.options.set;this.set_item=this.options.set_item;try{this.controls.summary_item=B(this.meta.summary_id);if(this.controls.summary_item.length){this.controls.value_summary=this.controls.summary_item.find(".value-summary");this.controls.empty_summary=this.controls.summary_item.find(".empty-summary")}}catch(E){this.controls.summary_summary=B();this.controls.value_summary=B();this.controls.empty_summary=B()}if(B.fn[this.type_widget]){this.mpft_widget=this.controls.ui[this.type_widget];this.mpft_widget.apply(this.controls.ui,[{field:this.element,set:this.set,set_item:this.set_item}])}this.element.delegate("a,input,textarea,button,select","focusout",function(F){C.blur()});this.element.delegate("a,input,textarea,button,select","focusin",function(F){C.focus()});var D=this.options.value;if(D){this.ui("set_value",D,true);if(this.ui("hasAutoSummary")){this.updateSummary()}}},value:function(C,F){if(C==null){var E=this.ui("value");if(F){return E}return{value:E}}else{try{this.ui("set_value",C);if(this.ui("hasAutoSummary")){this.updateSummary()}}catch(D){if(console.log){console.log(D)}}}},summary_item:function(){return this.controls.summary_item},summary:function(){try{var C=this.ui("summary")}catch(E){var D="An error occured for the field type '"+this.type+"' in the 'summary' method: "+E;if(console&&console.error){console.error(D)}}if(!C||C==this){return""}if(B.type(C)=="object"){return C}else{return B.mp.smartTrim(C,100+((this.summaryWidth()-1)*130))}},isEmpty:function(){try{var D=this.ui("is_empty")}catch(E){var C="An error occured for the field type '"+this.type+"' in the 'is_empty' method: "+E;if(console&&console.error){console.error(C)}return true}if(!D){this.controls.summary_item.removeClass("invalid");this.element.removeClass("invalid")}return D},clear:function(){this.ui("clear")},ui:function(){var C=this;if(C.mpft_widget){return C.mpft_widget.apply(C.controls.ui,arguments)}},summaryWidth:function(){return this.meta.summary_width||1},updateSummary:function(){if(this.controls.summary_item.length){if(this.isEmpty()){this.controls.summary_item.addClass("empty");this.controls.value_summary.hide();this.controls.empty_summary.show()}else{this.controls.summary_item.removeClass("empty");this.controls.empty_summary.hide();this.controls.value_summary.show()}this.controls.value_summary.empty().append(this.summary())}},focusControl:function(){if(this.ui("focus")===false){var E="input[type=file],input.text:visible,input.search:visible,input.checkbox:visible,input.radio:visible,textarea:visible,select:visible";var C="button:visible,a:visible";var D=this.element.find(E);if(D.length){D.first().focus()}else{D=this.element.find(C);if(D.length){D.first().focus()}}}},focus:function(){if(this._trigger("beforefocus")){var C=true;try{C=this.ui("can_focus")}catch(D){}if(C){this.element.addClass("active");this._trigger("afterfocus")}}},blur:function(){if(this._trigger("beforeblur")){this.element.removeClass("active");this._trigger("afterblur")}}})})(jQuery);