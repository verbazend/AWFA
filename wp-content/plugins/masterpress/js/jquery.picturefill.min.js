/*
  Picturefill plug-in for jQuery, License - MIT, Copyright: 2012 Traversal - http://traversal.com.au
*/
/* matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
window.matchMedia=window.matchMedia||(function(E,D){var G,B=E.documentElement,A=B.firstElementChild||B.firstChild,F=E.createElement("body"),C=E.createElement("div");C.id="mq-test-1";C.style.cssText="position:absolute;top:-100em";F.appendChild(C);return function(H){C.innerHTML='&shy;<style media="'+H+'"> #mq-test-1 { width: 42px; }</style>';B.insertBefore(F,A);G=C.offsetWidth==42;B.removeChild(F);return{matches:G,media:H}}})(document);(function(B){var C={cnLoaded:"picturefill-loaded",cnLazy:"lazy"};var A="picturefill";B.fn[A]=function(){var F=this,G=this,H,E={},I={},D=arguments;if(D.length>=1){if(typeof (D[0])=="string"){H=D[0]}else{E=D[0]}if(D.length>=2){I=D[1]}}if(this.length){this.each(function(){var U,P,S,L=I,M={},T={},N=B(this);if(B.fn.metadata){T=N.metadata({type:"class"})}if(!H){S=N.data(A);if(!S){S={};N.data(A,S)}B.extend(true,M,C,E,T[A]||T||{});S.options=M}else{S=N.data(A);if(S){M=S.options}else{return }}U=function(){N[A].apply(N,arguments)};P=function(W,V){return N.trigger(jQuery.Event(W+"."+A),B.isArray(V)?V:[V])!==false};if(!H){S.imageload=function(){if(S.source&&S.target){S.target.attr("src",S.source.attr("src"))}N.addClass(M.cnLoaded);P("loaded")};U("fill")}else{if(H==="fill"){if(N.get(0).getAttribute("data-picture")!==null){var Q=[];N.find("div").each(function(){var W=B(this);var V=W.data("media");if(!V||(window.matchMedia&&window.matchMedia(V).matches)){Q.push(W)}});var K=N.find("img");if(Q.length){var J=Q.pop().data("src");if(!K.length){var R={alt:N.data("alt")};var O=N.hasClass(M.cnLazy);if(O){R["data-original"]=J}else{R.src=J}K=B("<img />");K.attr(R);if(!O&&!K.data("load")){K.data("load",S.imageload);if(B.fn.imageLoad){K.imageLoad(S.imageload)}else{K.load(S.imageload)}}N.append(K)}else{if(N.hasClass(M.cnLazy)){K.attr("data-original",J)}else{S.source=B("<img />").attr("src",J);if(B.fn.imageLoad){S.source.imageLoad(S.imageload)}else{S.source.load(S.imageload)}S.target=K}}}else{if(K.length){K.remove()}}}}else{if(H==="destroy"){N.data(A,null)}}}})}return F};B.fn[A].defaults=C;B.fn.lazypicturefill=function(D){var E=D||{};return B(this).each(function(){B(this).picturefill(E).filter(".lazy").find("img").lazyload(E).bind("lazyloaded",function(){B(this).closest(".picture").addClass("picturefill-loaded")})})}})(jQuery);